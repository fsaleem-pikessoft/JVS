<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tax Calculator - JVS Tax Services</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="images/JVS Official Logo 200x200.webp">
    <meta name="description" content="Calculate your estimated tax liability with JVS Tax Services professional tax calculator. Get instant estimates for your tax return.">
    <style>
        /* About Hero Section - Matching About Page */
        .about-hero {
            background: linear-gradient(135deg, #20B2AA 0%, #48CAE4 25%, #20B2AA 50%, #17A2B8 75%, #20B2AA 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            color: white;
            padding: 120px 0 80px;
            position: relative;
            overflow: hidden;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .about-hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255,255,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255,255,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(255,255,255,0.05) 0%, transparent 50%);
            animation: float 20s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }
        
        .about-badge {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1));
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 50px;
            padding: 12px 24px;
            display: inline-block;
            font-size: 14px;
            font-weight: 600;
            letter-spacing: 0.5px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            color: white;
            animation: badgeGlow 3s ease-in-out infinite;
        }
        
        @keyframes badgeGlow {
            0%, 100% { box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); }
            50% { box-shadow: 0 8px 32px rgba(255, 255, 255, 0.2); }
        }
        
        .about-title {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            line-height: 1.1;
            color: white !important;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
            font-family: 'Poppins', sans-serif;
            letter-spacing: -1px;
        }
        
        .about-subtitle {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
            font-family: 'Poppins', sans-serif;
        }
        
        .about-info-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .about-info-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: rotate 10s linear infinite;
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .btn-start-estimate {
            background: linear-gradient(135deg, #20B2AA, #00ff88, #20B2AA);
            background-size: 200% 200%;
            animation: buttonGradient 3s ease-in-out infinite;
            border: none;
            color: white;
            padding: 1rem 2.5rem;
            border-radius: 50px;
            font-weight: 700;
            letter-spacing: 0.3px;
            box-shadow: 0 10px 30px rgba(32, 178, 170, 0.3);
            position: relative;
            overflow: hidden;
            font-size: 1.1rem;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s ease;
        }
        
        .btn-start-estimate::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: buttonShine 2s ease-in-out infinite;
        }
        
        .btn-start-estimate:hover {
            color: white;
            transform: translateY(-4px);
            box-shadow: 0 20px 50px rgba(32, 178, 170, 0.45);
        }
        
        @keyframes buttonGradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        @keyframes buttonShine {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .calculator-hero {
            background: linear-gradient(135deg, #20B2AA 0%, #48CAE4 25%, #20B2AA 50%, #17A2B8 75%, #20B2AA 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            color: white;
            padding: 140px 0 80px;
            position: relative;
            overflow: hidden;
        }
        
        .calculator-badge {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1));
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 50px;
            padding: 12px 24px;
            display: inline-block;
            font-size: 14px;
            font-weight: 600;
            letter-spacing: 0.5px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            color: white;
            animation: badgeGlow 3s ease-in-out infinite;
        }
        
        .calculator-title {
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 1rem;
            line-height: 1.2;
            color: white !important;
            font-family: 'Poppins', sans-serif;
        }
        
        .calculator-subtitle {
            font-size: 1.1rem;
            margin-bottom: 0;
            color: rgba(255, 255, 255, 0.95);
            font-weight: 400;
            font-family: 'Poppins', sans-serif;
        }
        
        .calculator-info-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .calculator-info-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: rotate 10s linear infinite;
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .animate-fade-in-up {
            animation: fadeInUp 0.8s ease-out forwards;
            opacity: 0;
            transform: translateY(30px);
        }
        
        .animate-fade-in-right {
            animation: fadeInRight 0.8s ease-out forwards;
            opacity: 0;
            transform: translateX(30px);
        }
        
        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInRight {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        /* CTA Banner - Matching App Theme */
        .cta-banner {
            background: linear-gradient(135deg, #20B2AA 0%, #48CAE4 50%, #20B2AA 100%);
            background-size: 200% 200%;
            animation: gradientShift 8s ease infinite;
            border-radius: 20px;
            padding: 40px 50px;
            margin: 60px 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 30px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(32, 178, 170, 0.25);
        }
        
        .cta-banner::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            border-radius: 50%;
        }
        
        .calculator-icon {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2.5rem;
            flex-shrink: 0;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        
        .cta-banner:hover .calculator-icon {
            transform: scale(1.1) rotate(5deg);
            background: rgba(255, 255, 255, 0.25);
        }
        
        .cta-banner-text {
            flex: 1;
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            line-height: 1.3;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .btn-cta-estimate {
            background: linear-gradient(135deg, #20B2AA, #00ff88, #20B2AA);
            background-size: 200% 200%;
            animation: buttonGradient 3s ease-in-out infinite;
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            flex-shrink: 0;
            box-shadow: 0 4px 15px rgba(32, 178, 170, 0.4);
            position: relative;
            overflow: hidden;
        }
        
        .btn-cta-estimate::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: buttonShine 2s ease-in-out infinite;
        }
        
        .btn-cta-estimate:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(32, 178, 170, 0.5);
        }
        
        @media (max-width: 768px) {
            .cta-banner {
                flex-direction: column;
                text-align: center;
                padding: 30px 25px;
            }
            
            .cta-banner-text {
                font-size: 1.2rem;
            }
            
            .calculator-icon {
                width: 60px;
                height: 60px;
                font-size: 2rem;
            }
        }
        
        .calculator-content {
            padding: 60px 0 80px;
            background: #f8f9fa;
        }
        
        .calculator-content .container {
            max-width: 900px;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .calculator-content {
                padding: 30px 0 50px;
            }
            .calculator-content .container {
                max-width: 100%;
                padding: 0 12px;
            }
            .content-section {
                padding: 24px;
                margin: 0 12px 30px;
                border-radius: 16px;
            }
            .content-section h2 {
                font-size: 1.6rem;
                gap: 10px;
            }
            #resultsBreakdown {
                padding: 16px;
                min-height: auto;
            }
            #wizardStep1 h3,
            #wizardStep2 h3 {
                font-size: 1.05rem;
            }
            .breakdown-row {
                padding: 10px 0 !important;
            }
            .breakdown-label,
            .breakdown-value {
                font-size: 0.9rem !important;
            }
            .breakdown-total {
                padding: 14px 12px !important;
                flex-direction: row;
                gap: 8px;
            }
            .tab-button {
                font-size: 0.9rem;
                padding: 12px 10px;
            }
        }
        
        .content-section {
            background: white;
            border-radius: 25px;
            padding: 60px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.08);
            margin-bottom: 50px;
            border: 1px solid rgba(32, 178, 170, 0.1);
            position: relative;
            overflow: hidden;
            width: 100%;
        }
        
        .content-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #20B2AA, #17a2b8, #20B2AA);
            background-size: 200% 100%;
            animation: gradientShift 3s ease infinite;
        }
        
        .content-section h2 {
            color: #20B2AA;
            font-weight: 700;
            margin-bottom: 30px;
            font-size: 2.2rem;
            display: flex;
            align-items: center;
            gap: 15px;
            position: relative;
        }
        
        .content-section h2::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 60px;
            height: 4px;
            background: linear-gradient(90deg, #20B2AA, #17a2b8);
            border-radius: 2px;
        }
        
        .content-section h2 i {
            font-size: 1.8rem;
            background: linear-gradient(135deg, #20B2AA, #17a2b8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .content-section p {
            color: #2c3e50;
            line-height: 1.9;
            font-size: 1.1rem;
            margin-bottom: 25px;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        
        .feature-card {
            background: white;
            border-radius: 20px;
            padding: 35px;
            border: 2px solid #e9ecef;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #20B2AA, #17a2b8);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.4s ease;
        }
        
        .feature-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(32, 178, 170, 0.15);
            border-color: #20B2AA;
        }
        
        .feature-card:hover::before {
            transform: scaleX(1);
        }
        
        .feature-card i {
            color: #20B2AA;
            font-size: 2.5rem;
            margin-bottom: 20px;
            display: inline-block;
            padding: 15px;
            background: linear-gradient(135deg, rgba(32, 178, 170, 0.1), rgba(23, 162, 184, 0.1));
            border-radius: 15px;
            transition: all 0.3s ease;
        }
        
        .feature-card:hover i {
            transform: scale(1.1) rotate(5deg);
            background: linear-gradient(135deg, rgba(32, 178, 170, 0.2), rgba(23, 162, 184, 0.2));
        }
        
        .feature-card h4 {
            color: #2c3e50;
            font-weight: 700;
            margin-bottom: 12px;
            font-size: 1.2rem;
        }
        
        .feature-card p {
            color: #6c757d;
            font-size: 1rem;
            margin: 0;
            line-height: 1.6;
        }
        
        .btn-reveal-calculator {
            background: linear-gradient(135deg, #20B2AA 0%, #17a2b8 50%, #20B2AA 100%);
            background-size: 200% 100%;
            color: white;
            border: none;
            padding: 25px 60px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1.4rem;
            transition: all 0.4s ease;
            box-shadow: 0 15px 40px rgba(32, 178, 170, 0.4);
            display: inline-flex;
            align-items: center;
            gap: 15px;
            margin: 50px 0;
            position: relative;
            overflow: hidden;
        }
        
        .btn-reveal-calculator::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s ease;
        }
        
        .btn-reveal-calculator:hover::before {
            left: 100%;
        }
        
        .btn-reveal-calculator:hover {
            background-position: 100% 0;
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 20px 50px rgba(32, 178, 170, 0.5);
            color: white;
        }
        
        .btn-reveal-calculator:active {
            transform: translateY(-2px) scale(1.02);
        }
        
        .btn-reveal-calculator i {
            font-size: 1.6rem;
        }
        
        /* Professional Card Style - Senior Level Design */
        .simple-card {
            background: #ffffff;
            border-radius: 16px;
            padding: 45px 35px;
            border: 1px solid rgba(32, 178, 170, 0.12);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            height: 100%;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }
        
        .simple-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #20B2AA, #17a2b8, #20B2AA);
            background-size: 200% 100%;
            animation: gradientShift 3s ease infinite;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .simple-card:hover::before {
            opacity: 1;
        }
        
        .simple-card:hover {
            box-shadow: 0 12px 40px rgba(32, 178, 170, 0.18);
            transform: translateY(-8px);
            border-color: rgba(32, 178, 170, 0.25);
        }
        
        .simple-card h3, .simple-card h4 {
            color: #0f5132;
            font-weight: 700;
            margin-bottom: 18px;
            font-size: 1.35rem;
            line-height: 1.3;
        }
        
        .simple-card p {
            color: #5b6b7e;
            line-height: 1.7;
            margin-bottom: 0;
            font-size: 1rem;
        }
        
        .value-icon {
            width: 80px;
            height: 80px;
            border-radius: 16px;
            display: grid;
            place-items: center;
            margin-bottom: 24px;
            background: linear-gradient(135deg, #eaf7f7, #ffffff);
            border: 2px solid rgba(32, 178, 170, 0.15);
            color: #20B2AA;
            font-size: 2rem;
            box-shadow: 0 4px 12px rgba(32, 178, 170, 0.1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }
        
        .value-icon::before {
            content: '';
            position: absolute;
            inset: -2px;
            border-radius: 16px;
            background: linear-gradient(135deg, #20B2AA, #17a2b8);
            opacity: 0;
            transition: opacity 0.4s ease;
            z-index: -1;
        }
        
        .simple-card:hover .value-icon {
            transform: scale(1.1) rotate(5deg);
            background: linear-gradient(135deg, #20B2AA, #17a2b8);
            color: white;
            border-color: transparent;
            box-shadow: 0 8px 20px rgba(32, 178, 170, 0.25);
        }
        
        .simple-card:hover .value-icon::before {
            opacity: 1;
        }
        
        /* Professional Pricing Cards - Clean Minimal Design */
        .pricing-card {
            background: #ffffff;
            border-radius: 12px;
            padding: 40px 35px;
            border: 1px solid #e0e0e0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            transition: all 0.3s ease;
            height: 100%;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        
        .pricing-card.featured {
            border-top: 4px solid #20B2AA;
            border-color: #e0e0e0;
            box-shadow: 0 4px 16px rgba(32, 178, 170, 0.1);
        }
        
        .pricing-card:hover {
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
            transform: translateY(-3px);
        }
        
        .pricing-card-title {
            color: #0f5132;
            font-weight: 700;
            font-size: 1.4rem;
            margin-bottom: 12px;
            line-height: 1.3;
        }
        
        .pricing-card-subtitle {
            color: #5b6b7e;
            line-height: 1.5;
            margin: 0 0 25px 0;
            font-size: 0.95rem;
        }
        
        .pricing-features-list {
            list-style: none;
            padding: 0;
            margin: 0 0 25px 0;
        }
        
        .pricing-features-list li {
            color: #5b6b7e;
            margin-bottom: 14px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            font-size: 0.95rem;
            line-height: 1.5;
        }
        
        .pricing-features-list li:last-child {
            margin-bottom: 0;
        }
        
        .pricing-features-list li i {
            color: #20B2AA;
            font-size: 1rem;
            margin-top: 3px;
            flex-shrink: 0;
        }
        
        .pricing-learn-more {
            color: #20B2AA;
            text-decoration: none;
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 25px;
            display: inline-block;
            transition: all 0.3s ease;
        }
        
        .pricing-learn-more:hover {
            color: #17a2b8;
        }
        
        .pricing-amount {
            margin-bottom: 25px;
            margin-top: auto;
        }
        
        .pricing-starting {
            display: block;
            font-size: 0.8rem;
            color: #6c757d;
            margin-bottom: 6px;
            font-weight: 400;
        }
        
        .pricing-price {
            font-size: 2.5rem;
            font-weight: 700;
            color: #0f5132;
            line-height: 1;
            margin-bottom: 6px;
        }
        
        .pricing-note {
            display: block;
            font-size: 0.75rem;
            color: #6c757d;
            font-weight: 400;
        }
        
        .btn-filing-pricing {
            background: linear-gradient(135deg, #20B2AA, #17a2b8);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            box-shadow: 0 4px 15px rgba(32, 178, 170, 0.25);
        }
        
        .btn-filing-pricing:hover {
            background: linear-gradient(135deg, #17a2b8, #20B2AA);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(32, 178, 170, 0.4);
        }
        
        .calculator-card {
            background: white;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            margin-bottom: 40px;
            border: 1px solid #e9ecef;
        }
        
        .calculator-card.show {
            display: block;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .calculator-wrapper {
            text-align: center;
            padding: 80px 0;
            background: linear-gradient(135deg, rgba(32, 178, 170, 0.05), rgba(23, 162, 184, 0.05));
            border-radius: 25px;
            margin: 50px 0;
            width: 100%;
        }
        
        .calculator-card h3 {
            color: #20B2AA;
            font-weight: 700;
            margin-bottom: 25px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .calculator-card h3 i {
            font-size: 1.3rem;
        }
        
        .form-label {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1rem;
            display: block;
        }
        
        .form-control, .form-select {
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 14px 18px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: #fafafa;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: #20B2AA;
            box-shadow: 0 0 0 4px rgba(32, 178, 170, 0.1);
            background: white;
            outline: none;
        }
        
        .input-group-text {
            background: linear-gradient(135deg, #20B2AA, #17a2b8);
            color: white;
            border: none;
            border-radius: 12px 0 0 12px;
            font-weight: 600;
            padding: 14px 18px;
        }
        
        .input-group .form-control {
            border-left: none;
            border-radius: 0 12px 12px 0;
        }
        
        .btn-calculate {
            background: linear-gradient(135deg, #20B2AA 0%, #17a2b8 50%, #20B2AA 100%);
            background-size: 200% 100%;
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1.2rem;
            transition: all 0.4s ease;
            box-shadow: 0 10px 30px rgba(32, 178, 170, 0.4);
            width: 100%;
            margin-top: 30px;
            position: relative;
            overflow: hidden;
        }
        
        .btn-calculate::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s ease;
        }
        
        .btn-calculate:hover::before {
            left: 100%;
        }
        
        .btn-calculate:hover {
            background-position: 100% 0;
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(32, 178, 170, 0.5);
            color: white;
        }
        
        .btn-reset {
            background: #6c757d;
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 50px;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 15px;
        }
        
        .btn-reset:hover {
            background: #5a6268;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(108, 117, 125, 0.3);
        }
        
        .results-card {
            background: linear-gradient(135deg, #20B2AA, #17a2b8);
            color: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(32, 178, 170, 0.3);
            display: none;
            margin-top: 30px;
        }
        
        .results-card.show {
            display: block;
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .results-card h3 {
            color: white;
            margin-bottom: 25px;
            font-size: 1.8rem;
        }
        
        .result-item {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .result-item-label {
            font-size: 1rem;
            font-weight: 500;
        }
        
        .result-item-value {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .result-item.highlight {
            background: rgba(255, 255, 255, 0.25);
            font-size: 1.1rem;
        }
        
        .result-item.highlight .result-item-value {
            font-size: 2rem;
        }
        
        .info-box {
            background: linear-gradient(135deg, rgba(32, 178, 170, 0.1), rgba(23, 162, 184, 0.1));
            border-left: 5px solid #20B2AA;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(32, 178, 170, 0.1);
        }
        
        .info-box i {
            color: #20B2AA;
            margin-right: 12px;
            font-size: 1.2rem;
        }
        
        .info-box p {
            margin: 0;
            color: #2c3e50;
            font-size: 1rem;
            line-height: 1.7;
        }
        
        /* Step-by-Step Wizard Styles */
        .calculator-progress {
            margin-bottom: 40px;
        }
        
        .progress-steps {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            padding: 20px 0;
        }
        
        .step-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            position: relative;
            z-index: 2;
        }
        
        .step-number {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #e9ecef;
            color: #6c757d;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 10px;
            transition: all 0.3s ease;
            border: 3px solid #e9ecef;
        }
        
        .step-item.active .step-number {
            background: linear-gradient(135deg, #20B2AA, #17a2b8);
            color: white;
            border-color: #20B2AA;
            box-shadow: 0 5px 15px rgba(32, 178, 170, 0.3);
            transform: scale(1.1);
        }
        
        .step-item.completed .step-number {
            background: #28a745;
            color: white;
            border-color: #28a745;
        }
        
        .step-label {
            font-size: 0.85rem;
            color: #6c757d;
            font-weight: 500;
            text-align: center;
            transition: color 0.3s ease;
        }
        
        .step-item.active .step-label {
            color: #20B2AA;
            font-weight: 600;
        }
        
        .step-line {
            flex: 1;
            height: 3px;
            background: #e9ecef;
            margin: 0 10px;
            position: relative;
            top: -25px;
            z-index: 1;
        }
        
        .step-line.completed {
            background: linear-gradient(90deg, #20B2AA, #17a2b8);
        }
        
        .calculator-step {
            display: none;
            animation: fadeIn 0.4s ease;
        }
        
        .calculator-step.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .step-title {
            color: #2c3e50;
            font-weight: 700;
            margin-bottom: 15px;
            font-size: 1.6rem;
        }
        
        .step-description {
            color: #6c757d;
            font-size: 1.05rem;
            margin-bottom: 30px;
            line-height: 1.7;
        }
        
        .step-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #e9ecef;
        }
        
        .btn-next, .btn-prev, .btn-calculate-final {
            padding: 15px 35px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            border: none;
            display: inline-flex;
            align-items: center;
        }
        
        .btn-next, .btn-calculate-final {
            background: linear-gradient(135deg, #20B2AA 0%, #17a2b8 50%, #20B2AA 100%);
            background-size: 200% 100%;
            color: white;
            box-shadow: 0 10px 30px rgba(32, 178, 170, 0.4);
        }
        
        .btn-next:hover, .btn-calculate-final:hover {
            background-position: 100% 0;
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(32, 178, 170, 0.5);
            color: white;
        }
        
        .btn-prev {
            background: #6c757d;
            color: white;
        }
        
        .btn-prev:hover {
            background: #5a6268;
            color: white;
            transform: translateY(-2px);
        }
        
        .results-summary {
            background: linear-gradient(135deg, rgba(32, 178, 170, 0.05), rgba(23, 162, 184, 0.05));
            border-radius: 20px;
            padding: 40px;
            margin-top: 30px;
        }
        
        .result-item {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }
        
        .result-item:hover {
            border-color: #20B2AA;
            box-shadow: 0 5px 15px rgba(32, 178, 170, 0.1);
        }
        
        .result-item-label {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .result-item-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #20B2AA;
        }
        
        .result-item.highlight {
            background: linear-gradient(135deg, #20B2AA, #17a2b8);
            color: white;
            border: none;
            padding: 35px;
        }
        
        .result-item.highlight .result-item-label {
            color: white;
            font-size: 1.3rem;
        }
        
        .result-item.highlight .result-item-value {
            color: white;
            font-size: 2.2rem;
        }
        
        .result-item.refund {
            background: linear-gradient(135deg, #28a745, #20c997);
        }
        
        .result-item.owed {
            background: linear-gradient(135deg, #dc3545, #c82333);
        }
        
        @media (max-width: 768px) {
            .calculator-title {
                font-size: 2.5rem;
            }
            
            .calculator-subtitle {
                font-size: 1rem;
            }
            
            .calculator-info-card {
                padding: 30px;
                margin-top: 2rem;
            }
            
            .calculator-content {
                padding: 50px 0 70px;
            }
            
            .content-section {
                padding: 35px 25px;
                margin-bottom: 30px;
                border-radius: 20px;
            }
            
            .content-section h2 {
                font-size: 1.6rem;
            }
            
            .content-section p {
                font-size: 1rem;
            }
            
            .feature-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .feature-card {
                padding: 25px;
            }
            
            .calculator-wrapper {
                padding: 50px 20px;
                margin: 30px 0;
            }
            
            .btn-reveal-calculator {
                padding: 18px 35px;
                font-size: 1.1rem;
                width: 90%;
            }
            
            .calculator-card {
                padding: 30px 20px;
            }
            
            .results-card {
                padding: 25px 20px;
            }
            
            .progress-steps {
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .step-item {
                flex: 0 0 calc(20% - 8px);
                min-width: 60px;
            }
            
            .step-number {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }
            
            .step-label {
                font-size: 0.7rem;
            }
            
            .step-line {
                display: none;
            }
            
            .step-title {
                font-size: 1.4rem;
            }
            
            .step-description {
                font-size: 0.95rem;
            }
            
            .step-actions {
                flex-direction: column;
            }
            
            .btn-next, .btn-prev, .btn-calculate-final {
                width: 100%;
                justify-content: center;
            }
            
            .results-summary {
                padding: 25px 15px;
            }
            
            .result-item {
                padding: 20px 15px;
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .result-item-value {
                font-size: 1.3rem;
            }
            
            .result-item.highlight .result-item-value {
                font-size: 1.8rem;
            }
        }

        /* Professional Tax Calculator Styling */
        .calculator-content {
            background: linear-gradient(180deg, #f8f9fa 0%, #ffffff 100%);
            padding: 80px 0 100px;
            min-height: 100vh;
            position: relative;
        }

        .calculator-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(32, 178, 170, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(23, 162, 184, 0.03) 0%, transparent 50%);
            pointer-events: none;
        }

        .calculator-header {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 249, 250, 0.95) 100%);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 50px 40px;
            margin-bottom: 50px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08), 0 2px 8px rgba(0, 0, 0, 0.04);
            border: 1px solid rgba(32, 178, 170, 0.12);
            position: relative;
            overflow: hidden;
        }

        .calculator-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #20B2AA 0%, #17a2b8 50%, #20B2AA 100%);
            background-size: 200% 100%;
            animation: gradientShift 3s ease infinite;
        }

        #estimatedRefundDisplay {
            background: linear-gradient(135deg, #20B2AA 0%, #17a2b8 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 3.5rem;
            font-weight: 800;
            letter-spacing: -1px;
            margin: 10px 0;
            text-shadow: 0 2px 10px rgba(32, 178, 170, 0.2);
        }

        .progress-steps-new {
            position: relative;
            padding: 20px 0;
        }

        .progress-step {
            position: relative;
            z-index: 2;
        }

        .step-circle {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.2rem;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
            position: relative;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        }

        .step-circle::before {
            content: '';
            position: absolute;
            inset: -6px;
            border-radius: 50%;
            background: linear-gradient(135deg, #20B2AA, #17a2b8);
            opacity: 0;
            transition: opacity 0.5s ease;
            z-index: -1;
            filter: blur(8px);
        }

        .step-circle.active::before {
            opacity: 0.3;
        }

        .step-circle.active {
            background: linear-gradient(135deg, #20B2AA 0%, #17a2b8 100%);
            color: white;
            box-shadow: 0 8px 24px rgba(32, 178, 170, 0.4);
            transform: scale(1.1);
        }

        .step-label {
            font-size: 0.75rem;
            font-weight: 600;
            letter-spacing: 0.5px;
            margin-top: 10px;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }

        .progress-step.active .step-label {
            color: #20B2AA;
            font-weight: 700;
        }

        .progress-line {
            height: 3px;
            background: linear-gradient(90deg, #e0e0e0 0%, #e0e0e0 100%);
            border-radius: 2px;
            transition: all 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .progress-line::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 0;
            background: linear-gradient(90deg, #20B2AA 0%, #17a2b8 100%);
            transition: width 0.5s ease;
        }

        .progress-line.completed::after {
            width: 100%;
        }

        .calculator-card-new {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.98) 0%, rgba(255, 255, 255, 0.95) 100%);
            backdrop-filter: blur(30px);
            border-radius: 28px;
            padding: 60px 70px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1), 0 8px 24px rgba(0, 0, 0, 0.06);
            border: 1px solid rgba(32, 178, 170, 0.15);
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.8s ease-out;
        }

        .calculator-card-new::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #20B2AA 0%, #17a2b8 50%, #20B2AA 100%);
            background-size: 200% 100%;
            animation: gradientShift 3s ease infinite;
        }

        .calculator-card-new::after {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(32, 178, 170, 0.05) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
            pointer-events: none;
        }

        .form-field-row {
            display: flex;
            align-items: center;
            margin-bottom: 32px;
            gap: 14px;
            padding: 20px 16px;
            border-bottom: 2px solid #e8e8e8;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 12px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            backdrop-filter: blur(10px);
        }

        .form-field-row::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 16px;
            right: 16px;
            height: 2px;
            background: linear-gradient(90deg, #20B2AA, #17a2b8);
            transform: scaleX(0);
            transition: transform 0.4s ease;
        }

        .form-field-row:focus-within {
            border-bottom-color: transparent;
            background: rgba(32, 178, 170, 0.04);
            box-shadow: 0 4px 16px rgba(32, 178, 170, 0.1);
            transform: translateY(-2px);
        }

        .form-field-row:focus-within::before {
            transform: scaleX(1);
        }

        .form-field-row span:first-child {
            color: #20B2AA;
            font-weight: 700;
            font-size: 1.15rem;
            min-width: fit-content;
            letter-spacing: 0.2px;
        }

        .form-select-custom,
        .form-field-row input[type="number"] {
            flex: 1;
            padding: 14px 50px 14px 16px;
            border: none;
            border-bottom: 2px solid #e8e8e8;
            background: transparent;
            font-size: 1.1rem;
            color: #2c3e50;
            font-weight: 600;
            transition: all 0.3s ease;
            outline: none;
        }

        /* Hide default browser dropdown arrow */
        .form-select-custom {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: none;
        }
        
        /* Hide default arrow for select elements in mobile field controls */
        .mobile-field-control .form-select-custom {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: none;
        }

        .form-select-custom:focus,
        .form-field-row input[type="number"]:focus {
            border-bottom-color: #20B2AA;
            color: #20B2AA;
            background: rgba(32, 178, 170, 0.03);
        }

        .form-select-custom option {
            padding: 12px;
            font-weight: 500;
        }

        .form-field-row .fa-check-circle {
            color: #20B2AA;
            font-size: 1.3rem;
            animation: checkmarkPop 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes checkmarkPop {
            0% { transform: scale(0) rotate(-180deg); opacity: 0; }
            50% { transform: scale(1.2) rotate(10deg); }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }

        .btn-get-estimate,
        .btn-next-step {
            background: linear-gradient(135deg, #20B2AA 0%, #17a2b8 100%);
            color: white;
            border: none;
            padding: 18px 60px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 24px rgba(32, 178, 170, 0.3);
            position: relative;
            overflow: hidden;
            letter-spacing: 0.5px;
        }

        .btn-get-estimate::before,
        .btn-next-step::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn-get-estimate:hover::before,
        .btn-next-step:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-get-estimate:hover,
        .btn-next-step:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 32px rgba(32, 178, 170, 0.4);
        }

        .btn-get-estimate:active,
        .btn-next-step:active {
            transform: translateY(-1px);
        }

        .btn-back-step {
            background: transparent;
            color: #20B2AA;
            border: 2px solid #20B2AA;
            padding: 18px 50px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn-back-step:hover {
            background: #20B2AA;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(32, 178, 170, 0.3);
        }

        .btn-back-step:active {
            transform: translateY(0);
        }

        .calculator-step h2 {
            color: #1a1a1a;
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 16px;
            letter-spacing: -1px;
            line-height: 1.2;
            background: linear-gradient(135deg, #1a1a1a 0%, #2c3e50 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
        }

        .calculator-step h2::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 60px;
            height: 4px;
            background: linear-gradient(90deg, #20B2AA, #17a2b8);
            border-radius: 2px;
        }

        .calculator-step p {
            color: #6c757d;
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 40px;
            font-weight: 400;
        }

        /* Step 1 mobile-inspired hero */
        .step1-intro {
            margin-bottom: 35px;
        }

        .step1-intro-tag {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #047857;
            background: rgba(4, 120, 87, 0.1);
            padding: 6px 14px;
            border-radius: 999px;
        }

        .step1-intro h2 {
            font-size: 2.1rem;
            color: #113e21;
            margin-top: 18px;
            margin-bottom: 12px;
            line-height: 1.3;
        }

        .step1-intro p {
            margin: 0;
            color: #4b5c53;
            font-size: 1rem;
        }

        .step1-layout {
            display: flex;
            gap: 30px;
            align-items: stretch;
        }

        .step1-illustration {
            flex: 0 0 260px;
            border-radius: 22px;
            background: linear-gradient(140deg, #e9fdf3 0%, #f5fcff 60%, #ecf7ff 100%);
            position: relative;
            padding: 30px;
            overflow: hidden;
            min-height: 220px;
        }

        .step1-illustration::after {
            content: '';
            position: absolute;
            inset: 0;
            background: url('images/taxReturn.webp') center/contain no-repeat;
            opacity: 0.45;
        }

        .step1-illustration-content {
            position: relative;
            z-index: 2;
            color: #0f5132;
            font-weight: 600;
        }

        .step1-mobile-card {
            flex: 1;
            background: #ffffff;
            border-radius: 24px;
            padding: 24px 26px;
            border: 1px solid rgba(0, 0, 0, 0.05);
            box-shadow: 0 12px 40px rgba(15, 81, 50, 0.08);
        }

        .step1-mobile-card .mobile-field-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 18px;
        }

        .step1-mobile-card .mobile-field-group:last-of-type {
            margin-bottom: 0;
        }

        .mobile-field-label {
            color: #0f5132;
            font-weight: 600;
            font-size: 1rem;
            margin-bottom: 6px;
        }

        .mobile-field-wrapper {
            width: 100%;
        }

        .mobile-help {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: rgba(4, 120, 87, 0.12);
            color: #047857;
            font-size: 0.8rem;
            margin-left: 6px;
        }

        .deduction-options-grid {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        /* Income Type Buttons */
        .income-type-btn,
        .credit-btn {
            padding: 20px 28px;
            border: 2px solid #e8e8e8;
            border-radius: 16px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.95) 100%);
            backdrop-filter: blur(10px);
            cursor: pointer;
            text-align: left;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        }

        .income-type-btn::before,
        .credit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(32, 178, 170, 0.15), transparent);
            transition: left 0.6s ease;
        }

        .income-type-btn:hover::before,
        .credit-btn:hover::before {
            left: 100%;
        }

        .income-type-btn:hover,
        .credit-btn:hover {
            border-color: #20B2AA;
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(32, 178, 170, 0.2);
            background: linear-gradient(135deg, rgba(255, 255, 255, 1) 0%, rgba(248, 249, 250, 1) 100%);
        }

        .income-type-btn.selected,
        .credit-btn.selected {
            background: linear-gradient(135deg, #20B2AA 0%, #17a2b8 100%);
            border-color: #20B2AA;
            color: white;
            box-shadow: 0 8px 28px rgba(32, 178, 170, 0.35);
            transform: translateY(-2px);
        }

        .income-type-btn.selected span,
        .credit-btn.selected span {
            color: white !important;
            font-weight: 700;
        }

        .income-type-btn.selected i,
        .credit-btn.selected i {
            color: white !important;
        }

        /* Deduction Cards */
        .calculator-step > div[style*="grid"] > div {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 249, 250, 0.95) 100%);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 40px;
            border: 2px solid rgba(240, 240, 240, 0.8);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06);
        }

        .calculator-step > div[style*="grid"] > div::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #20B2AA, #17a2b8);
            transform: scaleX(0);
            transition: transform 0.5s ease;
            border-radius: 24px 24px 0 0;
        }

        .calculator-step > div[style*="grid"] > div::after {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(32, 178, 170, 0.08) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .calculator-step > div[style*="grid"] > div:hover {
            border-color: #20B2AA;
            transform: translateY(-6px);
            box-shadow: 0 16px 40px rgba(32, 178, 170, 0.2);
            background: linear-gradient(135deg, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0.98) 100%);
        }

        .calculator-step > div[style*="grid"] > div:hover::before {
            transform: scaleX(1);
        }

        .calculator-step > div[style*="grid"] > div:hover::after {
            opacity: 1;
        }

        .btn-continue-standard,
        .btn-continue-itemized {
            transition: all 0.3s ease;
            font-weight: 700;
            letter-spacing: 0.3px;
        }

        .btn-continue-standard:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(32, 178, 170, 0.3);
        }

        .btn-continue-itemized:hover {
            background: #20B2AA !important;
            color: white !important;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(32, 178, 170, 0.2);
        }

        /* Results Section */
        #step6 > div:first-child {
            background: linear-gradient(135deg, #20B2AA 0%, #48CAE4 25%, #20B2AA 50%, #17a2b8 75%, #20B2AA 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            border-radius: 28px;
            padding: 80px 60px;
            box-shadow: 0 25px 70px rgba(32, 178, 170, 0.3), 0 10px 30px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        #step6 > div:first-child::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255,255,255,0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255,255,255,0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(255,255,255,0.08) 0%, transparent 50%);
            animation: float 20s ease-in-out infinite;
        }

        #finalRefundAmount {
            font-size: 5rem;
            font-weight: 900;
            letter-spacing: -3px;
            text-shadow: 0 6px 30px rgba(0, 0, 0, 0.15);
            position: relative;
            z-index: 2;
        }

        #resultsBreakdown {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.98) 0%, rgba(255, 255, 255, 0.95) 100%);
            backdrop-filter: blur(30px);
            border-radius: 24px;
            padding: 45px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.1), 0 5px 20px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(32, 178, 170, 0.12);
            position: relative;
            overflow: visible;
            margin-bottom: 30px;
            pointer-events: auto !important;
        }

        #resultsBreakdown::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #20B2AA 0%, #17a2b8 50%, #20B2AA 100%);
            background-size: 200% 100%;
            animation: gradientShift 3s ease infinite;
            pointer-events: none;
            z-index: 1;
        }

        #breakdownDetails {
            display: block !important;
            visibility: visible !important;
            margin-top: 20px;
        }

        .breakdown-header,
        .breakdown-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 16px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e0e0;
        }

        .breakdown-footer {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 2px solid #e0e0e0;
            border-bottom: none;
        }

        .breakdown-row {
            display: flex !important;
            justify-content: space-between;
            align-items: center;
            gap: 16px;
            padding: 18px 24px;
            border-bottom: 1px solid rgba(240, 240, 240, 0.9);
            background: rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            margin-bottom: 10px;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        #wizardStep2 .breakdown-row {
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        .breakdown-row:hover {
            background: rgba(32, 178, 170, 0.05);
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(32, 178, 170, 0.12);
        }

        .breakdown-label {
            color: #6c757d;
            font-size: 0.95rem;
            display: inline-block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        #wizardStep2 .breakdown-label {
            display: inline-block !important;
            visibility: visible !important;
            opacity: 1 !important;
            color: #6b7a90 !important;
        }

        .breakdown-value {
            color: #2c3e50;
            font-weight: 600;
            font-size: 1rem;
            display: inline-block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        #wizardStep2 .breakdown-value {
            display: inline-block !important;
            visibility: visible !important;
            opacity: 1 !important;
            color: #2c3e50 !important;
        }

        .breakdown-total {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 16px;
            background: linear-gradient(135deg, #20B2AA 0%, #17a2b8 100%);
            color: white;
            border-radius: 16px;
            padding: 28px;
            margin-top: 28px;
            box-shadow: 0 8px 28px rgba(32, 178, 170, 0.3);
        }

        .breakdown-total span {
            color: white;
            font-weight: 700;
        }

        .results-actions {
            text-align: center;
            margin-top: 40px;
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        /* Radio and Checkbox Styling */
        input[type="radio"],
        input[type="checkbox"] {
            width: 24px;
            height: 24px;
            cursor: pointer;
            accent-color: #20B2AA;
            transition: all 0.3s ease;
        }

        input[type="radio"]:hover,
        input[type="checkbox"]:hover {
            transform: scale(1.1);
        }

        label[style*="display: flex"] {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 16px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(248, 249, 250, 0.9) 100%);
            backdrop-filter: blur(10px);
        }

        label[style*="display: flex"]:hover {
            background: rgba(32, 178, 170, 0.08);
            border-color: #20B2AA;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(32, 178, 170, 0.15);
        }

        label[style*="display: flex"]:has(input:checked) {
            background: linear-gradient(135deg, rgba(32, 178, 170, 0.1) 0%, rgba(23, 162, 184, 0.1) 100%);
            border-color: #20B2AA;
            box-shadow: 0 4px 16px rgba(32, 178, 170, 0.2);
        }

        /* Dependent Section */
        .dependent-item {
            border: 2px solid #e8e8e8;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 24px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 249, 250, 0.95) 100%);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        }

        .dependent-item:hover {
            border-color: #20B2AA;
            box-shadow: 0 8px 24px rgba(32, 178, 170, 0.15);
            transform: translateY(-2px);
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .calculator-card-new,
            .calculator-header {
                padding: 40px 30px;
            }

            #step6 > div:first-child {
                padding: 60px 40px;
            }

            #resultsBreakdown {
                padding: 35px 28px;
            }

            .breakdown-header,
            .breakdown-footer,
            .breakdown-row,
            .breakdown-total {
                flex-direction: column;
                align-items: flex-start;
            }

            .breakdown-row,
            .breakdown-total {
                width: 100%;
            }

            .results-actions {
                justify-content: flex-start;
            }

            .step1-layout {
                flex-direction: column;
            }

            .step1-illustration {
                flex: none;
                width: 100%;
            }

            .deduction-options-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .calculator-hero {
                padding: 120px 0 60px;
            }

            .calculator-title {
                font-size: 2.2rem;
            }

            .calculator-subtitle {
                font-size: 1rem;
            }

            .calculator-info-card {
                padding: 25px;
            }

            .calculator-card-new {
                padding: 35px 25px;
                border-radius: 20px;
            }

            .calculator-header {
                padding: 35px 25px;
                border-radius: 20px;
            }

            .calculator-step h2 {
                font-size: 1.9rem;
            }

            #estimatedRefundDisplay {
                font-size: 2.8rem;
            }

            .form-field-row {
                flex-wrap: wrap;
                padding: 16px 12px;
            }

            .progress-steps-new {
                flex-wrap: wrap;
                gap: 8px;
            }

            .step-circle {
                width: 44px;
                height: 44px;
                font-size: 1rem;
            }

            .step-label {
                font-size: 0.65rem;
            }

            .progress-line {
                display: none;
            }

            .btn-get-estimate,
            .btn-next-step {
                padding: 16px 40px;
                font-size: 1.1rem;
            }

            #finalRefundAmount {
                font-size: 3.5rem;
            }

            #resultsBreakdown {
                padding: 30px 20px;
            }

            #creditsGrid {
                grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
            }

            .step1-intro h2 {
                font-size: 1.8rem;
            }

            .step1-mobile-card {
                padding: 20px;
            }
        }

        @media (max-width: 576px) {
            .form-field-row {
                flex-direction: column !important;
                align-items: flex-start !important;
            }

            .form-field-row span {
                margin-bottom: 6px;
            }

            #step6 > div:first-child {
                padding: 40px 20px;
            }

            #finalRefundAmount {
                font-size: 2.8rem;
            }

            #resultsBreakdown {
                padding: 24px 16px;
            }

            .breakdown-row,
            .breakdown-total,
            .breakdown-header,
            .breakdown-footer {
                padding: 16px;
            }

            .results-actions {
                flex-direction: column;
                align-items: stretch;
            }

            #creditsGrid {
                grid-template-columns: 1fr !important;
            }

            .step1-intro {
                text-align: left;
                padding: 20px 15px !important;
            }
            
            .step1-intro h2 {
                font-size: 1.5rem !important;
                margin-bottom: 15px !important;
            }
            
            .step1-intro p {
                font-size: 0.9rem !important;
                margin-bottom: 20px !important;
            }
            
            .step1-intro-tag {
                font-size: 0.75rem !important;
                padding: 6px 12px !important;
                margin-bottom: 15px !important;
            }

            .step1-illustration {
                min-height: 150px !important;
                padding: 20px 15px !important;
            }
            
            .step1-illustration-content {
                font-size: 0.9rem !important;
            }

            .mobile-help {
                margin-top: 6px;
                font-size: 0.8rem !important;
            }
            
            .step1-mobile-card {
                padding: 20px 15px !important;
            }
            
            /* Results step responsive */
            #step6 > div[style*="grid"] {
                grid-template-columns: 1fr !important;
                gap: 30px !important;
            }
            
            #step6 #finalRefundAmount {
                font-size: 3rem !important;
            }
            
            #step6 > div:first-child > div:first-child {
                padding-right: 0 !important;
            }
            
            #resultsBreakdown {
                padding: 20px 15px !important;
                min-height: auto !important;
            }
            
            #wizardStep1, #wizardStep2 {
                margin-top: 15px !important;
            }
            
            #wizardStep1 h3, #wizardStep2 h3 {
                font-size: 1.1rem !important;
                margin-bottom: 15px !important;
            }
            
            #myDetailsContent, #estimateBreakdownContent {
                margin-top: 15px !important;
            }
            
            .breakdown-row {
                padding: 10px 0 !important;
                font-size: 0.9rem !important;
            }
            
            .breakdown-label, .breakdown-value {
                font-size: 0.9rem !important;
            }
            
            #updateInfoBtn {
                padding: 8px 20px !important;
                font-size: 0.85rem !important;
            }
            
            /* Step 1 - Mobile form fields */
            .mobile-field-group {
                margin-bottom: 18px !important;
            }
            
            .mobile-field-label {
                font-size: 0.9rem !important;
                margin-bottom: 8px !important;
                line-height: 1.4 !important;
            }
            
            .mobile-field-control {
                width: 100% !important;
            }
            
            .mobile-field-control input,
            .mobile-field-control select {
                font-size: 0.95rem !important;
                padding: 10px 12px !important;
                width: 100% !important;
                box-sizing: border-box !important;
            }
            
            /* Step 1 grid layout mobile */
            .step1-container {
                flex-direction: column !important;
            }
            
            .step1-mobile-card {
                order: 2 !important;
            }
            
            .step1-illustration {
                order: 1 !important;
                margin-bottom: 20px !important;
            }
            
            .mobile-field-control input[type="number"] {
                font-size: 0.95rem !important;
            }
            
            .mobile-field-control span {
                font-size: 0.9rem !important;
                white-space: nowrap !important;
            }
            
            /* Form select custom mobile */
            .form-select-custom {
                font-size: 0.95rem !important;
                padding: 10px 40px 10px 12px !important;
                width: 100% !important;
                box-sizing: border-box !important;
            }
            
            /* Check icons mobile */
            .mobile-field-control .fa-check-circle {
                font-size: 1rem !important;
                flex-shrink: 0 !important;
            }
            
            /* Age input with "years old" text mobile */
            .mobile-field-control[style*="display: flex"] {
                flex-wrap: wrap !important;
            }
            
            .mobile-field-control[style*="display: flex"] input {
                min-width: 0 !important;
                flex: 1 1 auto !important;
            }
            
            .mobile-field-control[style*="display: flex"] span {
                flex-shrink: 0 !important;
            }
            
            /* Step 2 - Dependents mobile */
            #step2 h2 {
                font-size: 1.6rem !important;
            }
            
            #step2 label {
                padding: 10px !important;
                font-size: 0.95rem !important;
            }
            
            /* Step 3 - Income types mobile */
            #incomeTypesGrid {
                grid-template-columns: 1fr !important;
                gap: 10px !important;
            }
            
            .income-type-btn {
                padding: 12px 15px !important;
                font-size: 0.85rem !important;
            }
            
            /* Income form containers mobile */
            #w2FormContainer,
            #interestFormContainer,
            #businessFormContainer,
            #socialSecurityFormContainer,
            #dividendsFormContainer,
            #combatPayFormContainer,
            #unemploymentFormContainer,
            #taxRefundFormContainer,
            #capitalGainsFormContainer,
            #otherIncomeFormContainer {
                padding: 15px 12px !important;
                margin-bottom: 20px !important;
            }
            
            #w2FormContainer > div:first-child,
            #interestFormContainer > div:first-child,
            #businessFormContainer > div:first-child {
                flex-direction: column !important;
                align-items: flex-start !important;
                gap: 10px !important;
            }
            
            #w2FormContainer h3,
            #interestFormContainer h3,
            #businessFormContainer h3,
            #socialSecurityFormContainer h3,
            #dividendsFormContainer h3,
            #combatPayFormContainer h3,
            #unemploymentFormContainer h3,
            #taxRefundFormContainer h3,
            #capitalGainsFormContainer h3,
            #otherIncomeFormContainer h3 {
                font-size: 1.1rem !important;
                margin-bottom: 15px !important;
            }
            
            /* Form container close button mobile */
            #w2FormContainer button[onclick*="close"],
            #interestFormContainer button[onclick*="close"],
            #businessFormContainer button[onclick*="close"] {
                width: 28px !important;
                height: 28px !important;
                font-size: 1.2rem !important;
            }
            
            /* Form container buttons mobile */
            #w2FormContainer button[onclick*="save"],
            #interestFormContainer button[onclick*="save"],
            #businessFormContainer button[onclick*="save"] {
                width: 100% !important;
                padding: 12px !important;
                font-size: 0.95rem !important;
            }
            
            #w2FormContainer button[onclick*="addAnother"],
            #unemploymentFormContainer button[onclick*="addAnother"] {
                padding: 10px 20px !important;
                font-size: 0.9rem !important;
            }
            
            /* W-2 form fields mobile */
            .w2-form-item {
                padding: 15px 12px !important;
                margin-bottom: 15px !important;
            }
            
            .w2-form-item > div {
                margin-bottom: 15px !important;
            }
            
            .w2-form-item label {
                font-size: 0.85rem !important;
                margin-bottom: 6px !important;
            }
            
            .w2-form-item input[type="text"] {
                font-size: 0.9rem !important;
                padding: 10px 12px !important;
            }
            
            .w2-form-item small {
                font-size: 0.75rem !important;
            }
            
            .w2-form-item span[style*="font-size: 1.1rem"] {
                font-size: 0.95rem !important;
            }
            
            .w2-form-item label[style*="display: flex"] {
                font-size: 0.85rem !important;
            }
            
            .w2-form-item input[type="radio"] {
                width: 16px !important;
                height: 16px !important;
            }
            
            .w2-form-item button[onclick*="removeW2Form"] {
                width: 100% !important;
                padding: 10px !important;
                font-size: 0.85rem !important;
            }
            
            #w2FormsContainer input,
            #w2FormsContainer select,
            #w2FormsContainer label {
                font-size: 0.9rem !important;
            }
            
            #w2FormsContainer input,
            #w2FormsContainer select {
                padding: 10px 12px !important;
            }
            
            #w2FormsContainer > div {
                margin-bottom: 15px !important;
            }
            
            /* Continue my estimate button mobile */
            #step6 button[onclick*="goToStep(2)"] {
                width: 100% !important;
                padding: 12px 20px !important;
                font-size: 0.95rem !important;
            }
            
            #step6 h3 {
                font-size: 1.1rem !important;
            }
            
            #step6 p {
                font-size: 0.85rem !important;
            }
            
            /* Step 4 - Deductions mobile */
            .deduction-options-grid {
                grid-template-columns: 1fr !important;
                gap: 12px !important;
            }
            
            .deduction-options-grid > div {
                padding: 20px 15px !important;
            }
            
            .deduction-options-grid h3 {
                font-size: 1.2rem !important;
                margin-top: 30px !important;
            }
            
            .deduction-options-grid p {
                font-size: 0.9rem !important;
            }
            
            .btn-continue-standard,
            .btn-continue-itemized {
                padding: 12px !important;
                font-size: 0.95rem !important;
            }
            
            /* Step 5 - Credits mobile */
            #creditsGrid {
                grid-template-columns: 1fr !important;
                gap: 10px !important;
            }
            
            .credit-btn {
                padding: 12px 15px !important;
                font-size: 0.85rem !important;
            }
            
            /* Buttons mobile */
            .btn-back-step,
            .btn-next-step,
            .btn-get-estimate {
                width: 100% !important;
                padding: 12px 24px !important;
                font-size: 0.95rem !important;
                border-radius: 50px !important;
            }
            
            .btn-get-estimate {
                margin-top: 30px !important;
            }
            
            /* Step 2 radio buttons mobile */
            #step2 label[style*="display: flex"] {
                padding: 12px 15px !important;
                font-size: 1rem !important;
            }
            
            #step2 label input[type="radio"] {
                width: 18px !important;
                height: 18px !important;
                margin-right: 12px !important;
            }
            
            /* Step 5 checkbox mobile */
            #step5 label[style*="display: flex"] {
                padding: 12px 15px !important;
            }
            
            #step5 label input[type="checkbox"] {
                width: 18px !important;
                height: 18px !important;
                margin-right: 12px !important;
            }
            
            #step5 label span {
                font-size: 1rem !important;
            }
            
            /* Step navigation containers mobile */
            #step2 > div:last-child,
            #step3 > div:last-child,
            #step4 > div:last-child,
            #step5 > div:last-child {
                flex-direction: column !important;
                gap: 12px !important;
            }
            
            #step2 > div:last-child > button,
            #step3 > div:last-child > button,
            #step4 > div:last-child > button,
            #step5 > div:last-child > button {
                width: 100% !important;
            }
            
            /* Progress steps mobile */
            .progress-steps-new {
                gap: 5px !important;
            }
            
            .step-circle {
                width: 36px !important;
                height: 36px !important;
                font-size: 0.85rem !important;
            }
            
            .step-label {
                font-size: 0.6rem !important;
            }
            
            /* Dependent forms mobile */
            #dependentsList,
            #newDependentForm {
                margin-bottom: 15px !important;
            }
            
            .dependent-item {
                padding: 15px 12px !important;
                margin-bottom: 15px !important;
            }
            
            .dependent-item input,
            .dependent-item select {
                font-size: 0.9rem !important;
                padding: 10px 12px !important;
            }
            
            .dependent-item label {
                font-size: 0.85rem !important;
                margin-bottom: 6px !important;
            }
            
            .dependent-item button {
                padding: 8px 16px !important;
                font-size: 0.85rem !important;
            }
            
            #dependentsList > div,
            #newDependentForm > div {
                padding: 15px 12px !important;
            }
            
            #addDependentBtn {
                width: 100% !important;
                padding: 12px 20px !important;
                font-size: 0.9rem !important;
            }
            
            /* W-2 form fields mobile */
            #w2FormsContainer input,
            #w2FormsContainer select {
                font-size: 0.9rem !important;
                padding: 8px 10px !important;
            }
            
            /* Calculator header mobile */
            .calculator-header {
                padding: 25px 20px !important;
            }
            
            #estimatedRefundDisplay {
                font-size: 2.5rem !important;
            }
            
            /* Step titles mobile */
            .calculator-step h2 {
                font-size: 1.7rem !important;
                margin-bottom: 20px !important;
            }
            
            .calculator-step p {
                font-size: 0.9rem !important;
            }
            
            /* Info boxes mobile */
            .calculator-step > div[style*="background: #f5f5f5"] {
                padding: 15px !important;
                flex-direction: column !important;
            }
            
            .calculator-step > div[style*="background: #f5f5f5"] i {
                font-size: 1.2rem !important;
            }
            
            .calculator-step > div[style*="background: #f5f5f5"] p {
                font-size: 0.85rem !important;
            }
            
            /* Results section mobile */
            #resultsBreakdown {
                padding: 20px 15px !important;
            }
            
            /* My Details section mobile */
            #wizardStep1 h3,
            #wizardStep2 h3 {
                font-size: 1.1rem !important;
                padding-bottom: 12px !important;
            }
            
            #wizardStep1 h3 i,
            #wizardStep2 h3 i {
                font-size: 1rem !important;
            }
            
            #wizardStep1 h3 span,
            #wizardStep2 h3 span {
                gap: 8px !important;
            }
            
            #myDetailsContent > div > div,
            #wizardStep1 > div > div[style*="display: flex"] {
                padding: 10px 0 !important;
                flex-wrap: wrap !important;
            }
            
            #myDetailsContent span[style*="color: #0f5132"],
            #wizardStep1 span[style*="color: #0f5132"] {
                font-size: 0.85rem !important;
            }
            
            #resultMaritalStatus,
            #resultFilingStatus,
            #resultAge,
            #resultSpouseAge,
            #resultMyIncome,
            #resultSpouseIncome,
            #resultMyWithholdings,
            #resultSpouseWithholdings {
                font-size: 0.85rem !important;
            }
            
            /* Breakdown rows mobile */
            .breakdown-row {
                padding: 10px 0 !important;
                flex-wrap: wrap !important;
            }
            
            .breakdown-label,
            .breakdown-value {
                font-size: 0.85rem !important;
            }
            
            .breakdown-row > div[style*="color: #6b7280"] {
                font-size: 0.75rem !important;
                margin-top: 4px !important;
            }
            
            /* Update info button mobile */
            #updateInfoBtn {
                width: 100% !important;
                padding: 12px 20px !important;
                font-size: 0.85rem !important;
            }
            
            /* Collapsible chevron mobile */
            #detailsChevron,
            #breakdownChevron {
                font-size: 0.8rem !important;
            }
            
            /* Step 6 left column mobile */
            #step6 > div:first-child > div:first-child {
                padding: 20px 15px !important;
            }
            
            #step6 > div:first-child > div:first-child h3 {
                font-size: 1.1rem !important;
                margin-bottom: 15px !important;
            }
            
            #step6 > div:first-child > div:first-child p {
                font-size: 0.85rem !important;
                margin-bottom: 20px !important;
            }
        }
        
        /* Additional responsive for very small screens */
        @media (max-width: 400px) {
            .calculator-card-new {
                padding: 20px 15px !important;
            }
            
            .calculator-header {
                padding: 20px 15px !important;
            }
            
            #finalRefundAmount {
                font-size: 2.5rem !important;
            }
            
            .step-circle {
                width: 32px !important;
                height: 32px !important;
                font-size: 0.75rem !important;
            }
            
            .step-label {
                font-size: 0.55rem !important;
            }
        }
        
        @media (max-width: 768px) {
            /* Step 6 grid layout - stack columns on tablet */
            .step6-grid,
            #step6 > div[style*="grid"] {
                display: grid !important;
                grid-template-columns: 1fr !important;
                gap: 30px !important;
            }
            
            #step6 > div:first-child > div:first-child {
                padding-right: 0 !important;
            }
            
            #finalRefundAmount {
                font-size: 3rem !important;
            }
            
            #finalRefundLabel {
                font-size: 1.1rem !important;
            }
            
            #resultsBreakdown {
                padding: 25px 20px !important;
            }
            
            #wizardStep1 h3, #wizardStep2 h3 {
                font-size: 1.15rem !important;
            }
            
            .breakdown-row {
                padding: 12px 0 !important;
            }
            
            .breakdown-label,
            .breakdown-value {
                font-size: 0.9rem !important;
            }
            
            #wizardStep1 h3,
            #wizardStep2 h3 {
                font-size: 1.15rem !important;
            }
            
            #myDetailsContent > div > div,
            #wizardStep1 > div > div[style*="display: flex"] {
                padding: 10px 0 !important;
            }
            
            #myDetailsContent span[style*="color: #0f5132"],
            #wizardStep1 span[style*="color: #0f5132"] {
                font-size: 0.9rem !important;
            }
            
            #step6 h3 {
                font-size: 1.2rem !important;
            }
            
            #step6 p {
                font-size: 0.9rem !important;
            }
            
            #step6 button {
                padding: 12px 24px !important;
                font-size: 0.95rem !important;
            }
            
            #updateInfoBtn {
                padding: 12px 24px !important;
                font-size: 0.9rem !important;
            }
            
            /* Step 1 - Form fields responsive */
            .mobile-field-group {
                margin-bottom: 20px !important;
            }
            
            .mobile-field-label {
                font-size: 0.95rem !important;
                margin-bottom: 8px !important;
            }
            
            .mobile-field-control input,
            .mobile-field-control select {
                font-size: 1rem !important;
                padding: 10px 12px !important;
            }
            
            /* Step 2 - Dependents responsive */
            #step2 label {
                padding: 12px !important;
                font-size: 1rem !important;
            }
            
            #dependentsSection {
                margin-top: 20px !important;
            }
            
            #addDependentBtn {
                width: 100% !important;
                padding: 12px 20px !important;
            }
            
            /* Step 3 - Income types grid responsive */
            #incomeTypesGrid {
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 12px !important;
            }
            
            .income-type-btn {
                padding: 12px 15px !important;
                font-size: 0.9rem !important;
            }
            
            /* Income form containers responsive */
            #w2FormContainer,
            #interestFormContainer,
            #businessFormContainer,
            #socialSecurityFormContainer,
            #dividendsFormContainer,
            #combatPayFormContainer,
            #unemploymentFormContainer,
            #taxRefundFormContainer,
            #capitalGainsFormContainer,
            #otherIncomeFormContainer {
                padding: 20px 15px !important;
            }
            
            #w2FormContainer h3,
            #interestFormContainer h3,
            #businessFormContainer h3 {
                font-size: 1.2rem !important;
            }
            
            /* Step 4 - Deduction options responsive */
            .deduction-options-grid {
                grid-template-columns: 1fr !important;
                gap: 15px !important;
            }
            
            /* Step 5 - Credits grid responsive */
            #creditsGrid {
                grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
                gap: 12px !important;
            }
            
            .credit-btn {
                padding: 12px 15px !important;
                font-size: 0.9rem !important;
            }
            
            /* Navigation buttons responsive */
            .btn-back-step,
            .btn-next-step,
            .btn-get-estimate {
                width: 100% !important;
                padding: 14px 30px !important;
                font-size: 1rem !important;
            }
            
            /* Step navigation buttons container */
            #step2 > div:last-child,
            #step3 > div:last-child,
            #step4 > div:last-child,
            #step5 > div:last-child {
                flex-direction: column !important;
                gap: 15px !important;
            }
            
            #step2 > div:last-child > button,
            #step3 > div:last-child > button,
            #step4 > div:last-child > button,
            #step5 > div:last-child > button {
                width: 100% !important;
            }
        }

        /* Smooth Animations */
        .calculator-step {
            animation: fadeInUp 0.5s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Loading States */
        .btn-get-estimate:disabled,
        .btn-next-step:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        /* Focus States */
        *:focus-visible {
            outline: 2px solid #20B2AA;
            outline-offset: 4px;
            border-radius: 4px;
        }

        /* Ensure buttons are clickable */
        #nextWizardBtn,
        button[onclick*="nextWizardStep"],
        button[onclick*="goToStep"] {
            position: relative;
            z-index: 10;
            pointer-events: auto !important;
            cursor: pointer !important;
        }

        .wizard-step button {
            position: relative;
            z-index: 1000 !important;
            pointer-events: auto !important;
            cursor: pointer !important;
        }

        #resultsBreakdown button {
            position: relative;
            z-index: 1000 !important;
            pointer-events: auto !important;
            cursor: pointer !important;
        }

        .wizard-step {
            position: relative;
            z-index: 10;
            pointer-events: auto !important;
        }
        
        .wizard-step[style*="display: block"] {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        .wizard-step[style*="display: none"] {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            height: 0 !important;
            overflow: hidden !important;
        }

        #wizardStep1,
        #wizardStep2 {
            position: relative;
            z-index: 10;
            pointer-events: auto !important;
        }
        
        #wizardStep1[style*="display: none"]:not(.show),
        #wizardStep2[style*="display: none"]:not(.show) {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            height: 0 !important;
            overflow: hidden !important;
        }
        
        /* Override the above when show class is present */
        #wizardStep2.show {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            height: auto !important;
            overflow: visible !important;
        }
        
        #wizardStep2[style*="display: block"],
        #wizardStep2.show {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            height: auto !important;
            overflow: visible !important;
        }
        
        #wizardStep1[style*="display: block"] {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        #estimateBreakdownContent {
            min-height: 300px;
            height: auto;
            overflow: visible;
            position: relative;
        }
        
        #breakdownDetails {
            min-height: 200px;
            height: auto;
            overflow: visible;
            position: relative;
        }
        
        /* Removed !important to allow inline styles to control collapsible behavior */
        
        /* Force breakdown content to be visible when wizardStep2 is shown */
        #wizardStep2[style*="display: block"] .breakdown-row,
        #wizardStep2.show .breakdown-row,
        #wizardStep2 .breakdown-row {
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
            height: auto !important;
            min-height: 40px !important;
            position: relative !important;
            color: #2c3e50 !important;
            width: 100% !important;
        }
        
        #wizardStep2[style*="display: block"] .breakdown-total,
        #wizardStep2.show .breakdown-total,
        #wizardStep2 .breakdown-total {
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
            height: auto !important;
            min-height: 50px !important;
            position: relative !important;
            width: 100% !important;
        }
        
        #wizardStep2[style*="display: block"] .breakdown-label,
        #wizardStep2[style*="display: block"] .breakdown-value,
        #wizardStep2.show .breakdown-label,
        #wizardStep2.show .breakdown-value,
        #wizardStep2 .breakdown-label,
        #wizardStep2 .breakdown-value {
            display: inline-block !important;
            visibility: visible !important;
            opacity: 1 !important;
            color: #2c3e50 !important;
        }
        
        #wizardStep2[style*="display: block"] span,
        #wizardStep2.show span,
        #wizardStep2 span {
            display: inline-block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        #wizardStep2[style*="display: block"] #breakdownDetails,
        #wizardStep2.show #breakdownDetails,
        #wizardStep2 #breakdownDetails {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            height: auto !important;
            min-height: 200px !important;
            width: 100% !important;
        }
        
        /* Removed !important to allow inline styles to control collapsible behavior */
        
        /* Force visibility when breakdown tab is active - DIRECT SELECTOR */
        #wizardStep2.show,
        #wizardStep2.breakdown-tab-content.show,
        #wizardStep2[style*="display: block"],
        .breakdown-tab-content.show {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            height: auto !important;
            min-height: 400px !important;
        }
        
        /* Force ALL content inside wizardStep2 to be visible when it has show class */
        #wizardStep2.show *,
        #wizardStep2[style*="display: block"] * {
            visibility: visible !important;
        }
        
        #wizardStep2.show .breakdown-row,
        #wizardStep2[style*="display: block"] .breakdown-row {
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        /* Removed !important to allow inline styles to control visibility */
        
        /* Tab Styles */
        .tab-button {
            position: relative;
            transition: all 0.3s ease;
        }
        
        .tab-button:hover {
            background: rgba(32, 178, 170, 0.05) !important;
        }
        
        .tab-button.active {
            border-bottom-color: #20B2AA !important;
            color: #20B2AA !important;
        }
        
        .tab-button:not(.active) {
            border-bottom-color: transparent !important;
            color: #6c757d !important;
        }
        
        /* SIMPLE CSS-BASED TAB SYSTEM - STRICT RULES */
        /* Hide by default */
        #wizardStep1.tab-content,
        #wizardStep2.tab-content,
        .wizard-step.tab-content {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            height: 0 !important;
            overflow: hidden !important;
        }
        
        /* Show only when active-tab is present AND tab-content is NOT present */
        #wizardStep1.active-tab:not(.tab-content),
        #wizardStep2.active-tab:not(.tab-content),
        .wizard-step.active-tab:not(.tab-content) {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            position: relative !important;
            z-index: 100 !important;
            height: auto !important;
            overflow: visible !important;
        }
        
        /* More direct selector for wizardStep2 when active */
        #wizardStep2.active-tab {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        /* Hide wizardStep2 when it has tab-content BUT NOT when it has active-tab */
        #wizardStep2.tab-content:not(.active-tab) {
            display: none !important;
            visibility: hidden !important;
        }
        
        /* Force hide if both classes are present (shouldn't happen, but just in case) */
        .wizard-step.tab-content.active-tab {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
        }
        
        /* Ensure breakdown content is always visible when its tab is active */
        #wizardStep2.active-tab #estimateBreakdownContent,
        #wizardStep2.active-tab #breakdownDetails,
        .wizard-step.active-tab:not(.tab-content) #estimateBreakdownContent,
        .wizard-step.active-tab:not(.tab-content) #breakdownDetails {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        #wizardStep2.active-tab .breakdown-row,
        .wizard-step.active-tab:not(.tab-content) .breakdown-row {
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        /* Special handling for rows with nested divs (taxable income, taxes refunded) */
        #wizardStep2.active-tab .breakdown-row[style*="padding"],
        .wizard-step.active-tab:not(.tab-content) .breakdown-row[style*="padding"] {
            display: block !important;
        }
        
        #wizardStep2.active-tab .breakdown-row[style*="padding"] > div,
        .wizard-step.active-tab:not(.tab-content) .breakdown-row[style*="padding"] > div {
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        #wizardStep2.active-tab .breakdown-total,
        .wizard-step.active-tab:not(.tab-content) .breakdown-total {
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        /* Ensure all spans and labels are visible */
        #wizardStep2.active-tab .breakdown-label,
        #wizardStep2.active-tab .breakdown-value,
        #wizardStep2.active-tab span,
        .wizard-step.active-tab:not(.tab-content) .breakdown-label,
        .wizard-step.active-tab:not(.tab-content) .breakdown-value,
        .wizard-step.active-tab:not(.tab-content) span {
            display: inline-block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        /* Ensure h3 heading is visible */
        #wizardStep2.active-tab h3,
        .wizard-step.active-tab:not(.tab-content) h3 {
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
    </style>
</head>
<body>
    <!-- Top Bar -->
    <div class="top-bar">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <div class="top-bar-info">
                        <span><i class="fas fa-phone me-2"></i>718-395-9663</span>
                        <span><i class="fas fa-envelope me-2"></i>support@jvstaxservices.com</span>
                    </div>
                </div>
                <div class="col-md-6 text-end">
                    <div class="top-bar-social">
                        <a href="#" class="social-link"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-linkedin-in"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
        <div class="container-fluid px-4">
            <a class="navbar-brand" href="/">
                <div class="brand-container">
                    <div class="logo-circle">
                        <img src="images/JVS Official Logo.webp" alt="JVS Tax Services Logo" class="tree-logo">
                    </div>
                </div>
            </a>
            <button class="navbar-toggler custom-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item"><a class="nav-link" href="/index.html">HOME</a></li>
                    <li class="nav-item"><a class="nav-link" href="/about.html">ABOUT</a></li>
                    <li class="nav-item"><a class="nav-link" href="/contact.html">CONTACT</a></li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="resourcesDropdown" role="button" data-bs-toggle="dropdown">
                            RESOURCES <i class="fas fa-chevron-down ms-1"></i>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="/protection-plus.html"><i class="fas fa-shield-alt me-2"></i>Protection Plus Plan</a></li>
                            <li><a class="dropdown-item" href="/pricing.html"><i class="fas fa-calculator me-2"></i>Pricing Sheet</a></li>
                            <li><a class="dropdown-item active" href="/tax-calculator.html"><i class="fas fa-calculator me-2"></i>Tax Calculator</a></li>
                            <li><a class="dropdown-item" href="/refund-transfer.html"><i class="fas fa-book me-2"></i>Refund Transfer</a></li>
                            <li><a class="dropdown-item" href="/fast-money-card.html"><i class="fas fa-credit-card me-2"></i>Fast Money Visa Prepaid Card</a></li>
                            <li><a class="dropdown-item" href="https://www.irs.gov/refunds" target="_blank" rel="noopener"><i class="fas fa-search-dollar me-2"></i>Track Federal Refund</a></li>
                            <li><a class="dropdown-item" href="/track-state-refund.html"><i class="fas fa-search-dollar me-2"></i>Track State Refund</a></li>
                            <li><a class="dropdown-item" href="/privacy-policy.html"><i class="fas fa-shield-alt me-2"></i>Privacy Policy</a></li>
                            <li><a class="dropdown-item" href="/blog.html"><i class="fas fa-blog me-2"></i>Our Blog</a></li>
                        </ul>
                    </li>
                    <li class="nav-item"><a class="nav-link" href="/faqs.html">FAQS</a></li>
                </ul>
                <div class="navbar-actions">
                    <a href="#signin" class="btn btn-signin"><i class="fas fa-user"></i><span>SIGN IN</span></a>
                    <a href="#appointment" class="btn btn-appointment"><i class="fas fa-calendar-check"></i><span>BOOK YOUR APPOINTMENT</span></a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section - Matching About Page -->
    <section class="about-hero">
        <div class="container">
            <div class="row align-items-center" style="margin-top: 10px;">
                <div class="col-lg-8" style="margin-top: 20px;">                    
                    <h1 class="about-title animate-fade-in-up" style="animation-delay: 0.1s;">                       
                        Get a clear estimate with our tax calculator
                    </h1>
                    <div class="about-badge animate-fade-in-up">
                        <i class="fas fa-calculator me-2"></i> Professional Tax Estimation Tool
                    </div>
                    <p class="about-subtitle animate-fade-in-up" style="animation-delay: 0.2s;font-size:17px;">
                        Know what to expect this tax season with our tax refund calculator, now supporting the latest tax law changes. Get an accurate estimate of your tax refund or liability with our professional calculator that guides you through each step with clarity and precision.
                    </p>
                    <p class="about-subtitle animate-fade-in-up" style="animation-delay: 0.2s;font-size:17px;">
                        Our calculator helps you understand your tax situation before filing, allowing you to plan ahead and make informed decisions about your finances. Whether you're expecting a refund or might owe taxes, we're here to help you navigate the process with confidence.
                    </p>
                    <div class="animate-fade-in-up mt-4" style="animation-delay: 0.3s; display: flex; align-items: center; gap: 1rem; flex-wrap: wrap;">
                        <a href="#calculator" class="btn-start-estimate" id="startCalculatorBtn" style="text-decoration: none; display: inline-block; flex-shrink: 0;">
                            Start my estimate
                        </a>
                        <a href="/contact.html" class="btn btn-hero-secondary" style="background: rgba(255, 255, 255, 0.12); backdrop-filter: blur(16px); border: 2px solid rgba(255, 255, 255, 0.35); color: white; padding: 1rem 2rem; border-radius: 50px; font-weight: 700; text-decoration: none; display: inline-block; flex-shrink: 0;">
                            File my taxes
                        </a>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="about-info-card animate-fade-in-right" style="animation-delay: 0.4s;">
                        <div class="row">
                            <div class="col-6">
                                <div class="text-center">
                                    <div class="text-white mb-2">
                                        <i class="fas fa-calculator fa-2x"></i>
                                    </div>
                                    <div class="text-white fw-bold">100%</div>
                                    <div class="text-white-50 small">Accurate</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="text-center">
                                    <div class="text-white mb-2">
                                        <i class="fas fa-clock fa-2x"></i>
                                    </div>
                                    <div class="text-white fw-bold">Fast</div>
                                    <div class="text-white-50 small">Results</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- How the Tax Calculator Works Section -->
    <section class="about-section py-5">
        <div class="container">
            <div class="row">
                <div class="col-12 text-center mb-5">
                    <h2 class="section-title" style="color: #2c3e50; font-weight: 700; font-size: 2.5rem; margin-bottom: 1rem;">How the tax calculator works</h2>
                </div>
            </div>
            <div class="row g-4 align-items-stretch">
                <div class="col-lg-4 col-md-6">
                    <div class="simple-card h-100 animate-fade-in-up">
                        <div class="value-icon mb-3">
                            <i class="fas fa-question-circle"></i>
                        </div>
                        <h3 style="color: #0f5132; font-weight: 700; margin-bottom: 15px; font-size: 1.3rem;">Answer a few simple questions</h3>
                        <p style="color: #5b6b7e; line-height: 1.6; margin: 0;">Answer a few simple questions for a quick estimate. Get started with basic information about your filing status, age, and tax withholdings.</p>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6">
                    <div class="simple-card h-100 animate-fade-in-up" style="animation-delay: 0.1s;">
                        <div class="value-icon mb-3">
                            <i class="fas fa-user-friends"></i>
                        </div>
                        <h3 style="color: #0f5132; font-weight: 700; margin-bottom: 15px; font-size: 1.3rem;">Share details about dependents, income, and deductions</h3>
                        <p style="color: #5b6b7e; line-height: 1.6; margin: 0;">Share details about dependents, income, and deductions for a better result. Add more information to get a more accurate estimate of your tax situation.</p>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6">
                    <div class="simple-card h-100 animate-fade-in-up" style="animation-delay: 0.2s;">
                        <div class="value-icon mb-3">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h3 style="color: #0f5132; font-weight: 700; margin-bottom: 15px; font-size: 1.3rem;">Get your estimate and custom tax doc checklist</h3>
                        <p style="color: #5b6b7e; line-height: 1.6; margin: 0;">Stress less about tax season with your estimate and a personalized checklist of documents you'll need to file your taxes accurately.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Banner -->
    <section class="py-5">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-11 col-xl-10">
                    <div class="cta-banner">
                        <div class="calculator-icon">
                            <i class="fas fa-calculator"></i>
                        </div>
                        <div class="cta-banner-text">
                            Ready to get a head start on your tax planning?
                        </div>
                        <button class="btn-cta-estimate" id="ctaStartCalculatorBtn">
                            Start my estimate
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Understand What Goes Into Your Tax Refund Section -->
    <section class="about-section py-5">
        <div class="container">
            <div class="row">
                <div class="col-12 text-center mb-5">
                    <h2 class="section-title" style="color: #2c3e50; font-weight: 700; font-size: 2.5rem; margin-bottom: 1rem;">Understand what goes into your tax refund</h2>
                </div>
            </div>
            <div class="row g-4 align-items-stretch">
                <div class="col-lg-6 col-md-6">
                    <div class="simple-card h-100 animate-fade-in-up">
                        <div class="value-icon mb-3">
                            <i class="fas fa-search"></i>
                        </div>
                        <h4 style="color: #0f5132; font-weight: 700; font-size: 1.2rem; margin-bottom: 12px;">
                            <a href="/blog.html" style="color: #0f5132; text-decoration: none;">Tax law changes <i class="fas fa-arrow-right ms-1" style="font-size: 0.9rem;"></i></a>
                        </h4>
                        <p style="color: #5b6b7e; line-height: 1.6; margin-bottom: 15px; font-size: 0.95rem;">New tax law changes can affect deductions, credits, and more. Our calculator stays up-to-date with the latest regulations to give you an accurate estimate.</p>
                    </div>
                </div>
                <div class="col-lg-6 col-md-6">
                    <div class="simple-card h-100 animate-fade-in-up" style="animation-delay: 0.1s;">
                        <div class="value-icon mb-3">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <h4 style="color: #0f5132; font-weight: 700; font-size: 1.2rem; margin-bottom: 12px;">
                            <a href="/blog.html" style="color: #0f5132; text-decoration: none;">Taxable income <i class="fas fa-arrow-right ms-1" style="font-size: 0.9rem;"></i></a>
                        </h4>
                        <p style="color: #5b6b7e; line-height: 1.6; margin-bottom: 15px; font-size: 0.95rem;">Your taxable income is your total income minus deductions. This amount directly affects your tax liability and potential refund.</p>
                    </div>
                </div>
                <div class="col-lg-6 col-md-6">
                    <div class="simple-card h-100 animate-fade-in-up" style="animation-delay: 0.2s;">
                        <div class="value-icon mb-3">
                            <i class="fas fa-file-invoice"></i>
                        </div>
                        <h4 style="color: #0f5132; font-weight: 700; font-size: 1.2rem; margin-bottom: 12px;">
                            <a href="/blog.html" style="color: #0f5132; text-decoration: none;">Credits & deductions <i class="fas fa-arrow-right ms-1" style="font-size: 0.9rem;"></i></a>
                        </h4>
                        <p style="color: #5b6b7e; line-height: 1.6; margin-bottom: 15px; font-size: 0.95rem;">Deductions reduce your taxable income, while credits reduce the amount of tax you owe. Both can significantly impact your refund.</p>
                    </div>
                </div>
                <div class="col-lg-6 col-md-6">
                    <div class="simple-card h-100 animate-fade-in-up" style="animation-delay: 0.3s;">
                        <div class="value-icon mb-3">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h4 style="color: #0f5132; font-weight: 700; font-size: 1.2rem; margin-bottom: 12px;">
                            <a href="/blog.html" style="color: #0f5132; text-decoration: none;">Tax brackets & tax breaks <i class="fas fa-arrow-right ms-1" style="font-size: 0.9rem;"></i></a>
                        </h4>
                        <p style="color: #5b6b7e; line-height: 1.6; margin-bottom: 15px; font-size: 0.95rem;">Tax brackets are determined by your income and filing status. Understanding your bracket helps you plan for tax breaks and optimize your return.</p>
                    </div>
                </div>
            </div>
            <div class="row mt-4">
                <div class="col-12 text-center">
                    <a href="/blog.html" style="color: #20B2AA; text-decoration: none; font-weight: 600; font-size: 1.05rem;">Still have questions? Explore resource center <i class="fas fa-arrow-right ms-1"></i></a>
                </div>
            </div>
        </div>
    </section>

    <!-- Choose How You Want to File Section -->
    <section class="about-section py-5">
        <div class="container">
            <div class="row">
                <div class="col-12 text-center mb-5">
                    <h2 class="section-title" style="color: #2c3e50; font-weight: 700; font-size: 2.5rem; margin-bottom: 1rem;">Choose how you want to file  on your own, with expert help, or we'll do it for you</h2>
                    <p class="text-muted mb-5" style="font-size: 1.1rem; color: #6c757d;">Taxpayers can qualify for free federal and state filing.</p>
                </div>
            </div>
            <div class="row g-4 align-items-stretch">
                <div class="col-lg-4">
                    <div class="pricing-card h-100 animate-fade-in-up">
                        <h4 class="pricing-card-title">File on your own with confidence</h4>
                        <p class="pricing-card-subtitle">Ready to qualify for free, easy guided simple tax returns.</p>
                        <ul class="pricing-features-list">
                            <li>
                                <i class="fas fa-check-circle"></i>
                                <span>Simple W-2, or, student, or unemployment income</span>
                            </li>
                            <li>
                                <i class="fas fa-check-circle"></i>
                                <span>File from any device</span>
                            </li>
                        </ul>
                        <a href="/contact.html" class="pricing-learn-more">Learn more <i class="fas fa-arrow-right ms-1"></i></a>
                        <div class="pricing-amount">
                            <span class="pricing-starting">Starting at</span>
                            <div class="pricing-price">$0</div>
                            <span class="pricing-note">+ $0 state additional for paid products</span>
                        </div>
                        <button class="btn-filing-pricing">File on my own</button>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="pricing-card h-100 animate-fade-in-up featured" style="animation-delay: 0.1s;">
                        <h4 class="pricing-card-title">File online with help by your side</h4>
                        <p class="pricing-card-subtitle">Online support from tax pros and AI assisted.</p>
                        <ul class="pricing-features-list">
                            <li>
                                <i class="fas fa-check-circle"></i>
                                <span>Deductions for families, homeowners, or investors</span>
                            </li>
                            <li>
                                <i class="fas fa-check-circle"></i>
                                <span>Access to tax pros from home</span>
                            </li>
                        </ul>
                        <a href="/contact.html" class="pricing-learn-more">Learn more <i class="fas fa-arrow-right ms-1"></i></a>
                        <div class="pricing-amount">
                            <span class="pricing-starting">Starting at</span>
                            <div class="pricing-price">$60</div>
                            <span class="pricing-note">+ $49 per state filed</span>
                        </div>
                        <button class="btn-filing-pricing">File with some help</button>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="pricing-card h-100 animate-fade-in-up" style="animation-delay: 0.2s;">
                        <h4 class="pricing-card-title">File stress-free with a tax pro</h4>
                        <p class="pricing-card-subtitle">Full, personalized support from home or in person.</p>
                        <ul class="pricing-features-list">
                            <li>
                                <i class="fas fa-check-circle"></i>
                                <span>Those engaged in an account or tax liability issues</span>
                            </li>
                            <li>
                                <i class="fas fa-check-circle"></i>
                                <span>Choose your tax pro to get expert tax advice</span>
                            </li>
                        </ul>
                        <a href="/contact.html" class="pricing-learn-more">Learn more <i class="fas fa-arrow-right ms-1"></i></a>
                        <div class="pricing-amount">
                            <span class="pricing-starting">Starting at</span>
                            <div class="pricing-price">$99</div>
                            <span class="pricing-note">+ additional state fee</span>
                        </div>
                        <button class="btn-filing-pricing">File with a tax pro</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Calculator Content - Professional Design -->
    <section class="calculator-content" id="calculatorSection" style="display: none; position: relative; z-index: 1; background: #f8f9fa; padding: 80px 0;">
        <div class="container" style="max-width: 1000px; position: relative; z-index: 2;">
            <!-- Header with Estimated Refund and Progress -->
            <div class="calculator-header">
                <div style="text-align: center; margin-bottom: 30px;">
                    <div id="estimatedRefundLabel" style="color: #6c757d; font-size: 1.1rem; margin-bottom: 12px; font-weight: 600; letter-spacing: 0.5px;">Your estimated refund:</div>
                    <div id="estimatedRefundDisplay">$0</div>
                </div>
                <!-- Progress Steps -->
                <div class="progress-steps-new" style="display: flex; justify-content: center; align-items: center; gap: 15px; margin-top: 30px;">
                    <div class="progress-step" data-step="1" style="display: flex; flex-direction: column; align-items: center;">
                        <div class="step-circle" style="width: 40px; height: 40px; border-radius: 50%; border: 2px solid #e0e0e0; display: flex; align-items: center; justify-content: center; background: white; color: #6c757d; font-weight: 600; margin-bottom: 8px;">1</div>
                        <div class="step-label" style="font-size: 0.85rem; color: #6c757d;">Personal Info</div>
                    </div>
                    <div class="progress-line" style="width: 60px; height: 2px; background: #e0e0e0; margin-top: -20px;"></div>
                    <div class="progress-step" data-step="2" style="display: flex; flex-direction: column; align-items: center;">
                        <div class="step-circle" style="width: 40px; height: 40px; border-radius: 50%; border: 2px solid #e0e0e0; display: flex; align-items: center; justify-content: center; background: white; color: #6c757d; font-weight: 600; margin-bottom: 8px;">2</div>
                        <div class="step-label" style="font-size: 0.85rem; color: #6c757d;">Dependents</div>
                    </div>
                    <div class="progress-line" style="width: 60px; height: 2px; background: #e0e0e0; margin-top: -20px;"></div>
                    <div class="progress-step" data-step="3" style="display: flex; flex-direction: column; align-items: center;">
                        <div class="step-circle" style="width: 40px; height: 40px; border-radius: 50%; border: 2px solid #e0e0e0; display: flex; align-items: center; justify-content: center; background: white; color: #6c757d; font-weight: 600; margin-bottom: 8px;">3</div>
                        <div class="step-label" style="font-size: 0.85rem; color: #6c757d;">Income</div>
                    </div>
                    <div class="progress-line" style="width: 60px; height: 2px; background: #e0e0e0; margin-top: -20px;"></div>
                    <div class="progress-step" data-step="4" style="display: flex; flex-direction: column; align-items: center;">
                        <div class="step-circle" style="width: 40px; height: 40px; border-radius: 50%; border: 2px solid #e0e0e0; display: flex; align-items: center; justify-content: center; background: white; color: #6c757d; font-weight: 600; margin-bottom: 8px;">4</div>
                        <div class="step-label" style="font-size: 0.85rem; color: #6c757d;">Deductions</div>
                    </div>
                    <div class="progress-line" style="width: 60px; height: 2px; background: #e0e0e0; margin-top: -20px;"></div>
                    <div class="progress-step" data-step="5" style="display: flex; flex-direction: column; align-items: center;">
                        <div class="step-circle" style="width: 40px; height: 40px; border-radius: 50%; border: 2px solid #e0e0e0; display: flex; align-items: center; justify-content: center; background: white; color: #6c757d; font-weight: 600; margin-bottom: 8px;">5</div>
                        <div class="step-label" style="font-size: 0.85rem; color: #6c757d;">Credits</div>
                    </div>
                    <div class="progress-line" style="width: 60px; height: 2px; background: #e0e0e0; margin-top: -20px;"></div>
                    <div class="progress-step" data-step="6" style="display: flex; flex-direction: column; align-items: center;">
                        <div class="step-circle" style="width: 40px; height: 40px; border-radius: 50%; border: 2px solid #e0e0e0; display: flex; align-items: center; justify-content: center; background: white; color: #6c757d; font-weight: 600; margin-bottom: 8px;">6</div>
                        <div class="step-label" style="font-size: 0.85rem; color: #6c757d;">Results</div>
                    </div>
                </div>
            </div>

            <!-- Calculator Form - Step by Step Wizard -->
            <div class="calculator-card-new" id="calculatorCard" style="background: white; border-radius: 15px; padding: 40px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                <form id="taxCalculatorForm">
                    <!-- Step 1: Personal Info (Matching Screenshot Design) -->
                    <div class="calculator-step active" id="step1" style="display: block;">
                        <div class="step1-intro">
                            <span class="step1-intro-tag"><i class="fas fa-calculator"></i> Tax Calculator</span>
                            <h2>Start your estimate with a few basic details</h2>
                            <p>You can add more info later to get a more accurate estimate.</p>
                        </div>

                        <div class="step1-layout">
                            <div class="step1-mobile-card">
                                <div class="mobile-field-group">
                                    <div class="mobile-field-label">I'm</div>
                                    <div class="mobile-field-control" style="position: relative;">
                                        <select class="form-select-custom" id="maritalStatus" style="width: 100%; padding: 12px 45px 12px 15px; border: 1px solid #e0e0e0; border-radius: 12px; background: #fdfdfd; font-size: 1.05rem; color: #0f5132; font-weight: 600; cursor: pointer;">
                                            <option value="">single or married</option>
                                            <option value="single">Single</option>
                                            <option value="married">Married</option>
                                        </select>
                                        <i class="fas fa-chevron-down" style="position: absolute; right: 18px; top: 50%; transform: translateY(-50%); color: #047857; pointer-events: none;"></i>
                                        <i class="fas fa-check-circle" id="maritalStatusCheck" style="position: absolute; right: 48px; top: 50%; transform: translateY(-50%); color: #20B2AA; display: none;"></i>
                                    </div>
                                </div>

                                <div class="mobile-field-group" id="filingStatusRow" style="display: none;">
                                    <div class="mobile-field-label">and</div>
                                    <div class="mobile-field-control" style="position: relative;">
                                        <select class="form-select-custom" id="filingStatus" style="width: 100%; padding: 12px 45px 12px 15px; border: 1px solid #e0e0e0; border-radius: 12px; background: #fff;">
                                            <option value="">enter filing status</option>
                                            <option value="single">Single</option>
                                            <option value="head_of_household">Head of Household</option>
                                        </select>
                                        <i class="fas fa-chevron-down" style="position: absolute; right: 18px; top: 50%; transform: translateY(-50%); color: #047857; pointer-events: none;"></i>
                                        <i class="fas fa-check-circle" id="filingStatusCheck" style="position: absolute; right: 48px; top: 50%; transform: translateY(-50%); color: #20B2AA; display: none;"></i>
                                    </div>
                                </div>

                                <div class="mobile-field-group">
                                    <div class="mobile-field-label">I'm</div>
                                    <div class="mobile-field-control" style="display: flex; gap: 12px; align-items: center;">
                                        <input type="number" id="age" placeholder="enter your age" style="flex: 1; padding: 12px 15px; border: 1px solid #e0e0e0; border-radius: 12px; font-size: 1.05rem; color: #2c3e50; background: #fff;">
                                        <span style="color: #0f5132; font-weight: 600;">years old</span>
                                        <i class="fas fa-check-circle" id="ageCheck" style="color: #20B2AA; display: none;"></i>
                                    </div>
                                </div>

                                <div class="mobile-field-group" id="spouseAgeRow" style="display: none;">
                                    <div class="mobile-field-label">My spouse is</div>
                                    <div class="mobile-field-control" style="display: flex; gap: 12px; align-items: center;">
                                        <input type="number" id="spouseAge" placeholder="enter their age" style="flex: 1; padding: 12px 15px; border: 1px solid #e0e0e0; border-radius: 12px; font-size: 1.05rem; color: #2c3e50; background: #fff;">
                                        <span style="color: #0f5132; font-weight: 600;">years old</span>
                                        <i class="fas fa-check-circle" id="spouseAgeCheck" style="color: #20B2AA; display: none;"></i>
                                    </div>
                                </div>

                                <div class="mobile-field-group" id="incomeTypeRow" style="display: none;">
                                    <div class="mobile-field-label">My income</div>
                                    <div class="mobile-field-control" style="position: relative;">
                                        <select class="form-select-custom" id="incomeType" style="width: 100%; padding: 12px 45px 12px 15px; border: 1px solid #e0e0e0; border-radius: 12px; background: #fff;">
                                            <option value="">select</option>
                                            <option value="includes_wages">Includes wages (W-2)</option>
                                            <option value="no_wages">Does not include wages</option>
                                        </select>
                                        <i class="fas fa-chevron-down" style="position: absolute; right: 18px; top: 50%; transform: translateY(-50%); color: #047857; pointer-events: none;"></i>
                                        <i class="fas fa-check-circle" id="incomeTypeCheck" style="position: absolute; right: 48px; top: 50%; transform: translateY(-50%); color: #20B2AA; display: none;"></i>
                                    </div>
                                </div>

                                <div class="mobile-field-group" id="wageIncomeRow" style="display: none;">
                                    <div class="mobile-field-label">My total wage income in 2025 was</div>
                                    <div class="mobile-field-control" style="display: flex; gap: 10px; align-items: center;">
                                        <span style="color: #0f5132; font-weight: 600;">$</span>
                                        <input type="text" inputmode="decimal" pattern="[0-9,]*" id="wageIncome" placeholder="0" style="flex: 1; padding: 12px 15px; border: 1px solid #e0e0e0; border-radius: 12px; font-size: 1.05rem; color: #2c3e50;">
                                        <i class="fas fa-check-circle" id="wageIncomeCheck" style="color: #20B2AA; display: none;"></i>
                                    </div>
                                </div>

                                <div class="mobile-field-group" id="taxWithheldRow" style="display: none;">
                                    <div class="mobile-field-label">My total federal withholdings in 2025 were</div>
                                    <div class="mobile-field-control" style="display: flex; gap: 10px; align-items: center;">
                                        <span style="color: #0f5132; font-weight: 600;">$</span>
                                        <input type="text" inputmode="decimal" pattern="[0-9,]*" id="taxWithheld" placeholder="0" style="flex: 1; padding: 12px 15px; border: 1px solid #e0e0e0; border-radius: 12px; font-size: 1.05rem; color: #2c3e50;">
                                        <i class="fas fa-check-circle" id="taxWithheldCheck" style="color: #20B2AA; display: none;"></i>
                                    </div>
                                </div>

                                <div class="mobile-field-group" id="spouseWageIncomeRow" style="display: none;">
                                    <div class="mobile-field-label">My spouse's total wage income in 2025 was</div>
                                    <div class="mobile-field-control" style="display: flex; gap: 10px; align-items: center;">
                                        <span style="color: #0f5132; font-weight: 600;">$</span>
                                        <input type="text" inputmode="decimal" pattern="[0-9,]*" id="spouseWageIncome" placeholder="0" style="flex: 1; padding: 12px 15px; border: 1px solid #e0e0e0; border-radius: 12px; font-size: 1.05rem; color: #2c3e50;">
                                        <i class="fas fa-check-circle" id="spouseWageIncomeCheck" style="color: #20B2AA; display: none;"></i>
                                    </div>
                                </div>

                                <div class="mobile-field-group" id="spouseTaxWithheldRow" style="display: none;">
                                    <div class="mobile-field-label">My spouse's total federal withholdings in 2025 were</div>
                                    <div class="mobile-field-control" style="display: flex; gap: 10px; align-items: center;">
                                        <span style="color: #0f5132; font-weight: 600;">$</span>
                                        <input type="text" inputmode="decimal" pattern="[0-9,]*" id="spouseTaxWithheld" placeholder="0" style="flex: 1; padding: 12px 15px; border: 1px solid #e0e0e0; border-radius: 12px; font-size: 1.05rem; color: #2c3e50;">
                                        <i class="fas fa-check-circle" id="spouseTaxWithheldCheck" style="color: #20B2AA; display: none;"></i>
                                    </div>
                                </div>

                                <div class="mobile-field-group">
                                    <div class="mobile-field-label">I typically file my taxes</div>
                                    <div class="mobile-field-control" style="position: relative;">
                                        <select class="form-select-custom" id="filingMethod" style="width: 100%; padding: 12px 45px 12px 15px; border: 1px solid #e0e0e0; border-radius: 12px; background: #fff;">
                                            <option value="">select</option>
                                            <option value="on_own">On my own</option>
                                            <option value="with_professional">Using a tax professional</option>
                                        </select>
                                        <i class="fas fa-chevron-down" style="position: absolute; right: 18px; top: 50%; transform: translateY(-50%); color: #047857; pointer-events: none;"></i>
                                        <i class="fas fa-check-circle" id="filingMethodCheck" style="position: absolute; right: 48px; top: 50%; transform: translateY(-50%); color: #20B2AA; display: none;"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="step1-illustration">
                                <div class="step1-illustration-content">
                                    Relax, well crunch the numbers for you.
                                </div>
                            </div>
                        </div>

                        <div style="text-align: center; margin-top: 40px;">
                            <button type="button" class="btn-get-estimate" onclick="goToStep2()" style="background: #20B2AA; color: white; border: none; padding: 18px 50px; border-radius: 50px; font-size: 1.2rem; font-weight: 700; cursor: pointer; transition: all 0.3s;">
                                Get my estimate
                            </button>
                        </div>
                    </div>

                    <!-- Step 2: Dependents (Matching Screenshot Design) -->
                    <div class="calculator-step" id="step2" style="display: none;">
                        <h2 style="color: #20B2AA; font-size: 2rem; font-weight: 700; margin-bottom: 15px;">Do you have any dependents?</h2>
                        <p style="color: #6c757d; font-size: 1rem; margin-bottom: 30px;">If you have dependents, add them here. Qualifying dependents may help lower your taxes through credits and deductions.</p>
                        
                        <div style="margin-bottom: 30px;">
                            <label style="display: flex; align-items: center; padding: 15px; border: 2px solid #e0e0e0; border-radius: 10px; cursor: pointer; margin-bottom: 15px; transition: all 0.3s;">
                                <input type="radio" name="hasDependents" value="yes" id="dependentsYes" style="margin-right: 15px; width: 20px; height: 20px; accent-color: #20B2AA;">
                                <span style="font-size: 1.1rem; color: #2c3e50; font-weight: 600;">Yes</span>
                            </label>
                            <label style="display: flex; align-items: center; padding: 15px; border: 2px solid #e0e0e0; border-radius: 10px; cursor: pointer; transition: all 0.3s;">
                                <input type="radio" name="hasDependents" value="no" id="dependentsNo" style="margin-right: 15px; width: 20px; height: 20px; accent-color: #20B2AA;">
                                <span style="font-size: 1.1rem; color: #2c3e50; font-weight: 600;">No</span>
                            </label>
                        </div>

                        <div id="dependentsSection" style="display: none; margin-bottom: 30px;">
                            <div id="dependentsList"></div>
                            <div id="newDependentForm" style="display: none;"></div>
                            <button type="button" id="addDependentBtn" onclick="addDependent()" style="background: transparent; border: 2px solid #20B2AA; color: #20B2AA; padding: 12px 24px; border-radius: 8px; font-weight: 600; cursor: pointer; margin-top: 20px;">
                                <i class="fas fa-plus me-2"></i>Add another dependent
                            </button>
                        </div>

                        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 40px;">
                            <button type="button" class="btn-back-step" onclick="goBackStep()" style="background: transparent; color: #20B2AA; border: 2px solid #20B2AA; padding: 18px 50px; border-radius: 50px; font-size: 1.2rem; font-weight: 700; cursor: pointer; transition: all 0.3s;">
                                <i class="fas fa-arrow-left me-2"></i>Back
                            </button>
                            <button type="button" class="btn-next-step" onclick="goToStep3()" style="background: #20B2AA; color: white; border: none; padding: 18px 50px; border-radius: 50px; font-size: 1.2rem; font-weight: 700; cursor: pointer;">
                                Next
                            </button>
                        </div>
                    </div>

                    <!-- Step 3: Income Types (Matching Screenshot Design) -->
                    <div class="calculator-step" id="step3" style="display: none;">
                        <h2 style="color: #20B2AA; font-size: 2rem; font-weight: 700; margin-bottom: 15px;">How did you earn money in 2025?</h2>
                        <p style="color: #6c757d; font-size: 1rem; margin-bottom: 30px;">There are many ways to make income. Choose all the ways you earned in 2025.</p>
                        
                        <div id="incomeTypesGrid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px;">
                            <button type="button" class="income-type-btn" data-type="employment" data-label="Employment (W-2)" style="padding: 15px 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: white; cursor: pointer; text-align: left; transition: all 0.3s;">
                                <span style="color: #2c3e50; font-weight: 600;">Employment (W-2)</span>
                                <i class="fas fa-plus float-end" style="color: #20B2AA; margin-top: 5px;"></i>
                            </button>
                            <button type="button" class="income-type-btn" data-type="interest" data-label="Interest" style="padding: 15px 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: white; cursor: pointer; text-align: left; transition: all 0.3s;">
                                <span style="color: #2c3e50; font-weight: 600;">Interest</span>
                                <i class="fas fa-plus float-end" style="color: #20B2AA; margin-top: 5px;"></i>
                            </button>
                            <button type="button" class="income-type-btn" data-type="business" data-label="Business" style="padding: 15px 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: white; cursor: pointer; text-align: left; transition: all 0.3s;">
                                <span style="color: #2c3e50; font-weight: 600;">Business</span>
                                <i class="fas fa-plus float-end" style="color: #20B2AA; margin-top: 5px;"></i>
                            </button>
                            <button type="button" class="income-type-btn" data-type="social_security" data-label="Social Security" style="padding: 15px 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: white; cursor: pointer; text-align: left; transition: all 0.3s;">
                                <span style="color: #2c3e50; font-weight: 600;">Social Security</span>
                                <i class="fas fa-plus float-end" style="color: #20B2AA; margin-top: 5px;"></i>
                            </button>
                            <button type="button" class="income-type-btn" data-type="dividends" data-label="Dividends" style="padding: 15px 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: white; cursor: pointer; text-align: left; transition: all 0.3s;">
                                <span style="color: #2c3e50; font-weight: 600;">Dividends</span>
                                <i class="fas fa-plus float-end" style="color: #20B2AA; margin-top: 5px;"></i>
                            </button>
                            <button type="button" class="income-type-btn" data-type="capital_gains" data-label="Capital gains/losses" style="padding: 15px 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: white; cursor: pointer; text-align: left; transition: all 0.3s;">
                                <span style="color: #2c3e50; font-weight: 600;">Capital gains/losses</span>
                                <i class="fas fa-plus float-end" style="color: #20B2AA; margin-top: 5px;"></i>
                            </button>
                            <button type="button" class="income-type-btn" data-type="combat_pay" data-label="Combat pay" style="padding: 15px 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: white; cursor: pointer; text-align: left; transition: all 0.3s;">
                                <span style="color: #2c3e50; font-weight: 600;">Combat pay</span>
                                <i class="fas fa-plus float-end" style="color: #20B2AA; margin-top: 5px;"></i>
                            </button>
                            <button type="button" class="income-type-btn" data-type="unemployment" data-label="Unemployment" style="padding: 15px 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: white; cursor: pointer; text-align: left; transition: all 0.3s;">
                                <span style="color: #2c3e50; font-weight: 600;">Unemployment</span>
                                <i class="fas fa-plus float-end" style="color: #20B2AA; margin-top: 5px;"></i>
                            </button>
                            <button type="button" class="income-type-btn" data-type="tax_refund" data-label="State/local tax refund" style="padding: 15px 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: white; cursor: pointer; text-align: left; transition: all 0.3s;">
                                <span style="color: #2c3e50; font-weight: 600;">State/local tax refund</span>
                                <i class="fas fa-plus float-end" style="color: #20B2AA; margin-top: 5px;"></i>
                            </button>
                            <button type="button" class="income-type-btn" data-type="other" data-label="Other income" style="padding: 15px 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: white; cursor: pointer; text-align: left; transition: all 0.3s;">
                                <span style="color: #2c3e50; font-weight: 600;">Other income</span>
                                <i class="fas fa-plus float-end" style="color: #20B2AA; margin-top: 5px;"></i>
                            </button>
                        </div>

                        <div id="incomeAmountsContainer" style="margin-bottom: 30px;"></div>
                        
                        <!-- W-2 Form Container (Inline) -->
                        <div id="w2FormContainer" style="display: none; margin-bottom: 30px; padding: 25px; border: 2px solid #e0e0e0; border-radius: 12px; background: #f9f9f9;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3 style="color: #0f5132; font-size: 1.5rem; font-weight: 700; margin: 0;">Employment (W-2)</h3>
                                <button type="button" onclick="closeW2FormInline()" style="background: transparent; border: none; font-size: 1.5rem; color: #6c757d; cursor: pointer; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.3s;" onmouseover="this.style.background='#f0f0f0'; this.style.color='#dc3545'" onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <div id="w2FormsContainer">
                                <!-- W-2 forms will be added here -->
                            </div>
                            
                            <div style="margin-top: 20px;">
                                <button type="button" onclick="addAnotherW2()" style="background: transparent; color: #20B2AA; border: 2px dashed #20B2AA; padding: 12px 24px; border-radius: 8px; font-weight: 600; cursor: pointer; width: 100%; transition: all 0.3s;" onmouseover="this.style.background='#f0f9f7'" onmouseout="this.style.background='transparent'">
                                    <i class="fas fa-plus me-2"></i>Add another W-2
                                </button>
                            </div>
                            
                            <div style="margin-top: 20px; text-align: right;">
                                <button type="button" onclick="saveW2Form()" style="background: #0f5132; color: white; border: none; padding: 14px 40px; border-radius: 8px; font-size: 1rem; font-weight: 700; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.background='#20B2AA'" onmouseout="this.style.background='#0f5132'">
                                    Done
                                </button>
                            </div>
                        </div>
                        
                        <!-- Interest Form Container (Inline) -->
                        <div id="interestFormContainer" style="display: none; margin-bottom: 30px; padding: 25px; border: 2px solid #e0e0e0; border-radius: 12px; background: #f9f9f9;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3 style="color: #0f5132; font-size: 1.5rem; font-weight: 700; margin: 0;">Interest</h3>
                                <button type="button" onclick="closeInterestFormInline()" style="background: transparent; border: none; font-size: 1.5rem; color: #6c757d; cursor: pointer; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.3s;" onmouseover="this.style.background='#f0f0f0'; this.style.color='#dc3545'" onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; color: #0f5132; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Interest income earned (2025) (optional)</label>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <span style="color: #2c3e50; font-weight: 600; font-size: 1.1rem;">$</span>
                                    <input type="text" id="interestIncome" class="income-amount-field" data-income-type="interest" placeholder="0.00" value="0" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; color: #2c3e50;">
                                </div>
                                <small style="color: #6c757d; font-size: 0.85rem; margin-top: 5px; display: block;">1000-INT, Box 1</small>
                            </div>
                            
                            <div style="margin-top: 20px; text-align: right;">
                                <button type="button" onclick="saveInterestForm()" style="background: #0f5132; color: white; border: none; padding: 14px 40px; border-radius: 8px; font-size: 1rem; font-weight: 700; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.background='#20B2AA'" onmouseout="this.style.background='#0f5132'">
                                    Done
                                </button>
                            </div>
                        </div>
                        
                        <!-- Business Form Container (Inline) -->
                        <div id="businessFormContainer" style="display: none; margin-bottom: 30px; padding: 25px; border: 2px solid #e0e0e0; border-radius: 12px; background: #f9f9f9;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3 style="color: #0f5132; font-size: 1.5rem; font-weight: 700; margin: 0;">Small business, self-employment, gig</h3>
                                <button type="button" onclick="closeBusinessFormInline()" style="background: transparent; border: none; font-size: 1.5rem; color: #6c757d; cursor: pointer; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.3s;" onmouseover="this.style.background='#f0f0f0'; this.style.color='#dc3545'" onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <div id="businessFormsContainer">
                                <!-- Business forms will be added here -->
                            </div>
                            
                            <div style="margin-top: 20px;">
                                <button type="button" onclick="addAnotherBusiness()" style="background: transparent; color: #20B2AA; border: 2px dashed #20B2AA; padding: 12px 24px; border-radius: 8px; font-weight: 600; cursor: pointer; width: 100%; transition: all 0.3s;" onmouseover="this.style.background='#f0f9f7'" onmouseout="this.style.background='transparent'">
                                    <i class="fas fa-plus me-2"></i>Add another business
                                </button>
                            </div>
                            
                            <div style="margin-top: 20px; text-align: right;">
                                <button type="button" onclick="saveBusinessForm()" style="background: #0f5132; color: white; border: none; padding: 14px 40px; border-radius: 8px; font-size: 1rem; font-weight: 700; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.background='#20B2AA'" onmouseout="this.style.background='#0f5132'">
                                    Done
                                </button>
                            </div>
                        </div>
                        
                        <!-- Social Security Form Container (Inline) -->
                        <div id="socialSecurityFormContainer" style="display: none; margin-bottom: 30px; padding: 25px; border: 2px solid #e0e0e0; border-radius: 12px; background: #f9f9f9;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3 style="color: #0f5132; font-size: 1.5rem; font-weight: 700; margin: 0;">Social Security</h3>
                                <button type="button" onclick="closeSocialSecurityFormInline()" style="background: transparent; border: none; font-size: 1.5rem; color: #6c757d; cursor: pointer; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.3s;" onmouseover="this.style.background='#f0f0f0'; this.style.color='#dc3545'" onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; color: #0f5132; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Total Social Security benefits (2025) (optional)</label>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <span style="color: #2c3e50; font-weight: 600; font-size: 1.1rem;">$</span>
                                    <input type="text" id="socialSecurityBenefits" class="income-amount-field" data-income-type="social_security" placeholder="0.00" value="0" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; color: #2c3e50;">
                                </div>
                                <small style="color: #6c757d; font-size: 0.85rem; margin-top: 5px; display: block;">Form SSA-1099, Box 5</small>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; color: #0f5132; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Federal income tax withheld (2025) (optional)</label>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <span style="color: #2c3e50; font-weight: 600; font-size: 1.1rem;">$</span>
                                    <input type="text" id="socialSecurityWithheld" placeholder="0.00" value="0" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; color: #2c3e50;">
                                </div>
                                <small style="color: #6c757d; font-size: 0.85rem; margin-top: 5px; display: block;">Form SSA-1099, Box 5</small>
                            </div>
                            
                            <div style="margin-top: 20px; text-align: right;">
                                <button type="button" onclick="saveSocialSecurityForm()" style="background: #0f5132; color: white; border: none; padding: 14px 40px; border-radius: 8px; font-size: 1rem; font-weight: 700; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.background='#20B2AA'" onmouseout="this.style.background='#0f5132'">
                                    Done
                                </button>
                            </div>
                        </div>
                        
                        <!-- Dividends Form Container (Inline) -->
                        <div id="dividendsFormContainer" style="display: none; margin-bottom: 30px; padding: 25px; border: 2px solid #e0e0e0; border-radius: 12px; background: #f9f9f9;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3 style="color: #0f5132; font-size: 1.5rem; font-weight: 700; margin: 0;">Dividends</h3>
                                <button type="button" onclick="closeDividendsFormInline()" style="background: transparent; border: none; font-size: 1.5rem; color: #6c757d; cursor: pointer; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.3s;" onmouseover="this.style.background='#f0f0f0'; this.style.color='#dc3545'" onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; color: #0f5132; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Ordinary dividends (2025) (optional)</label>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <span style="color: #2c3e50; font-weight: 600; font-size: 1.1rem;">$</span>
                                    <input type="text" id="ordinaryDividends" placeholder="0.00" value="0" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; color: #2c3e50;">
                                </div>
                                <small style="color: #6c757d; font-size: 0.85rem; margin-top: 5px; display: block;">1099-DIV, Box 1a</small>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; color: #0f5132; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Qualified dividends (2025) (optional)</label>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <span style="color: #2c3e50; font-weight: 600; font-size: 1.1rem;">$</span>
                                    <input type="text" id="qualifiedDividends" placeholder="0.00" value="0" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; color: #2c3e50;">
                                </div>
                                <small style="color: #6c757d; font-size: 0.85rem; margin-top: 5px; display: block;">1099-DIV, Box 1b</small>
                            </div>
                            
                            <div style="margin-top: 20px; text-align: right;">
                                <button type="button" onclick="saveDividendsForm()" style="background: #0f5132; color: white; border: none; padding: 14px 40px; border-radius: 8px; font-size: 1rem; font-weight: 700; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.background='#20B2AA'" onmouseout="this.style.background='#0f5132'">
                                    Done
                                </button>
                            </div>
                        </div>
                        
                        <!-- Combat Pay Form Container (Inline) -->
                        <div id="combatPayFormContainer" style="display: none; margin-bottom: 30px; padding: 25px; border: 2px solid #e0e0e0; border-radius: 12px; background: #f9f9f9;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3 style="color: #0f5132; font-size: 1.5rem; font-weight: 700; margin: 0;">Combat pay</h3>
                                <button type="button" onclick="closeCombatPayFormInline()" style="background: transparent; border: none; font-size: 1.5rem; color: #6c757d; cursor: pointer; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.3s;" onmouseover="this.style.background='#f0f0f0'; this.style.color='#dc3545'" onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; color: #0f5132; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Total nontaxable combat pay (2025) (optional)</label>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <span style="color: #2c3e50; font-weight: 600; font-size: 1.1rem;">$</span>
                                    <input type="text" id="combatPayAmount" placeholder="0.00" value="0" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; color: #2c3e50;">
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label style="display: flex; align-items: center; cursor: pointer;">
                                    <input type="checkbox" id="includeCombatPayEIC" style="margin-right: 10px; width: 18px; height: 18px; accent-color: #20B2AA;">
                                    <span style="color: #2c3e50; font-weight: 600; font-size: 0.9rem;">Include my nontaxable combat pay in my earned income credit calculation</span>
                                </label>
                            </div>
                            
                            <div style="margin-top: 20px; text-align: right;">
                                <button type="button" onclick="saveCombatPayForm()" style="background: #0f5132; color: white; border: none; padding: 14px 40px; border-radius: 8px; font-size: 1rem; font-weight: 700; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.background='#20B2AA'" onmouseout="this.style.background='#0f5132'">
                                    Done
                                </button>
                            </div>
                        </div>
                        
                        <!-- Unemployment Form Container (Inline) -->
                        <div id="unemploymentFormContainer" style="display: none; margin-bottom: 30px; padding: 25px; border: 2px solid #e0e0e0; border-radius: 12px; background: #f9f9f9;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3 style="color: #0f5132; font-size: 1.5rem; font-weight: 700; margin: 0;">Unemployment</h3>
                                <button type="button" onclick="closeUnemploymentFormInline()" style="background: transparent; border: none; font-size: 1.5rem; color: #6c757d; cursor: pointer; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.3s;" onmouseover="this.style.background='#f0f0f0'; this.style.color='#dc3545'" onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <div id="unemploymentFormsContainer">
                                <!-- Unemployment forms will be added here -->
                            </div>
                            
                            <div style="margin-top: 20px;">
                                <button type="button" onclick="addAnotherUnemployment()" style="background: transparent; color: #20B2AA; border: 2px dashed #20B2AA; padding: 12px 24px; border-radius: 8px; font-weight: 600; cursor: pointer; width: 100%; transition: all 0.3s;" onmouseover="this.style.background='#f0f9f7'" onmouseout="this.style.background='transparent'">
                                    <i class="fas fa-plus me-2"></i>Add another 1099-G
                                </button>
                            </div>
                            
                            <div style="margin-top: 20px; text-align: right;">
                                <button type="button" onclick="saveUnemploymentForm()" style="background: #0f5132; color: white; border: none; padding: 14px 40px; border-radius: 8px; font-size: 1rem; font-weight: 700; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.background='#20B2AA'" onmouseout="this.style.background='#0f5132'">
                                    Done
                                </button>
                            </div>
                        </div>
                        
                        <!-- State/Local Tax Refund Form Container (Inline) -->
                        <div id="taxRefundFormContainer" style="display: none; margin-bottom: 30px; padding: 25px; border: 2px solid #e0e0e0; border-radius: 12px; background: #f9f9f9;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3 style="color: #0f5132; font-size: 1.5rem; font-weight: 700; margin: 0;">State/local tax refund</h3>
                                <button type="button" onclick="closeTaxRefundFormInline()" style="background: transparent; border: none; font-size: 1.5rem; color: #6c757d; cursor: pointer; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.3s;" onmouseover="this.style.background='#f0f0f0'; this.style.color='#dc3545'" onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; color: #0f5132; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Any state/local tax refund(s) (optional)</label>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <span style="color: #2c3e50; font-weight: 600; font-size: 1.1rem;">$</span>
                                    <input type="text" id="taxRefundAmount" class="income-amount-field" data-income-type="tax_refund" placeholder="0.00" value="0" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; color: #2c3e50;">
                                    <i class="fas fa-question-circle" style="color: #20B2AA; cursor: pointer; font-size: 1.1rem;" title="State or local tax refunds received"></i>
                                </div>
                            </div>
                            
                            <div style="margin-top: 20px; text-align: right;">
                                <button type="button" onclick="saveTaxRefundForm()" style="background: #0f5132; color: white; border: none; padding: 14px 40px; border-radius: 8px; font-size: 1rem; font-weight: 700; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.background='#20B2AA'" onmouseout="this.style.background='#0f5132'">
                                    Done
                                </button>
                            </div>
                        </div>
                        
                        <!-- Capital Gains/Losses Form Container (Inline) -->
                        <div id="capitalGainsFormContainer" style="display: none; margin-bottom: 30px; padding: 25px; border: 2px solid #e0e0e0; border-radius: 12px; background: #f9f9f9;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3 style="color: #0f5132; font-size: 1.5rem; font-weight: 700; margin: 0;">Capital gains/losses</h3>
                                <button type="button" onclick="closeCapitalGainsFormInline()" style="background: transparent; border: none; font-size: 1.5rem; color: #6c757d; cursor: pointer; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.3s;" onmouseover="this.style.background='#f0f0f0'; this.style.color='#dc3545'" onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; color: #0f5132; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Held for one year or less (optional)</label>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <span style="color: #2c3e50; font-weight: 600; font-size: 1.1rem;">$</span>
                                    <input type="text" id="shortTermCapitalGains" placeholder="0.00" value="0" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; color: #2c3e50;">
                                </div>
                                <small style="color: #6c757d; font-size: 0.85rem; margin-top: 5px; display: block;">1000-8, Box 1d minus Box 1e</small>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; color: #0f5132; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Held for more than one year (optional)</label>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <span style="color: #2c3e50; font-weight: 600; font-size: 1.1rem;">$</span>
                                    <input type="text" id="longTermCapitalGains" placeholder="0.00" value="0" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; color: #2c3e50;">
                                </div>
                                <small style="color: #6c757d; font-size: 0.85rem; margin-top: 5px; display: block;">1000-8, Box 1d minus Box 1e or 1099DIV, Box 2a</small>
                            </div>
                            
                            <div style="margin-top: 20px; text-align: right;">
                                <button type="button" onclick="saveCapitalGainsForm()" style="background: #0f5132; color: white; border: none; padding: 14px 40px; border-radius: 8px; font-size: 1rem; font-weight: 700; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.background='#20B2AA'" onmouseout="this.style.background='#0f5132'">
                                    Done
                                </button>
                            </div>
                        </div>
                        
                        <!-- Other Income Form Container (Inline) -->
                        <div id="otherIncomeFormContainer" style="display: none; margin-bottom: 30px; padding: 25px; border: 2px solid #e0e0e0; border-radius: 12px; background: #f9f9f9;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3 style="color: #0f5132; font-size: 1.5rem; font-weight: 700; margin: 0;">Other income</h3>
                                <button type="button" onclick="closeOtherIncomeFormInline()" style="background: transparent; border: none; font-size: 1.5rem; color: #6c757d; cursor: pointer; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.3s;" onmouseover="this.style.background='#f0f0f0'; this.style.color='#dc3545'" onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; color: #0f5132; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Any other income in 2025 (optional)</label>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <span style="color: #2c3e50; font-weight: 600; font-size: 1.1rem;">$</span>
                                    <input type="text" id="otherIncomeAmount" class="income-amount-field" data-income-type="other" placeholder="0.00" value="0" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; color: #2c3e50;">
                                    <i class="fas fa-question-circle" style="color: #20B2AA; cursor: pointer; font-size: 1.1rem;" title="Any other income not listed above"></i>
                                </div>
                            </div>
                            
                            <div style="margin-top: 20px; text-align: right;">
                                <button type="button" onclick="saveOtherIncomeForm()" style="background: #0f5132; color: white; border: none; padding: 14px 40px; border-radius: 8px; font-size: 1rem; font-weight: 700; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.background='#20B2AA'" onmouseout="this.style.background='#0f5132'">
                                    Done
                                </button>
                            </div>
                        </div>

                        <div style="margin-top: 20px;">
                            <a href="#" onclick="return false;" style="color: #20B2AA; text-decoration: none; font-size: 0.9rem; font-weight: 600;">What is this?</a>
                        </div>

                        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 40px;">
                            <button type="button" class="btn-back-step" onclick="goBackStep()" style="background: transparent; color: #20B2AA; border: 2px solid #20B2AA; padding: 18px 50px; border-radius: 50px; font-size: 1.2rem; font-weight: 700; cursor: pointer; transition: all 0.3s;">
                                <i class="fas fa-arrow-left me-2"></i>Back
                            </button>
                            <button type="button" class="btn-next-step" onclick="goToStep4()" style="background: #20B2AA; color: white; border: none; padding: 18px 50px; border-radius: 50px; font-size: 1.2rem; font-weight: 700; cursor: pointer;">
                                Next
                            </button>
                        </div>
                    </div>

                    <!-- Step 4: Standard vs Itemized Deduction (Matching Screenshot Design) -->
                    <div class="calculator-step" id="step4" style="display: none;">
                        <h2 style="color: #20B2AA; font-size: 2rem; font-weight: 700; margin-bottom: 30px;">Which deduction option will you take?</h2>
                        
                        <div class="deduction-options-grid">
                            <!-- Standard Deduction Card -->
                            <div style="background: #f5f5f5; border-radius: 15px; padding: 30px; position: relative; cursor: pointer; transition: all 0.3s;" onclick="selectDeduction('standard')">
                                <div style="position: absolute; top: 15px; left: 15px; background: #20B2AA; color: white; padding: 5px 15px; border-radius: 20px; font-size: 0.75rem; font-weight: 700;">
                                    <i class="fas fa-star me-1"></i>Most common
                                </div>
                                <h3 style="color: #2c3e50; font-size: 1.5rem; font-weight: 700; margin-top: 40px; margin-bottom: 15px;">Standard deduction</h3>
                                <p style="color: #2c3e50; font-size: 1.1rem; font-weight: 600; margin-bottom: 15px;">Your standard deduction is <span id="standardDeductionAmount">$15,750</span></p>
                                <p style="color: #6c757d; font-size: 0.95rem; margin-bottom: 25px;">Standard deduction is a set amount based on your filing status. About 90% of filers benefit from this option.</p>
                                <button type="button" class="btn-continue-standard" style="width: 100%; background: #20B2AA; color: white; border: none; padding: 15px; border-radius: 10px; font-weight: 700; cursor: pointer;">
                                    Continue with standard
                                </button>
                            </div>

                            <!-- Itemized Deduction Card -->
                            <div style="background: #f5f5f5; border-radius: 15px; padding: 30px; cursor: pointer; transition: all 0.3s;" onclick="selectDeduction('itemized')">
                                <h3 style="color: #2c3e50; font-size: 1.5rem; font-weight: 700; margin-bottom: 15px;">Itemized deduction</h3>
                                <p style="color: #2c3e50; font-size: 1.1rem; font-weight: 600; margin-bottom: 15px;">Think your itemized deductions might be more than <span id="standardDeductionAmount2">$15,750</span>?</p>
                                <p style="color: #6c757d; font-size: 0.95rem; margin-bottom: 25px;">Itemized filers typically own homes, pay high state and local taxes, pay non-real estate property taxes, or donate to charity.</p>
                                <button type="button" class="btn-continue-itemized" style="width: 100%; background: white; color: #20B2AA; border: 2px solid #20B2AA; padding: 15px; border-radius: 10px; font-weight: 700; cursor: pointer;">
                                    Continue with itemized
                                </button>
                            </div>
                        </div>
                        
                        <div style="text-align: left; margin-top: 40px;">
                            <button type="button" class="btn-back-step" onclick="goBackStep()" style="background: transparent; color: #20B2AA; border: 2px solid #20B2AA; padding: 18px 50px; border-radius: 50px; font-size: 1.2rem; font-weight: 700; cursor: pointer; transition: all 0.3s;">
                                <i class="fas fa-arrow-left me-2"></i>Back
                            </button>
                        </div>
                    </div>

                    <!-- Step 5: Credits and Deductions (Matching Screenshot Design) -->
                    <div class="calculator-step" id="step5" style="display: none;">
                        <h2 style="color: #20B2AA; font-size: 2rem; font-weight: 700; margin-bottom: 15px;">Which of these credits and adjustments apply to you?</h2>
                        
                        <div style="background: #f5f5f5; border-radius: 10px; padding: 20px; margin-bottom: 30px; display: flex; align-items: start; gap: 15px;">
                            <i class="fas fa-info-circle" style="color: #20B2AA; font-size: 1.5rem; margin-top: 5px;"></i>
                            <p style="color: #6c757d; font-size: 0.95rem; margin: 0;">Credits cut your tax bill, and deductions cut your taxable income. Both help you owe less or get more back.</p>
                        </div>

                        <div id="creditsGrid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px;">
                            <button type="button" class="credit-btn" data-credit="childcare" style="padding: 15px 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: white; cursor: pointer; text-align: left; transition: all 0.3s;">
                                <span style="color: #2c3e50; font-weight: 600;">Childcare expenses</span>
                                <i class="fas fa-plus float-end" style="color: #20B2AA; margin-top: 5px;"></i>
                            </button>
                            <button type="button" class="credit-btn" data-credit="education" style="padding: 15px 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: white; cursor: pointer; text-align: left; transition: all 0.3s;">
                                <span style="color: #2c3e50; font-weight: 600;">Education expenses</span>
                                <i class="fas fa-plus float-end" style="color: #20B2AA; margin-top: 5px;"></i>
                            </button>
                            <button type="button" class="credit-btn" data-credit="auto_loan" style="padding: 15px 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: white; cursor: pointer; text-align: left; transition: all 0.3s;">
                                <span style="color: #2c3e50; font-weight: 600;">Auto loan interest</span>
                                <i class="fas fa-plus float-end" style="color: #20B2AA; margin-top: 5px;"></i>
                            </button>
                            <button type="button" class="credit-btn" data-credit="other" style="padding: 15px 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: white; cursor: pointer; text-align: left; transition: all 0.3s;">
                                <span style="color: #2c3e50; font-weight: 600;">Other expenses</span>
                                <i class="fas fa-plus float-end" style="color: #20B2AA; margin-top: 5px;"></i>
                            </button>
                        </div>

                        <div style="margin-bottom: 30px;">
                            <label style="display: flex; align-items: center; padding: 15px; border: 2px solid #e0e0e0; border-radius: 10px; cursor: pointer;">
                                <input type="checkbox" id="noneApply" style="margin-right: 15px; width: 20px; height: 20px; accent-color: #20B2AA;">
                                <span style="font-size: 1.1rem; color: #2c3e50; font-weight: 600;">None of these apply</span>
                            </label>
                        </div>

                        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 40px;">
                            <button type="button" class="btn-back-step" onclick="goBackStep()" style="background: transparent; color: #20B2AA; border: 2px solid #20B2AA; padding: 18px 50px; border-radius: 50px; font-size: 1.2rem; font-weight: 700; cursor: pointer; transition: all 0.3s;">
                                <i class="fas fa-arrow-left me-2"></i>Back
                            </button>
                            <button type="button" class="btn-next-step" onclick="goToStep6()" style="background: #20B2AA; color: white; border: none; padding: 18px 50px; border-radius: 50px; font-size: 1.2rem; font-weight: 700; cursor: pointer;">
                                See my final estimate
                            </button>
                        </div>
                    </div>

                    <!-- Step 6: Results (Matching Screenshot Design) -->
                    <div class="calculator-step" id="step6" style="display: none;">
                        <div class="step6-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; align-items: start;">
                            <!-- Left Column: Refund Display -->
                            <div style="padding-right: 20px;">
                                <div id="finalRefundLabel" style="font-size: 1.2rem; font-weight: 600; color: #0f5132; margin-bottom: 15px;">Your estimated refund:</div>
                                <div id="finalRefundAmount" style="font-size: 4.5rem; font-weight: 700; color: #0f5132; margin-bottom: 10px; line-height: 1.1;">
                                    $0
                                    <div style="width: 100%; height: 4px; background: linear-gradient(90deg, #20B2AA, #17a2b8); margin-top: 10px; border-radius: 2px;"></div>
                        </div>
                                <p style="color: #0f5132; font-size: 0.95rem; margin-top: 20px; margin-bottom: 30px; line-height: 1.6;">
                                    This result is an estimate using a standard deduction. We'll need more info to give a more accurate result.
                                </p>
                                
                                <div style="margin-top: 40px; margin-bottom: 30px;">
                                    <h3 style="color: #0f5132; font-size: 1.3rem; font-weight: 700; margin-bottom: 15px;">Get a more accurate estimate</h3>
                                    <p style="color: #5b6b7e; font-size: 0.95rem; line-height: 1.6; margin-bottom: 25px;">
                                        Share more info about yourself to get a refined estimate and a tailored tax document checklist.
                                    </p>
                                    <button type="button" onclick="goToStep(2)" style="background: transparent; color: #0f5132; border: 2px solid #0f5132; padding: 14px 30px; border-radius: 25px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s;">
                                        Continue my estimate 
                                    </button>
                                </div>
                            </div>

                            <!-- Right Column: Breakdown Card -->
                            <div style="background: transparent; padding: 0; overflow: visible; position: relative; z-index: 10;">
                                <div id="resultsBreakdown" style="padding: 25px; position: relative; z-index: 10; pointer-events: auto; overflow: visible; min-height: 600px;">
                                    <!-- Wizard Step 1: My Details -->
                                    <div id="wizardStep1" class="wizard-step active-tab" data-tab="1">
                                        <div style="cursor: pointer; padding-bottom: 15px; border-bottom: 1px solid #e5e7eb;" onclick="toggleDetailsSection()">
                                            <h3 style="color: #0f5132; font-size: 1.2rem; font-weight: 600; margin: 0; display: flex; align-items: center; justify-content: space-between;">
                                                <span style="display: flex; align-items: center; gap: 12px;">
                                                    <i class="fas fa-user" style="color: #0f5132; font-size: 1.2rem;"></i>My details
                                                </span>
                                                <i class="fas fa-chevron-up" id="detailsChevron" style="color: #0f5132; font-size: 0.9rem; transition: transform 0.3s;"></i>
                                            </h3>
                                        </div>
                                        <div id="myDetailsContent" style="padding: 0; display: block; margin-top: 20px;">
                                        <div style="display: flex; flex-direction: column; gap: 12px;">
                                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0;">
                                                <span style="color: #0f5132; font-size: 0.95rem;">Marital Status:</span>
                                                <span id="resultMaritalStatus" style="color: #0f5132; font-weight: 600; font-size: 0.95rem;">-</span>
                                            </div>
                                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0;">
                                                <span style="color: #0f5132; font-size: 0.95rem;">Filing status:</span>
                                                <span id="resultFilingStatus" style="color: #0f5132; font-weight: 600; font-size: 0.95rem;">-</span>
                                            </div>
                                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0;">
                                                <span style="color: #0f5132; font-size: 0.95rem;">My age:</span>
                                                <span id="resultAge" style="color: #0f5132; font-weight: 600; font-size: 0.95rem;">-</span>
                                            </div>
                                            <div id="resultSpouseAgeRow" style="display: none; justify-content: space-between; align-items: center; padding: 8px 0;">
                                                <span style="color: #0f5132; font-size: 0.95rem;">Spouse's age:</span>
                                                <span id="resultSpouseAge" style="color: #0f5132; font-weight: 600; font-size: 0.95rem;">-</span>
                                            </div>
                                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0;">
                                                <span style="color: #0f5132; font-size: 0.95rem;">My income:</span>
                                                <span id="resultMyIncome" style="color: #0f5132; font-weight: 600; font-size: 0.95rem;">-</span>
                                            </div>
                                            <div id="resultSpouseIncomeRow" style="display: none; justify-content: space-between; align-items: center; padding: 8px 0;">
                                                <span style="color: #0f5132; font-size: 0.95rem;">Spouse's income:</span>
                                                <span id="resultSpouseIncome" style="color: #0f5132; font-weight: 600; font-size: 0.95rem;">-</span>
                                            </div>
                                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0;">
                                                <span style="color: #0f5132; font-size: 0.95rem;">My federal withholdings:</span>
                                                <span id="resultMyWithholdings" style="color: #0f5132; font-weight: 600; font-size: 0.95rem;">-</span>
                                            </div>
                                            <div id="resultSpouseWithholdingsRow" style="display: none; justify-content: space-between; align-items: center; padding: 8px 0;">
                                                <span style="color: #0f5132; font-size: 0.95rem;">Spouse's federal withholdings:</span>
                                                <span id="resultSpouseWithholdings" style="color: #0f5132; font-weight: 600; font-size: 0.95rem;">-</span>
                                            </div>
                                            <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #f0f0f0; display: flex; justify-content: flex-end; align-items: center; position: relative; z-index: 100;">
                                                <button type="button" id="updateInfoBtn" onclick="goToStep(1)" style="background: white; color: #2c3e50; border: 1px solid #d0d0d0; padding: 10px 24px; border-radius: 8px; font-size: 0.9rem; font-weight: 600; cursor: pointer !important; transition: all 0.3s; position: relative; z-index: 1000; pointer-events: auto !important;" onmouseover="this.style.borderColor='#20B2AA'; this.style.color='#20B2AA'" onmouseout="this.style.borderColor='#d0d0d0'; this.style.color='#2c3e50'">
                                                    Update info
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Wizard Step 2: Estimate Breakdown -->
                                    <div id="wizardStep2" class="wizard-step active-tab" data-tab="2" style="position: relative; z-index: 100; display: block; margin-top: 20px;">
                                        <div style="cursor: pointer; padding-bottom: 15px; border-bottom: 1px solid #e5e7eb;" onclick="toggleBreakdownSection()">
                                            <h3 style="color: #0f5132; font-size: 1.2rem; font-weight: 600; margin: 0; display: flex; align-items: center; justify-content: space-between;">
                                                <span style="display: flex; align-items: center; gap: 12px;">
                                                    <i class="fas fa-file-alt" style="color: #0f5132; font-size: 1.2rem;"></i>Estimate breakdown
                                                </span>
                                                <i class="fas fa-chevron-down" id="breakdownChevron" style="color: #0f5132; font-size: 0.9rem; transition: transform 0.3s;"></i>
                                            </h3>
                                        </div>
                                        <div id="estimateBreakdownContent" style="display: none; margin-top: 20px;">
                                            <div id="breakdownDetails">
                                            <div class="breakdown-row" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #f5f5f5;">
                                                <span class="breakdown-label" style="color: #0f5132; font-size: 0.95rem;">Income</span>
                                                <span class="breakdown-value" id="resultIncome" style="color: #0f5132; font-weight: 600; font-size: 0.95rem;">$0</span>
                                </div>
                                            <div class="breakdown-row" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #f5f5f5;">
                                                <span class="breakdown-label" style="color: #0f5132; font-size: 0.95rem;">Deductions</span>
                                                <span class="breakdown-value" id="resultDeductions" style="color: #0f5132; font-weight: 600; font-size: 0.95rem;">$0</span>
                                </div>
                                            <div class="breakdown-row" style="padding: 12px 0; border-bottom: 1px solid #f5f5f5;">
                                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                                                    <span class="breakdown-label" style="color: #0f5132; font-size: 0.95rem;">Taxable income</span>
                                                    <span class="breakdown-value" id="resultTaxableIncome" style="color: #0f5132; font-weight: 600; font-size: 0.95rem;">$0</span>
                                </div>
                                                <div style="color: #6b7280; font-size: 0.85rem; font-style: italic; padding-left: 2px;">Income after deductions</div>
                                </div>
                                            <div class="breakdown-row" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #f5f5f5;">
                                                <span class="breakdown-label" style="color: #0f5132; font-size: 0.95rem;">Tax bracket</span>
                                                <span class="breakdown-value" id="resultTaxBracket" style="color: #0f5132; font-weight: 600; font-size: 0.95rem;">0%</span>
                                </div>
                                            <div class="breakdown-row" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 2px solid #e8e8e8; margin-bottom: 15px;">
                                                <span class="breakdown-label" style="color: #0f5132; font-size: 0.95rem;">Effective tax rate</span>
                                                <span class="breakdown-value" id="resultEffectiveRate" style="color: #0f5132; font-weight: 600; font-size: 0.95rem;">0%</span>
                                </div>
                                            <div class="breakdown-row" style="padding: 12px 0; border-bottom: 1px solid #f5f5f5;">
                                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                                                    <span class="breakdown-label" style="color: #0f5132; font-weight: 700; font-size: 0.95rem;">Taxes refunded</span>
                                                    <span class="breakdown-value" id="resultTaxesRefunded" style="color: #0f5132; font-weight: 700; font-size: 0.95rem;">$0</span>
                                </div>
                                                <div id="taxesRefundedExplanation" style="color: #6b7280; font-size: 0.85rem; font-style: italic; padding-left: 2px;">(Taxable income times effective tax rate)</div>
                                </div>
                                            <div class="breakdown-row" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #f5f5f5;">
                                                <span class="breakdown-label" style="color: #0f5132; font-size: 0.95rem;">Payments and federal taxes withheld</span>
                                                <span class="breakdown-value" id="resultWithheld" style="color: #0f5132; font-weight: 600; font-size: 0.95rem;">$0</span>
                                </div>
                                            <div class="breakdown-row" style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 2px solid #e8e8e8; margin-bottom: 15px;">
                                                <span class="breakdown-label" style="color: #0f5132; font-size: 0.95rem;">Refundable credits</span>
                                                <span class="breakdown-value" id="resultCredits" style="color: #0f5132; font-weight: 600; font-size: 0.95rem;">$0</span>
                                            </div>
                                            </div>
                                            <div class="breakdown-total" style="display: flex; justify-content: space-between; align-items: center; padding: 18px 15px; margin-top: 10px; background: linear-gradient(135deg, #f0f9f7 0%, #e8f5f3 100%); border-radius: 10px; border: 1px solid #d1e7e5;">
                                                <span id="resultTotalLabel" style="color: #0f5132; font-weight: 700; font-size: 1.05rem;">Total tax refund:</span>
                                                <span id="resultTotalRefund" style="color: #0f5132; font-weight: 700; font-size: 1.05rem;">$0</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                                </div>
                            </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>

    <!-- Footer -->
    <footer class="footer bg-dark text-light py-5">
        <div class="container">
            <div class="row g-4">
                <div class="col-lg-4">
                    <div class="footer-section text-center">
                        <h4 class="footer-heading">About JVS Tax Services</h4>
                        <div class="footer-divider"></div>
                        <div class="footer-contact">
                            <div class="contact-item"><i class="fas fa-phone"></i><span>718-395-9663</span></div>
                            <div class="contact-item"><i class="fas fa-envelope"></i><span>support@jvstaxservices.com</span></div>
                            <div class="contact-item"><i class="fas fa-map-marker-alt"></i><span>147 Prince Street</span></div>
                            <div class="contact-item"><i class="fas fa-map-marker-alt"></i><span>Brooklyn, NY 11201</span></div>
                        </div>
                        <div class="social-links mt-4">
                            <a href="#" class="social-link facebook"><i class="fab fa-facebook-f"></i></a>
                            <a href="#" class="social-link linkedin"><i class="fab fa-linkedin-in"></i></a>
                            <a href="#" class="social-link instagram"><i class="fab fa-instagram"></i></a>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="footer-section">
                        <h4 class="footer-heading">Our Hours</h4>
                        <div class="footer-divider"></div>
                        <div class="footer-hours">
                            <div class="hours-item"><span class="day">Mon - Fri:</span><span class="time">10am - 6pm</span></div>
                            <div class="hours-item"><span class="day">Sat - Sun:</span><span class="time">11am - 3pm</span></div>
                        </div>
                        <div class="footer-logo mt-4">
                            <div class="logo-watermark">
                                <img src="images/JVS Official Logo 200x200.webp" alt="JVS Tax Services Logo" class="watermark-svg">
                                <div class="watermark-text">
                                    <div class="watermark-title">PEACE OF MIND</div>
                                    <div class="watermark-subtitle">JVS TAX SERVICES</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="footer-section text-center">
                        <h4 class="footer-heading">Sitemap</h4>
                        <div class="footer-sitemap">
                            <a href="/index.html" class="sitemap-link">Home</a>
                            <a href="/contact.html" class="sitemap-link">Contact</a>
                            <a href="/about.html" class="sitemap-link">About Us</a>
                            <a href="/protection-plus.html" class="sitemap-link">Protection Plan</a>
                            <a href="/pricing.html" class="sitemap-link">Pricing Sheet</a>
                            <a href="/tax-calculator.html" class="sitemap-link">Tax Calculator</a>
                            <a href="/refund-transfer.html" class="sitemap-link">Refund Transfer</a>
                            <a href="/fast-money-card.html" class="sitemap-link">Faster Money Prepaid Visa Card</a>
                            <a href="https://www.irs.gov/refunds" target="_blank" rel="noopener" class="sitemap-link">Track Your Federal Refund</a>
                            <a href="/track-state-refund.html" class="sitemap-link">Track Your State Refund</a>
                            <a href="/privacy-policy.html" class="sitemap-link">Our Privacy Policy</a>
                            <a href="/blog.html" class="sitemap-link">Our Blog</a>
                            <a href="/faqs.html" class="sitemap-link">FAQs</a>
                        </div>
                        <div class="bbb-accreditation mt-4">
                            <div class="bbb-badge">
                                <div class="bbb-logo"><div class="bbb-square">BBB</div></div>
                                <div class="bbb-text">
                                    <div class="bbb-title">ACCREDITED BUSINESS</div>
                                    <div class="bbb-rating">BBB Rating: A-</div>
                                    <div class="bbb-date">As of 10/8/2025</div>
                                    <div class="bbb-link">Click for Profile</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row mt-4">
                <div class="col-12 text-center">
                    <div class="footer-copyright">
                        <p>&copy; Copyright 2025, JVS Tax Services</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="accessibility-icon"><i class="fas fa-universal-access"></i></div>
        <div class="scroll-to-top" id="scrollToTopBtn"><i class="fas fa-arrow-up"></i></div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
    <script>
        let currentStep = 1;
        const totalSteps = 6;
        let calculatorData = {
            maritalStatus: '',
            filingStatus: '',
            age: 0,
            spouseAge: 0,
            incomeType: '',
            wageIncome: 0,
            taxWithheld: 0,
            spouseWageIncome: 0,
            spouseTaxWithheld: 0,
            filingMethod: '',
            dependents: [],
            incomeTypes: [],
            incomeAmounts: {},
            deductionType: 'standard',
            credits: [],
            standardDeduction: 15750
        };

        // Standard deduction amounts for 2025 (under OBBB)
        const standardDeductions2025 = {
            single: 15750,
            married_jointly: 31500,
            married_separately: 15750,
            head_of_household: 23625
        };
        
        // 2025 Tax Brackets (taxable income ranges)
        // Format: [rate %, lowerBound, upperBound]
        const taxBrackets2025 = {
            single: [
                [10, 0, 11925],
                [12, 11925, 48475],
                [22, 48475, 103350],
                [24, 103350, 197300],
                [32, 197300, 250525],
                [35, 250525, 626350],
                [37, 626350, Infinity]
            ],
            married_jointly: [
                [10, 0, 23850],
                [12, 23850, 96950],
                [22, 96950, 206700],
                [24, 206700, 394600],
                [32, 394600, 501050],
                [35, 501050, 751600],
                [37, 751600, Infinity]
            ],
            head_of_household: [
                [10, 0, 17000],
                [12, 17000, 64850],
                [22, 64850, 103350],
                [24, 103350, 197300],
                [32, 197300, 250500],
                [35, 250500, 626351],
                [37, 626351, Infinity]
            ]
        };

        // Alignment factor lets us mirror industry calculators (H&R Block / TurboTax)
        const calculatorRoot = document.getElementById('taxCalculatorForm');
        const TAX_ALIGNMENT_FACTOR = parseFloat(calculatorRoot?.dataset.taxAlignment || '0.9922612568');

        function alignWithIndustry(amount) {
            if (!Number.isFinite(TAX_ALIGNMENT_FACTOR) || TAX_ALIGNMENT_FACTOR === 1) {
                return Math.max(0, amount);
            }
            return Math.max(0, amount * TAX_ALIGNMENT_FACTOR);
        }

        // Initialize Step 1 interactions
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize first step as active
            const firstStep = document.querySelector('.progress-step[data-step="1"]');
            if (firstStep) {
                firstStep.classList.add('active');
            }
            // Marital status change
            const maritalStatus = document.getElementById('maritalStatus');
            if (maritalStatus) {
                maritalStatus.addEventListener('change', function() {
                    calculatorData.maritalStatus = this.value;
                    const check = document.getElementById('maritalStatusCheck');
                    if (check) check.style.display = this.value ? 'block' : 'none';
                    
                    // Show/hide filing status and spouse age based on marital status
                    const filingStatusRow = document.getElementById('filingStatusRow');
                    const filingStatus = document.getElementById('filingStatus');
                    const spouseAgeRow = document.getElementById('spouseAgeRow');
                    
                    if (this.value === 'married') {
                        // Show filing status row with only married options
                        if (filingStatusRow) filingStatusRow.style.display = 'flex';
                        if (spouseAgeRow) spouseAgeRow.style.display = 'flex';
                        
                        // Update filing status dropdown to show only married options
                        if (filingStatus) {
                            filingStatus.innerHTML = `
                                <option value="">enter filing status</option>
                                <option value="married_jointly">Married Filing Jointly</option>
                                <option value="married_separately">Married Filing Separately</option>
                            `;
                            filingStatus.value = '';
                            calculatorData.filingStatus = '';
                        }
                    } else if (this.value === 'single') {
                        // Show filing status row with Single and Head of Household options
                        if (filingStatusRow) filingStatusRow.style.display = 'flex';
                        if (spouseAgeRow) spouseAgeRow.style.display = 'none';
                        
                        // Update filing status dropdown to show Single and Head of Household options
                        if (filingStatus) {
                            filingStatus.innerHTML = `
                                <option value="">enter filing status</option>
                                <option value="single">Single</option>
                                <option value="head_of_household">Head of Household</option>
                            `;
                            filingStatus.value = '';
                            calculatorData.filingStatus = '';
                        }
                    } else if (this.value === 'head_of_household') {
                        // Set filing status directly to head_of_household and hide the row
                        if (filingStatusRow) filingStatusRow.style.display = 'none';
                        if (spouseAgeRow) spouseAgeRow.style.display = 'none';
                        calculatorData.filingStatus = 'head_of_household';
                        if (filingStatus) filingStatus.value = 'head_of_household';
                    } else {
                        // Hide both rows if no selection
                        if (filingStatusRow) filingStatusRow.style.display = 'none';
                        if (spouseAgeRow) spouseAgeRow.style.display = 'none';
                        calculatorData.filingStatus = '';
                        if (filingStatus) filingStatus.value = '';
                    }
                    updateEstimatedRefund();
                });
            }

            // Filing status change
            const filingStatus = document.getElementById('filingStatus');
            if (filingStatus) {
                filingStatus.addEventListener('change', function() {
                    calculatorData.filingStatus = this.value;
                    const check = document.getElementById('filingStatusCheck');
                    if (check) check.style.display = this.value ? 'block' : 'none';
                    
                    // Show/hide income field and update label based on filing status
                    const incomeTypeRow = document.getElementById('incomeTypeRow');
                    const incomeLabel = incomeTypeRow ? incomeTypeRow.querySelector('.mobile-field-label') : null;
                    const spouseAgeRow = document.getElementById('spouseAgeRow');
                    
                    if (this.value === 'single') {
                        if (incomeTypeRow) incomeTypeRow.style.display = 'flex';
                        if (incomeLabel) incomeLabel.textContent = 'My income';
                        if (spouseAgeRow) spouseAgeRow.style.display = 'none';
                    } else if (this.value === 'married_jointly') {
                        if (incomeTypeRow) incomeTypeRow.style.display = 'flex';
                        if (incomeLabel) incomeLabel.textContent = 'Our income';
                        if (spouseAgeRow) spouseAgeRow.style.display = 'flex';
                        
                        // Show spouse wage income and tax withheld fields if income includes wages
                        const spouseWageIncomeRow = document.getElementById('spouseWageIncomeRow');
                        const spouseTaxWithheldRow = document.getElementById('spouseTaxWithheldRow');
                        if (calculatorData.incomeType === 'includes_wages') {
                            if (spouseWageIncomeRow) spouseWageIncomeRow.style.display = 'flex';
                            if (spouseTaxWithheldRow) spouseTaxWithheldRow.style.display = 'flex';
                        } else {
                            if (spouseWageIncomeRow) spouseWageIncomeRow.style.display = 'none';
                            if (spouseTaxWithheldRow) spouseTaxWithheldRow.style.display = 'none';
                        }
                    } else if (this.value === 'married_separately') {
                        if (incomeTypeRow) incomeTypeRow.style.display = 'flex';
                        if (incomeLabel) incomeLabel.textContent = 'My income';
                        if (spouseAgeRow) spouseAgeRow.style.display = 'none';
                        
                        // Hide spouse wage income and tax withheld fields
                        const spouseWageIncomeRow = document.getElementById('spouseWageIncomeRow');
                        const spouseTaxWithheldRow = document.getElementById('spouseTaxWithheldRow');
                        if (spouseWageIncomeRow) spouseWageIncomeRow.style.display = 'none';
                        if (spouseTaxWithheldRow) spouseTaxWithheldRow.style.display = 'none';
                    } else {
                        if (incomeTypeRow) incomeTypeRow.style.display = 'none';
                        // Reset income type when hidden
                        calculatorData.incomeType = '';
                        const incomeType = document.getElementById('incomeType');
                        if (incomeType) incomeType.value = '';
                        
                        // Hide spouse wage income and tax withheld fields
                        const spouseWageIncomeRow = document.getElementById('spouseWageIncomeRow');
                        const spouseTaxWithheldRow = document.getElementById('spouseTaxWithheldRow');
                        if (spouseWageIncomeRow) spouseWageIncomeRow.style.display = 'none';
                        if (spouseTaxWithheldRow) spouseTaxWithheldRow.style.display = 'none';
                    }
                    
                    updateStandardDeduction();
                    updateEstimatedRefund();
                });
            }

            // Age input
            const age = document.getElementById('age');
            if (age) {
                age.addEventListener('input', function() {
                    calculatorData.age = parseInt(this.value) || 0;
                    const check = document.getElementById('ageCheck');
                    if (check) check.style.display = this.value ? 'block' : 'none';
                    updateEstimatedRefund();
                });
            }

            // Spouse age input
            const spouseAge = document.getElementById('spouseAge');
            if (spouseAge) {
                spouseAge.addEventListener('input', function() {
                    calculatorData.spouseAge = parseInt(this.value) || 0;
                    const check = document.getElementById('spouseAgeCheck');
                    if (check) check.style.display = this.value ? 'block' : 'none';
                });
            }

            // Income type change
            const incomeType = document.getElementById('incomeType');
            if (incomeType) {
                incomeType.addEventListener('change', function() {
                    calculatorData.incomeType = this.value;
                    const check = document.getElementById('incomeTypeCheck');
                    if (check) check.style.display = this.value ? 'block' : 'none';
                    
                    // Show/hide wage income and tax withheld fields
                    const wageIncomeRow = document.getElementById('wageIncomeRow');
                    const taxWithheldRow = document.getElementById('taxWithheldRow');
                    const spouseWageIncomeRow = document.getElementById('spouseWageIncomeRow');
                    const spouseTaxWithheldRow = document.getElementById('spouseTaxWithheldRow');
                    const isMarriedJointly = calculatorData.filingStatus === 'married_jointly';
                    
                    if (this.value === 'includes_wages') {
                        if (wageIncomeRow) wageIncomeRow.style.display = 'flex';
                        if (taxWithheldRow) taxWithheldRow.style.display = 'flex';
                        
                        // Show spouse fields only if married filing jointly
                        if (isMarriedJointly) {
                            if (spouseWageIncomeRow) spouseWageIncomeRow.style.display = 'flex';
                            if (spouseTaxWithheldRow) spouseTaxWithheldRow.style.display = 'flex';
                        } else {
                            if (spouseWageIncomeRow) spouseWageIncomeRow.style.display = 'none';
                            if (spouseTaxWithheldRow) spouseTaxWithheldRow.style.display = 'none';
                        }
                    } else {
                        if (wageIncomeRow) wageIncomeRow.style.display = 'none';
                        if (taxWithheldRow) taxWithheldRow.style.display = 'none';
                        if (spouseWageIncomeRow) spouseWageIncomeRow.style.display = 'none';
                        if (spouseTaxWithheldRow) spouseTaxWithheldRow.style.display = 'none';
                        // Reset values when hidden
                        calculatorData.wageIncome = 0;
                        calculatorData.taxWithheld = 0;
                        calculatorData.spouseWageIncome = 0;
                        calculatorData.spouseTaxWithheld = 0;
                        const wageIncome = document.getElementById('wageIncome');
                        const taxWithheld = document.getElementById('taxWithheld');
                        const spouseWageIncome = document.getElementById('spouseWageIncome');
                        const spouseTaxWithheld = document.getElementById('spouseTaxWithheld');
                        if (wageIncome) wageIncome.value = '';
                        if (taxWithheld) taxWithheld.value = '';
                        if (spouseWageIncome) spouseWageIncome.value = '';
                        if (spouseTaxWithheld) spouseTaxWithheld.value = '';
                    }
                    updateEstimatedRefund();
                });
            }

            // Wage income input
            const wageIncome = document.getElementById('wageIncome');
            if (wageIncome) {
                initCommaInput(wageIncome, (value) => {
                    calculatorData.wageIncome = value;
                    const check = document.getElementById('wageIncomeCheck');
                    if (check) check.style.display = value ? 'block' : 'none';
                    updateEstimatedRefund();
                });
                if (wageIncome.value) {
                    wageIncome.value = formatWithCommas(parseCommaNumber(wageIncome.value), true);
                }
            }

            // Tax withheld input
            const taxWithheld = document.getElementById('taxWithheld');
            if (taxWithheld) {
                initCommaInput(taxWithheld, (value) => {
                    calculatorData.taxWithheld = value;
                    const check = document.getElementById('taxWithheldCheck');
                    if (check) check.style.display = value ? 'block' : 'none';
                    updateEstimatedRefund();
                });
                if (taxWithheld.value) {
                    taxWithheld.value = formatWithCommas(parseCommaNumber(taxWithheld.value), true);
                }
            }

            // Spouse wage income input
            const spouseWageIncome = document.getElementById('spouseWageIncome');
            if (spouseWageIncome) {
                initCommaInput(spouseWageIncome, (value) => {
                    calculatorData.spouseWageIncome = value;
                    const check = document.getElementById('spouseWageIncomeCheck');
                    if (check) check.style.display = value ? 'block' : 'none';
                    updateEstimatedRefund();
                });
                if (spouseWageIncome.value) {
                    spouseWageIncome.value = formatWithCommas(parseCommaNumber(spouseWageIncome.value), true);
                }
            }

            // Spouse tax withheld input
            const spouseTaxWithheld = document.getElementById('spouseTaxWithheld');
            if (spouseTaxWithheld) {
                initCommaInput(spouseTaxWithheld, (value) => {
                    calculatorData.spouseTaxWithheld = value;
                    const check = document.getElementById('spouseTaxWithheldCheck');
                    if (check) check.style.display = value ? 'block' : 'none';
                    updateEstimatedRefund();
                });
                if (spouseTaxWithheld.value) {
                    spouseTaxWithheld.value = formatWithCommas(parseCommaNumber(spouseTaxWithheld.value), true);
                }
            }

            // Filing method change
            const filingMethod = document.getElementById('filingMethod');
            if (filingMethod) {
                filingMethod.addEventListener('change', function() {
                    calculatorData.filingMethod = this.value;
                    const check = document.getElementById('filingMethodCheck');
                    if (check) check.style.display = this.value ? 'block' : 'none';
                });
            }

            // Dependents radio buttons
            const dependentsYes = document.getElementById('dependentsYes');
            const dependentsNo = document.getElementById('dependentsNo');
            if (dependentsYes && dependentsNo) {
                dependentsYes.addEventListener('change', function() {
                    if (this.checked) {
                        const dependentsSection = document.getElementById('dependentsSection');
                        if (dependentsSection) {
                            dependentsSection.style.display = 'block';
                        }
                        // If no dependents added yet, show the form immediately
                        if (calculatorData.dependents.length === 0) {
                            addDependent();
                        }
                    }
                });
                dependentsNo.addEventListener('change', function() {
                    if (this.checked) {
                        const dependentsSection = document.getElementById('dependentsSection');
                        if (dependentsSection) {
                            dependentsSection.style.display = 'none';
                        }
                        calculatorData.dependents = [];
                        const dependentsList = document.getElementById('dependentsList');
                        if (dependentsList) {
                            dependentsList.innerHTML = '';
                        }
                        const newDependentForm = document.getElementById('newDependentForm');
                        if (newDependentForm) {
                            newDependentForm.style.display = 'none';
                            newDependentForm.innerHTML = '';
                        }
                        const addDependentBtn = document.getElementById('addDependentBtn');
                        if (addDependentBtn) {
                            addDependentBtn.style.display = 'block';
                            addDependentBtn.style.background = 'transparent';
                            addDependentBtn.style.border = '2px solid #20B2AA';
                            addDependentBtn.style.color = '#20B2AA';
                            addDependentBtn.innerHTML = '<i class="fas fa-plus me-2"></i>Add another dependent';
                        }
                    }
                });
            }

            // Income type buttons
            document.querySelectorAll('.income-type-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const type = this.dataset.type;
                    const label = this.dataset.label || type;
                    const incomeAmountsContainer = document.getElementById('incomeAmountsContainer');
                    
                    if (this.classList.contains('selected')) {
                        // Remove income type
                        this.classList.remove('selected');
                        calculatorData.incomeTypes = calculatorData.incomeTypes.filter(t => t !== type);
                        if (calculatorData.incomeAmounts) {
                            delete calculatorData.incomeAmounts[type];
                        }
                        this.querySelector('i').classList.remove('fa-times');
                        this.querySelector('i').classList.add('fa-plus');
                        this.style.background = 'white';
                        this.style.borderColor = '#e0e0e0';
                        this.querySelector('span').style.color = '#2c3e50';
                        
                        // Remove income amount input
                        const incomeInputDiv = document.getElementById(`incomeAmount_${type}`);
                        if (incomeInputDiv) {
                            incomeInputDiv.remove();
                        }
                    } else {
                        // Add income type
                        this.classList.add('selected');
                        if (!calculatorData.incomeTypes.includes(type)) {
                            calculatorData.incomeTypes.push(type);
                        }
                        this.querySelector('i').classList.remove('fa-plus');
                        this.querySelector('i').classList.add('fa-times');
                        this.style.background = '#20B2AA';
                        this.style.borderColor = '#20B2AA';
                        this.querySelector('span').style.color = 'white';
                        
                        // Special handling for different income types - show inline forms
                        if (type === 'employment') {
                            showW2FormInline();
                            return;
                        } else if (type === 'interest') {
                            showInterestFormInline();
                            return;
                        } else if (type === 'business') {
                            showBusinessFormInline();
                            return;
                        } else if (type === 'social_security') {
                            showSocialSecurityFormInline();
                            return;
                        } else if (type === 'dividends') {
                            showDividendsFormInline();
                            return;
                        } else if (type === 'combat_pay') {
                            showCombatPayFormInline();
                            return;
                        } else if (type === 'unemployment') {
                            showUnemploymentFormInline();
                            return;
                        } else if (type === 'tax_refund') {
                            showTaxRefundFormInline();
                            return;
                        } else if (type === 'capital_gains') {
                            showCapitalGainsFormInline();
                            return;
                        } else if (type === 'other') {
                            showOtherIncomeFormInline();
                            return;
                        }
                        
                        // Add income amount input field for other types
                        if (!document.getElementById(`incomeAmount_${type}`)) {
                            const incomeInputDiv = document.createElement('div');
                            incomeInputDiv.id = `incomeAmount_${type}`;
                            incomeInputDiv.className = 'income-amount-input';
                            incomeInputDiv.style.cssText = 'margin-bottom: 20px; padding: 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: #f9f9f9;';
                            incomeInputDiv.innerHTML = `
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <label style="color: #2c3e50; font-weight: 600; font-size: 1rem;">${label}</label>
                                    <i class="fas fa-times" onclick="removeIncomeAmount('${type}')" style="color: #dc3545; cursor: pointer; font-size: 1.1rem;"></i>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <span style="color: #2c3e50; font-weight: 600; font-size: 1.2rem;">$</span>
                                    <input type="text" class="income-amount-field" data-income-type="${type}" placeholder="0.00" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1.1rem; color: #2c3e50;">
                                </div>
                            `;
                            incomeAmountsContainer.appendChild(incomeInputDiv);
                            
                            // Initialize comma input for the amount field
                            const amountInput = incomeInputDiv.querySelector('.income-amount-field');
                            if (amountInput) {
                                initCommaInput(amountInput, (value) => {
                                    if (!calculatorData.incomeAmounts) {
                                        calculatorData.incomeAmounts = {};
                                    }
                                    calculatorData.incomeAmounts[type] = value;
                                    updateEstimatedRefund();
                                });
                            }
                        }
                    }
                    updateEstimatedRefund();
                });
            });
            
            // Function to remove income amount
            window.removeIncomeAmount = function(type) {
                const incomeInputDiv = document.getElementById(`incomeAmount_${type}`);
                if (incomeInputDiv) {
                    incomeInputDiv.remove();
                }
                
                // Remove from data
                if (calculatorData.incomeAmounts) {
                    delete calculatorData.incomeAmounts[type];
                }
                calculatorData.incomeTypes = calculatorData.incomeTypes.filter(t => t !== type);
                
                // Reset button state
                const btn = document.querySelector(`.income-type-btn[data-type="${type}"]`);
                if (btn) {
                    btn.classList.remove('selected');
                    btn.querySelector('i').classList.remove('fa-times');
                    btn.querySelector('i').classList.add('fa-plus');
                    btn.style.background = 'white';
                    btn.style.borderColor = '#e0e0e0';
                    btn.querySelector('span').style.color = '#2c3e50';
                }
                updateEstimatedRefund();
            };

            // Credit buttons
            document.querySelectorAll('.credit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const credit = this.dataset.credit;
                    if (this.classList.contains('selected')) {
                        this.classList.remove('selected');
                        calculatorData.credits = calculatorData.credits.filter(c => c !== credit);
                        this.querySelector('i').classList.remove('fa-times');
                        this.querySelector('i').classList.add('fa-plus');
                        this.style.background = 'white';
                        this.style.borderColor = '#e0e0e0';
                    } else {
                        this.classList.add('selected');
                        calculatorData.credits.push(credit);
                        this.querySelector('i').classList.remove('fa-plus');
                        this.querySelector('i').classList.add('fa-times');
                        this.style.background = '#20B2AA';
                        this.style.borderColor = '#20B2AA';
                        this.querySelector('span').style.color = 'white';
                    }
                });
            });
        });

        function updateStandardDeduction() {
            const filingStatus = calculatorData.filingStatus;
            if (filingStatus && standardDeductions2025[filingStatus]) {
                calculatorData.standardDeduction = standardDeductions2025[filingStatus];
                const amount1 = document.getElementById('standardDeductionAmount');
                const amount2 = document.getElementById('standardDeductionAmount2');
                const formatted = formatCurrency(standardDeductions2025[filingStatus]);
                if (amount1) amount1.textContent = formatted;
                if (amount2) amount2.textContent = formatted;
            }
        }

        function updateEstimatedRefund() {
            let income = calculatorData.wageIncome || 0;
            let withheld = calculatorData.taxWithheld || 0;
            
            // For married filing jointly, include spouse income and withholdings
            if (calculatorData.filingStatus === 'married_jointly') {
                income += (calculatorData.spouseWageIncome || 0);
                withheld += (calculatorData.spouseTaxWithheld || 0);
            }
            
            // Add all other income types
            if (calculatorData.incomeAmounts) {
                Object.values(calculatorData.incomeAmounts).forEach(amount => {
                    income += (parseFloat(amount) || 0);
                });
            }
            
            // Get standard deduction based on filing status
            let deduction = calculatorData.standardDeduction;
            if (!deduction || deduction === 15750) {
                // If not set or still default, get from standardDeductions2025
                const filingStatus = calculatorData.filingStatus || 'single';
                deduction = standardDeductions2025[filingStatus] || 15750;
                calculatorData.standardDeduction = deduction;
            }
            
            // Taxable Income = Gross Income - Standard Deduction
            const taxableIncome = Math.max(0, income - deduction);
            
            // Calculate federal tax using progressive brackets
            const totalFederalTax = calculateTaxAmount(taxableIncome, calculatorData.filingStatus || 'single');
            
            // Calculate credits
            const credits = calculatorData.credits.length * 500;
            
            // Final tax after credits
            const finalTax = Math.max(0, totalFederalTax - credits);
            
            // Refund = Withholdings + Credits - Total Federal Tax
            const netAmount = (withheld + credits) - finalTax;
            
            const display = document.getElementById('estimatedRefundDisplay');
            const label = document.getElementById('estimatedRefundLabel');
            
            if (display) {
                display.textContent = formatCurrency(netAmount);
                // Apply styling based on positive/negative
                if (netAmount < 0) {
                    display.style.background = 'linear-gradient(135deg, #dc3545 0%, #c82333 100%)';
                    display.style.webkitBackgroundClip = 'text';
                    display.style.webkitTextFillColor = 'transparent';
                    display.style.backgroundClip = 'text';
                    display.style.textShadow = '0 2px 10px rgba(220, 53, 69, 0.2)';
                } else {
                    display.style.background = 'linear-gradient(135deg, #20B2AA 0%, #17a2b8 100%)';
                    display.style.webkitBackgroundClip = 'text';
                    display.style.webkitTextFillColor = 'transparent';
                    display.style.backgroundClip = 'text';
                    display.style.textShadow = '0 2px 10px rgba(32, 178, 170, 0.2)';
                }
            }
            
            if (label) {
                label.textContent = netAmount >= 0 ? 'Your estimated refund:' : 'Your estimated balance due:';
            }
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function formatWithCommas(value, allowZero = false) {
            if (value === null || value === undefined) return '';
            if (!allowZero && (value === 0 || value === '')) return '';
            const parts = value.toString().split('.');
            parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            return parts.join('.');
        }

        // Tab navigation functions
        let currentTab = 1;
        
        // Switch between tabs - SIMPLIFIED CSS-BASED APPROACH
        function switchTab(tabNumber) {
            console.log('=== SWITCH TAB CALLED ===', tabNumber);
            currentTab = tabNumber;
            
            // Get tab buttons and content sections
            const tabMyDetails = document.getElementById('tabMyDetails');
            const tabBreakdown = document.getElementById('tabBreakdown');
            const wizardStep1 = document.getElementById('wizardStep1');
            const wizardStep2 = document.getElementById('wizardStep2');
            
            // FIRST: Explicitly hide both tabs
            if (wizardStep1) {
                wizardStep1.classList.remove('active-tab');
                wizardStep1.classList.add('tab-content');
                // Force hide with inline style as backup
                wizardStep1.style.display = 'none';
                wizardStep1.style.visibility = 'hidden';
            }
            if (wizardStep2) {
                wizardStep2.classList.remove('active-tab');
                wizardStep2.classList.add('tab-content');
                // Force hide with inline style as backup
                wizardStep2.style.display = 'none';
                wizardStep2.style.visibility = 'hidden';
            }
            
            if (tabNumber === 1) {
                // Show My Details tab, but keep both sections visible
                if (tabMyDetails) {
                    tabMyDetails.classList.add('active');
                    tabMyDetails.style.borderBottomColor = '#20B2AA';
                    tabMyDetails.style.color = '#20B2AA';
                }
                if (tabBreakdown) {
                    tabBreakdown.classList.remove('active');
                    tabBreakdown.style.borderBottomColor = 'transparent';
                    tabBreakdown.style.color = '#6c757d';
                }
                if (wizardStep1) {
                    wizardStep1.classList.remove('tab-content');
                    wizardStep1.classList.add('active-tab');
                    // Force show with inline style
                    wizardStep1.style.display = 'block';
                    wizardStep1.style.visibility = 'visible';
                    wizardStep1.style.opacity = '1';
                }
                // Keep wizardStep2 visible too (both sections should show)
                if (wizardStep2) {
                    wizardStep2.classList.remove('tab-content');
                    wizardStep2.classList.add('active-tab');
                    wizardStep2.style.display = 'block';
                    wizardStep2.style.visibility = 'visible';
                    wizardStep2.style.opacity = '1';
                }
            } else if (tabNumber === 2) {
                // Show Breakdown tab, hide My Details
                console.log('=== SWITCHING TO BREAKDOWN TAB ===');
                
                // Ensure tax is calculated before showing breakdown
                if (typeof calculateTax === 'function') {
                    calculateTax();
                } else if (typeof window.calculateTax === 'function') {
                    window.calculateTax();
                }
                
                if (tabMyDetails) {
                    tabMyDetails.classList.remove('active');
                    tabMyDetails.style.borderBottomColor = 'transparent';
                    tabMyDetails.style.color = '#6c757d';
                }
                if (tabBreakdown) {
                    tabBreakdown.classList.add('active');
                    tabBreakdown.style.borderBottomColor = '#20B2AA';
                    tabBreakdown.style.color = '#20B2AA';
                }
                if (wizardStep2) {
                    console.log('=== SHOWING BREAKDOWN TAB ===');
                    console.log('wizardStep2 before:', wizardStep2.className);
                    console.log('wizardStep2 innerHTML length:', wizardStep2.innerHTML.length);
                    
                    // Remove tab-content class and add active-tab
                    wizardStep2.classList.remove('tab-content');
                    wizardStep2.classList.add('active-tab');
                    wizardStep2.classList.add('show');
                    
                    // Explicitly set display properties to ensure visibility
                    wizardStep2.style.display = 'block';
                    wizardStep2.style.visibility = 'visible';
                    wizardStep2.style.opacity = '1';
                    wizardStep2.style.height = 'auto';
                    wizardStep2.style.overflow = 'visible';
                    
                    // Force remove tab-content class completely (in case it's being re-added)
                    setTimeout(function() {
                        if (wizardStep2.classList.contains('tab-content')) {
                            wizardStep2.classList.remove('tab-content');
                        }
                    }, 0);
                    
                    // Keep position and z-index from original inline style
                    wizardStep2.style.position = 'relative';
                    wizardStep2.style.zIndex = '100';
                    
                    console.log('wizardStep2 after:', wizardStep2.className);
                    console.log('wizardStep2 computed display:', window.getComputedStyle(wizardStep2).display);
                    console.log('wizardStep2 computed visibility:', window.getComputedStyle(wizardStep2).visibility);
                    
                    // Check if content exists
                    const breakdownContent = document.getElementById('estimateBreakdownContent');
                    const breakdownDetails = document.getElementById('breakdownDetails');
                    const rows = wizardStep2.querySelectorAll('.breakdown-row');
                    
                    console.log('breakdownContent exists:', !!breakdownContent);
                    console.log('breakdownDetails exists:', !!breakdownDetails);
                    console.log('Found rows:', rows.length);
                    
                    if (breakdownContent) {
                        console.log('breakdownContent computed display:', window.getComputedStyle(breakdownContent).display);
                        console.log('breakdownContent innerHTML length:', breakdownContent.innerHTML.length);
                    }
                    if (breakdownDetails) {
                        console.log('breakdownDetails computed display:', window.getComputedStyle(breakdownDetails).display);
                        console.log('breakdownDetails innerHTML length:', breakdownDetails.innerHTML.length);
                    }
                    
                    // Don't force display - respect collapsed state
                    // The breakdown content should remain collapsed by default
                    // It will only expand when user clicks the header
                    
                    // Remove inline styles from rows (keep their original flex/block from HTML)
                    rows.forEach(function(row, index) {
                        // Only remove display if it's set to none
                        if (row.style.display === 'none') {
                            row.style.removeProperty('display');
                        }
                        row.style.removeProperty('visibility');
                        row.style.removeProperty('opacity');
                        console.log('Row', index, 'computed display:', window.getComputedStyle(row).display);
                    });
                    
                    // Populate breakdown data
                    setTimeout(function() {
                        if (typeof calculateTax === 'function') {
                            calculateTax();
                        } else if (typeof window.calculateTax === 'function') {
                            window.calculateTax();
                        }
                    }, 50);
                } else {
                    console.error('wizardStep2 element not found!');
                }
                // Keep wizardStep1 visible too (both sections should show)
                if (wizardStep1) {
                    wizardStep1.classList.remove('tab-content');
                    wizardStep1.classList.add('active-tab');
                    wizardStep1.style.display = 'block';
                    wizardStep1.style.visibility = 'visible';
                    wizardStep1.style.opacity = '1';
                }
            }
        }
        
        // Make function globally accessible
        window.switchTab = switchTab;
        
        // Toggle functions for collapsible sections
        function toggleDetailsSection() {
            const content = document.getElementById('myDetailsContent');
            const chevron = document.getElementById('detailsChevron');
            if (content && chevron) {
                if (content.style.display === 'none' || !content.style.display) {
                    content.style.display = 'block';
                    chevron.style.transform = 'rotate(180deg)'; // Rotate down to up
                } else {
                    content.style.display = 'none';
                    chevron.style.transform = 'rotate(0deg)'; // Rotate up to down
                }
            }
        }
        
        function toggleBreakdownSection() {
            const content = document.getElementById('estimateBreakdownContent');
            const chevron = document.getElementById('breakdownChevron');
            if (content && chevron) {
                const currentDisplay = content.style.display || window.getComputedStyle(content).display;
                if (currentDisplay === 'none') {
                    content.style.setProperty('display', 'block', 'important');
                    content.style.setProperty('visibility', 'visible', 'important');
                    chevron.style.transform = 'rotate(180deg)'; // Rotate down to up
                } else {
                    content.style.setProperty('display', 'none', 'important');
                    content.style.setProperty('visibility', 'hidden', 'important');
                    chevron.style.transform = 'rotate(0deg)'; // Rotate up to down
                }
            }
        }
        
        window.toggleDetailsSection = toggleDetailsSection;
        window.toggleBreakdownSection = toggleBreakdownSection;

        function parseCommaNumber(value) {
            if (!value) return 0;
            const normalized = value.toString().replace(/,/g, '');
            if (normalized.trim() === '') return 0;
            const parsed = parseFloat(normalized);
            return isNaN(parsed) ? 0 : parsed;
        }

        function initCommaInput(input, onValueChange) {
            if (!input) return;
            const notify = (numeric) => onValueChange(typeof numeric === 'number' ? numeric : 0);
            input.addEventListener('input', () => {
                const caretEnd = input.selectionEnd;
                const numeric = parseCommaNumber(input.value);
                const formatted = numeric ? formatWithCommas(numeric, true) : '';
                input.value = formatted;
                notify(numeric);
                if (document.activeElement === input && typeof caretEnd === 'number') {
                    const newPos = formatted.length;
                    input.setSelectionRange(newPos, newPos);
                }
            });
            input.addEventListener('focus', () => {
                const raw = input.value.replace(/,/g, '');
                input.value = raw;
                const pos = raw.length;
                input.setSelectionRange(pos, pos);
            });
            input.addEventListener('blur', () => {
                const numeric = parseCommaNumber(input.value);
                input.value = numeric ? formatWithCommas(numeric, true) : '';
            });
        }

        // Step Navigation Functions
        function goToStep(step) {
            // Hide all steps
            for (let i = 1; i <= totalSteps; i++) {
                const stepEl = document.getElementById(`step${i}`);
                if (stepEl) stepEl.style.display = 'none';
                
                const progressStep = document.querySelector(`.progress-step[data-step="${i}"]`);
                if (progressStep) {
                    const circle = progressStep.querySelector('.step-circle');
                    if (circle) {
                        circle.style.borderColor = '#e0e0e0';
                        circle.style.background = 'white';
                        circle.style.color = '#6c757d';
                    }
                }
            }
            
            // Show current step
            const currentStepEl = document.getElementById(`step${step}`);
            if (currentStepEl) currentStepEl.style.display = 'block';
            
            // Update progress indicator
            document.querySelectorAll('.progress-step').forEach(stepEl => {
                stepEl.classList.remove('active');
            });
            const currentProgressStep = document.querySelector(`.progress-step[data-step="${step}"]`);
            if (currentProgressStep) {
                currentProgressStep.classList.add('active');
                const circle = currentProgressStep.querySelector('.step-circle');
                if (circle) {
                    circle.style.borderColor = '#20B2AA';
                    circle.style.background = '#20B2AA';
                    circle.style.color = 'white';
                }
            }
            
            // Mark previous steps as completed
            for (let i = 1; i < step; i++) {
                const prevProgressStep = document.querySelector(`.progress-step[data-step="${i}"]`);
                if (prevProgressStep) {
                    const circle = prevProgressStep.querySelector('.step-circle');
                    if (circle) {
                        circle.style.borderColor = '#20B2AA';
                        circle.style.background = '#20B2AA';
                        circle.style.color = 'white';
                        circle.innerHTML = '<i class="fas fa-check"></i>';
                    }
                }
                // Mark progress line as completed
                const prevLine = document.querySelectorAll('.progress-line')[i - 1];
                if (prevLine) {
                    prevLine.classList.add('completed');
                }
            }
            
            currentStep = step;
            
            // Restore form data for the step we're navigating to
            restoreFormData(step);
            
            // Initialize tabs when step 6 is shown
            if (step === 6) {
                // IMPORTANT: Calculate and populate ALL data first (both tab 1 "My Details" and tab 2 "Breakdown" data)
                console.log('Step 6 shown - populating ALL data (My Details + Breakdown)...');
                if (typeof calculateTax === 'function') {
                    console.log('Calling calculateTax to populate all data');
                    calculateTax();
                } else if (typeof window.calculateTax === 'function') {
                    console.log('Calling window.calculateTax to populate all data');
                    window.calculateTax();
                }
                
                // Reset to tab 1 (My Details), but show both sections
                currentTab = 1;
                const wizardStep1 = document.getElementById('wizardStep1');
                const wizardStep2 = document.getElementById('wizardStep2');
                const tabMyDetails = document.getElementById('tabMyDetails');
                const tabBreakdown = document.getElementById('tabBreakdown');
                
                if (wizardStep1) {
                    wizardStep1.style.display = 'block';
                    wizardStep1.style.visibility = 'visible';
                    wizardStep1.classList.remove('tab-content');
                    wizardStep1.classList.add('active-tab');
                }
                if (wizardStep2) {
                    wizardStep2.style.display = 'block';
                    wizardStep2.style.visibility = 'visible';
                    wizardStep2.classList.remove('tab-content');
                    wizardStep2.classList.add('active-tab');
                }
                
                // Set active tab styles
                if (tabMyDetails) {
                    tabMyDetails.classList.add('active');
                    tabMyDetails.style.borderBottomColor = '#20B2AA';
                    tabMyDetails.style.color = '#20B2AA';
                }
                if (tabBreakdown) {
                    tabBreakdown.classList.remove('active');
                    tabBreakdown.style.borderBottomColor = 'transparent';
                    tabBreakdown.style.color = '#6c757d';
                }
                
                // Ensure both data sets are populated (call again after DOM is ready)
                setTimeout(function() {
                    console.log('Re-populating all data to ensure both My Details and Breakdown are filled...');
                    if (typeof calculateTax === 'function') {
                        calculateTax();
                    } else if (typeof window.calculateTax === 'function') {
                        window.calculateTax();
                    }
                }, 150);
            }
            
            document.getElementById('calculatorCard')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function goToStep2() {
            // Check basic required fields
            if (!calculatorData.maritalStatus || !calculatorData.age || !calculatorData.filingMethod) {
                alert('Please fill in all required fields.');
                return;
            }
            // If single is selected, filing status is also required
            if (calculatorData.maritalStatus === 'single' && !calculatorData.filingStatus) {
                alert('Please select your filing status.');
                return;
            }
            // If married filing jointly or separately, filing status is required
            if (calculatorData.maritalStatus === 'married' && !calculatorData.filingStatus) {
                alert('Please select your filing status.');
                return;
            }
            // Calculate tax first (needed for breakdown data)
            calculateTax();
            
            // If "Using a tax professional" is selected, go to dependents page (step 2)
            if (calculatorData.filingMethod === 'with_professional') {
                goToStep(2);
                return;
            }
            // Otherwise, show results
            goToStep(6);
        }

        function goToStep3() {
            goToStep(3);
        }

        function goToStep4() {
            goToStep(4);
        }

        function selectDeduction(type) {
            calculatorData.deductionType = type;
            goToStep(5);
        }

        function goToStep5() {
            goToStep(5);
        }

        function goToStep6() {
            calculateTax();
            goToStep(6);
        }

        // Go back to previous step
        function goBackStep() {
            if (currentStep <= 1) return;
            
            let previousStep = currentStep - 1;
            
            // If going back from results step (step 6), go back to step 1
            if (currentStep === 6) {
                previousStep = 1;
            }
            // If going back from step 3 and incomeType is 'includes_wages', skip step 2
            else if (currentStep === 3 && calculatorData.incomeType === 'includes_wages') {
                previousStep = 1;
            }
            
            goToStep(previousStep);
            restoreFormData(previousStep);
        }

        // Restore form data when navigating back to a step
        function restoreFormData(step) {
            // Step 1: Restore basic info
            if (step === 1) {
                const maritalStatus = document.getElementById('maritalStatus');
                if (maritalStatus && calculatorData.maritalStatus) {
                    maritalStatus.value = calculatorData.maritalStatus;
                    const check = document.getElementById('maritalStatusCheck');
                    if (check) check.style.display = 'block';
                    
                    // Restore filing status dropdown based on marital status
                    const filingStatusRow = document.getElementById('filingStatusRow');
                    const filingStatus = document.getElementById('filingStatus');
                    const spouseAgeRow = document.getElementById('spouseAgeRow');
                    
                    if (calculatorData.maritalStatus === 'married') {
                        if (filingStatusRow) filingStatusRow.style.display = 'flex';
                        if (spouseAgeRow) spouseAgeRow.style.display = 'flex';
                        if (filingStatus) {
                            filingStatus.innerHTML = `
                                <option value="">enter filing status</option>
                                <option value="married_jointly">Married Filing Jointly</option>
                                <option value="married_separately">Married Filing Separately</option>
                            `;
                            if (calculatorData.filingStatus) {
                                filingStatus.value = calculatorData.filingStatus;
                                
                                // Show income field and update label based on filing status
                                const incomeTypeRow = document.getElementById('incomeTypeRow');
                                const incomeLabel = incomeTypeRow ? incomeTypeRow.querySelector('.mobile-field-label') : null;
                                if (calculatorData.filingStatus === 'married_jointly') {
                                    if (incomeTypeRow) incomeTypeRow.style.display = 'flex';
                                    if (incomeLabel) incomeLabel.textContent = 'Our income';
                                    if (spouseAgeRow) spouseAgeRow.style.display = 'flex';
                                } else if (calculatorData.filingStatus === 'married_separately') {
                                    if (incomeTypeRow) incomeTypeRow.style.display = 'flex';
                                    if (incomeLabel) incomeLabel.textContent = 'My income';
                                    if (spouseAgeRow) spouseAgeRow.style.display = 'none';
                                }
                            }
                        }
                    } else if (calculatorData.maritalStatus === 'single') {
                        if (filingStatusRow) filingStatusRow.style.display = 'flex';
                        if (spouseAgeRow) spouseAgeRow.style.display = 'none';
                        if (filingStatus) {
                            filingStatus.innerHTML = `
                                <option value="">enter filing status</option>
                                <option value="single">Single</option>
                                <option value="head_of_household">Head of Household</option>
                            `;
                            if (calculatorData.filingStatus) {
                                filingStatus.value = calculatorData.filingStatus;
                                
                                // Show income field if filing status is single
                                const incomeTypeRow = document.getElementById('incomeTypeRow');
                                if (calculatorData.filingStatus === 'single' && incomeTypeRow) {
                                    incomeTypeRow.style.display = 'flex';
                                }
                            }
                        }
                    } else if (calculatorData.maritalStatus === 'head_of_household') {
                        if (filingStatusRow) filingStatusRow.style.display = 'none';
                        if (spouseAgeRow) spouseAgeRow.style.display = 'none';
                    }
                }
                
                const age = document.getElementById('age');
                if (age && calculatorData.age) {
                    age.value = calculatorData.age;
                    const check = document.getElementById('ageCheck');
                    if (check) check.style.display = 'block';
                }
                
                const filingMethod = document.getElementById('filingMethod');
                if (filingMethod && calculatorData.filingMethod) {
                    filingMethod.value = calculatorData.filingMethod;
                    const check = document.getElementById('filingMethodCheck');
                    if (check) check.style.display = 'block';
                }
                
                const spouseAge = document.getElementById('spouseAge');
                if (spouseAge && calculatorData.spouseAge) {
                    spouseAge.value = calculatorData.spouseAge;
                    const check = document.getElementById('spouseAgeCheck');
                    if (check) check.style.display = 'block';
                }
                
                const incomeType = document.getElementById('incomeType');
                if (incomeType && calculatorData.incomeType) {
                    incomeType.value = calculatorData.incomeType;
                    const check = document.getElementById('incomeTypeCheck');
                    if (check) check.style.display = 'block';
                    
                    // Show income field and update label based on filing status
                    const incomeTypeRow = document.getElementById('incomeTypeRow');
                    const incomeLabel = incomeTypeRow ? incomeTypeRow.querySelector('.mobile-field-label') : null;
                    if (calculatorData.filingStatus === 'single') {
                        if (incomeTypeRow) incomeTypeRow.style.display = 'flex';
                        if (incomeLabel) incomeLabel.textContent = 'My income';
                    } else if (calculatorData.filingStatus === 'married_jointly') {
                        if (incomeTypeRow) incomeTypeRow.style.display = 'flex';
                        if (incomeLabel) incomeLabel.textContent = 'Our income';
                    } else if (calculatorData.filingStatus === 'married_separately') {
                        if (incomeTypeRow) incomeTypeRow.style.display = 'flex';
                        if (incomeLabel) incomeLabel.textContent = 'My income';
                    }
                    
                    const wageIncomeRow = document.getElementById('wageIncomeRow');
                    const taxWithheldRow = document.getElementById('taxWithheldRow');
                    if (calculatorData.incomeType === 'includes_wages') {
                        if (wageIncomeRow) wageIncomeRow.style.display = 'flex';
                        if (taxWithheldRow) taxWithheldRow.style.display = 'flex';
                    }
                }
                
                const wageIncome = document.getElementById('wageIncome');
                if (wageIncome && calculatorData.wageIncome) {
                    wageIncome.value = formatWithCommas(calculatorData.wageIncome, true);
                    const check = document.getElementById('wageIncomeCheck');
                    if (check) check.style.display = 'block';
                }
                
                const taxWithheld = document.getElementById('taxWithheld');
                if (taxWithheld && calculatorData.taxWithheld) {
                    taxWithheld.value = formatWithCommas(calculatorData.taxWithheld, true);
                    const check = document.getElementById('taxWithheldCheck');
                    if (check) check.style.display = 'block';
                }
                
                // Restore spouse wage income and tax withheld if married filing jointly and includes wages
                const spouseWageIncome = document.getElementById('spouseWageIncome');
                if (spouseWageIncome && calculatorData.spouseWageIncome) {
                    spouseWageIncome.value = formatWithCommas(calculatorData.spouseWageIncome, true);
                    const check = document.getElementById('spouseWageIncomeCheck');
                    if (check) check.style.display = 'block';
                }
                
                const spouseTaxWithheld = document.getElementById('spouseTaxWithheld');
                if (spouseTaxWithheld && calculatorData.spouseTaxWithheld) {
                    spouseTaxWithheld.value = formatWithCommas(calculatorData.spouseTaxWithheld, true);
                    const check = document.getElementById('spouseTaxWithheldCheck');
                    if (check) check.style.display = 'block';
                }
                
                // Show spouse fields if conditions are met
                if (calculatorData.filingStatus === 'married_jointly' && calculatorData.incomeType === 'includes_wages') {
                    const spouseWageIncomeRow = document.getElementById('spouseWageIncomeRow');
                    const spouseTaxWithheldRow = document.getElementById('spouseTaxWithheldRow');
                    if (spouseWageIncomeRow) spouseWageIncomeRow.style.display = 'flex';
                    if (spouseTaxWithheldRow) spouseTaxWithheldRow.style.display = 'flex';
                }
            }
            
            // Step 2: Restore dependents
            if (step === 2) {
                const dependentsSection = document.getElementById('dependentsSection');
                const dependentsList = document.getElementById('dependentsList');
                const addDependentBtn = document.getElementById('addDependentBtn');
                
                if (calculatorData.dependents && calculatorData.dependents.length > 0) {
                    if (dependentsSection) dependentsSection.style.display = 'block';
                    if (dependentsList) {
                        dependentsList.innerHTML = '';
                        calculatorData.dependents.forEach((dep, index) => {
                            const savedDependentDiv = document.createElement('div');
                            savedDependentDiv.className = 'saved-dependent';
                            savedDependentDiv.id = `savedDependent_${dep.id || (index + 1)}`;
                            savedDependentDiv.style.cssText = 'display: flex; justify-content: space-between; align-items: center; padding: 15px; border: 2px solid #e0e0e0; border-radius: 10px; margin-bottom: 15px; background: white;';
                            savedDependentDiv.innerHTML = `
                                <div>
                                    <span style="color: #2c3e50; font-weight: 600; font-size: 1rem;">Dependent ${dep.id || (index + 1)}</span>
                                    <span style="color: #6c757d; margin-left: 10px;">Age: ${dep.age}</span>
                                </div>
                                <button type="button" onclick="editDependent(${dep.id || (index + 1)})" style="background: #20B2AA; color: white; border: none; padding: 8px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                                    <i class="fas fa-pencil-alt"></i> Edit
                                </button>
                            `;
                            dependentsList.appendChild(savedDependentDiv);
                        });
                    }
                    
                    // Show and style the "Add another dependent" button
                    if (addDependentBtn) {
                        addDependentBtn.style.display = 'block';
                        addDependentBtn.style.background = 'transparent';
                        addDependentBtn.style.border = '2px solid #4A90E2';
                        addDependentBtn.style.color = '#4A90E2';
                        addDependentBtn.innerHTML = 'Add another dependent';
                    }
                    
                    // Check the "Yes" radio button
                    const dependentsYes = document.getElementById('dependentsYes');
                    if (dependentsYes) dependentsYes.checked = true;
                } else {
                    // Check the "No" radio button
                    const dependentsNo = document.getElementById('dependentsNo');
                    if (dependentsNo) dependentsNo.checked = true;
                }
            }
            
            // Step 3: Restore income types and amounts
            if (step === 3) {
                // Restore income type button states
                document.querySelectorAll('.income-type-btn').forEach(btn => {
                    const type = btn.dataset.type;
                    if (calculatorData.incomeTypes && calculatorData.incomeTypes.includes(type)) {
                        btn.classList.add('selected');
                        const icon = btn.querySelector('i');
                        if (icon) {
                            icon.classList.remove('fa-plus');
                            icon.classList.add('fa-times');
                        }
                        btn.style.background = '#20B2AA';
                        btn.style.borderColor = '#20B2AA';
                        const span = btn.querySelector('span');
                        if (span) span.style.color = 'white';
                    }
                });
                
                // Restore income amount inputs
                const incomeAmountsContainer = document.getElementById('incomeAmountsContainer');
                if (incomeAmountsContainer && calculatorData.incomeAmounts) {
                    incomeAmountsContainer.innerHTML = '';
                    Object.keys(calculatorData.incomeAmounts).forEach(type => {
                        const amount = calculatorData.incomeAmounts[type];
                        const btn = document.querySelector(`.income-type-btn[data-type="${type}"]`);
                        if (btn) {
                            const label = btn.dataset.label || type;
                            const incomeInputDiv = document.createElement('div');
                            incomeInputDiv.id = `incomeAmount_${type}`;
                            incomeInputDiv.className = 'income-amount-input';
                            incomeInputDiv.style.cssText = 'margin-bottom: 20px; padding: 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: #f9f9f9;';
                            incomeInputDiv.innerHTML = `
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <label style="color: #2c3e50; font-weight: 600; font-size: 1rem;">${label}</label>
                                    <i class="fas fa-times" onclick="removeIncomeAmount('${type}')" style="color: #dc3545; cursor: pointer; font-size: 1.1rem;"></i>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <span style="color: #2c3e50; font-weight: 600; font-size: 1.2rem;">$</span>
                                    <input type="text" class="income-amount-field" data-income-type="${type}" value="${formatWithCommas(amount, true)}" placeholder="0.00" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1.1rem; color: #2c3e50;">
                                </div>
                            `;
                            incomeAmountsContainer.appendChild(incomeInputDiv);
                            
                            // Initialize comma input for the amount field
                            const amountInput = incomeInputDiv.querySelector('.income-amount-field');
                            if (amountInput) {
                                initCommaInput(amountInput, (value) => {
                                    if (!calculatorData.incomeAmounts) {
                                        calculatorData.incomeAmounts = {};
                                    }
                                    calculatorData.incomeAmounts[type] = value;
                                    updateEstimatedRefund();
                                });
                            }
                        }
                    });
                }
            }
            
            // Step 4: Restore deduction selection
            if (step === 4) {
                // The deduction selection is handled by the selectDeduction function
                // Visual indication is already handled by the card onclick
            }
            
            // Step 5: Restore credits
            if (step === 5) {
                // Restore credit button states
                document.querySelectorAll('.credit-btn').forEach(btn => {
                    const credit = btn.dataset.credit;
                    if (calculatorData.credits && calculatorData.credits.includes(credit)) {
                        btn.classList.add('selected');
                        const icon = btn.querySelector('i');
                        if (icon) {
                            icon.classList.remove('fa-plus');
                            icon.classList.add('fa-times');
                        }
                        btn.style.background = '#20B2AA';
                        btn.style.borderColor = '#20B2AA';
                        const span = btn.querySelector('span');
                        if (span) span.style.color = 'white';
                    }
                });
            }
        }

        function addDependent() {
            const newDependentForm = document.getElementById('newDependentForm');
            const dependentsList = document.getElementById('dependentsList');
            const addDependentBtn = document.getElementById('addDependentBtn');
            const dependentNumber = calculatorData.dependents.length + 1;
            
            // Hide the add button if this is the first dependent
            if (dependentNumber === 1) {
                addDependentBtn.style.display = 'none';
            } else {
                addDependentBtn.style.background = 'transparent';
                addDependentBtn.style.border = '2px solid #4A90E2';
                addDependentBtn.style.color = '#4A90E2';
                addDependentBtn.innerHTML = 'Add another dependent';
            }
            
            // Create new dependent form
            const dependentFormDiv = document.createElement('div');
            dependentFormDiv.className = 'new-dependent-form';
            dependentFormDiv.id = `newDependentForm_${dependentNumber}`;
            dependentFormDiv.style.cssText = 'border: 2px solid #e0e0e0; border-radius: 10px; padding: 20px; margin-bottom: 15px; background: white;';
            dependentFormDiv.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="color: #2c3e50; font-weight: 600; font-size: 1.1rem; margin: 0;">Dependent ${dependentNumber}</h3>
                    <i class="fas fa-trash" onclick="removeNewDependent(${dependentNumber})" style="color: #dc3545; cursor: pointer; font-size: 1.1rem;"></i>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="color: #2c3e50; font-weight: 600; display: block; margin-bottom: 8px;">Age</label>
                    <input type="number" class="dependent-age" placeholder="Enter age" style="width: 100%; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem;">
                    <small style="color: #6c757d; font-size: 0.85rem; display: block; margin-top: 5px;">As of January 1, 2025</small>
                </div>
                <div style="display: flex; flex-wrap: wrap; gap: 15px; margin-bottom: 20px;">
                    <label style="display: flex; align-items: center; cursor: pointer;">
                        <input type="checkbox" class="dependent-student" style="margin-right: 8px; width: 18px; height: 18px; accent-color: #20B2AA;">
                        <span style="color: #2c3e50;">Student</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer;">
                        <input type="checkbox" class="dependent-disabled" style="margin-right: 8px; width: 18px; height: 18px; accent-color: #20B2AA;">
                        <span style="color: #2c3e50;">Disabled</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer;">
                        <input type="checkbox" class="dependent-lives-with" style="margin-right: 8px; width: 18px; height: 18px; accent-color: #20B2AA;">
                        <span style="color: #2c3e50;">Lives with me</span>
                    </label>
                </div>
                <div style="text-align: right;">
                    <button type="button" onclick="saveDependent(${dependentNumber})" style="background: #20B2AA; color: white; border: none; padding: 12px 30px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                        Done
                    </button>
                </div>
            `;
            
            newDependentForm.innerHTML = '';
            newDependentForm.appendChild(dependentFormDiv);
            newDependentForm.style.display = 'block';
        }

        function removeNewDependent(dependentNumber) {
            const newDependentForm = document.getElementById('newDependentForm');
            newDependentForm.style.display = 'none';
            newDependentForm.innerHTML = '';
            
            const addDependentBtn = document.getElementById('addDependentBtn');
            if (calculatorData.dependents.length === 0) {
                addDependentBtn.style.display = 'block';
                addDependentBtn.style.background = 'transparent';
                addDependentBtn.style.border = '2px solid #20B2AA';
                addDependentBtn.style.color = '#20B2AA';
                addDependentBtn.innerHTML = '<i class="fas fa-plus me-2"></i>Add another dependent';
            }
        }

        function saveDependent(dependentNumber) {
            const formDiv = document.getElementById(`newDependentForm_${dependentNumber}`);
            if (!formDiv) return;
            
            const age = formDiv.querySelector('.dependent-age').value;
            if (!age) {
                alert('Please enter the dependent\'s age.');
                return;
            }
            
            const student = formDiv.querySelector('.dependent-student').checked;
            const disabled = formDiv.querySelector('.dependent-disabled').checked;
            const livesWith = formDiv.querySelector('.dependent-lives-with').checked;
            
            // Save to data
            const dependentData = { 
                id: calculatorData.dependents.length + 1,
                age, 
                student, 
                disabled, 
                livesWith 
            };
            calculatorData.dependents.push(dependentData);
            
            // Create saved dependent display
            const dependentsList = document.getElementById('dependentsList');
            const savedDependentDiv = document.createElement('div');
            savedDependentDiv.className = 'saved-dependent';
            savedDependentDiv.id = `savedDependent_${dependentData.id}`;
            savedDependentDiv.style.cssText = 'display: flex; justify-content: space-between; align-items: center; padding: 15px; border: 2px solid #e0e0e0; border-radius: 10px; margin-bottom: 15px; background: white;';
            savedDependentDiv.innerHTML = `
                <div>
                    <span style="color: #2c3e50; font-weight: 600; font-size: 1rem;">Dependent ${dependentData.id}</span>
                    <span style="color: #6c757d; margin-left: 10px;">Age: ${age}</span>
                </div>
                <button type="button" onclick="editDependent(${dependentData.id})" style="background: #20B2AA; color: white; border: none; padding: 8px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                    <i class="fas fa-pencil-alt"></i> Edit
                </button>
            `;
            dependentsList.appendChild(savedDependentDiv);
            
            // Clear the form
            const newDependentForm = document.getElementById('newDependentForm');
            newDependentForm.style.display = 'none';
            newDependentForm.innerHTML = '';
            
            // Show add button with updated style
            const addDependentBtn = document.getElementById('addDependentBtn');
            addDependentBtn.style.display = 'block';
            addDependentBtn.style.background = 'transparent';
            addDependentBtn.style.border = '2px solid #4A90E2';
            addDependentBtn.style.color = '#4A90E2';
            addDependentBtn.innerHTML = 'Add another dependent';
        }

        function editDependent(dependentId) {
            const dependentData = calculatorData.dependents.find(d => d.id === dependentId);
            if (!dependentData) return;
            
            // Remove from saved list
            const savedDiv = document.getElementById(`savedDependent_${dependentId}`);
            if (savedDiv) savedDiv.remove();
            
            // Remove from data
            calculatorData.dependents = calculatorData.dependents.filter(d => d.id !== dependentId);
            
            // Re-number remaining dependents
            calculatorData.dependents.forEach((d, index) => {
                d.id = index + 1;
                const savedEl = document.getElementById(`savedDependent_${d.id}`);
                if (savedEl) {
                    savedEl.id = `savedDependent_${d.id}`;
                    savedEl.querySelector('span').textContent = `Dependent ${d.id}`;
                    savedEl.querySelector('button').setAttribute('onclick', `editDependent(${d.id})`);
                }
            });
            
            // Show edit form
            const newDependentForm = document.getElementById('newDependentForm');
            const dependentNumber = calculatorData.dependents.length + 1;
            
            const dependentFormDiv = document.createElement('div');
            dependentFormDiv.className = 'new-dependent-form';
            dependentFormDiv.id = `newDependentForm_${dependentNumber}`;
            dependentFormDiv.style.cssText = 'border: 2px solid #e0e0e0; border-radius: 10px; padding: 20px; margin-bottom: 15px; background: white;';
            dependentFormDiv.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="color: #2c3e50; font-weight: 600; font-size: 1.1rem; margin: 0;">Dependent ${dependentNumber}</h3>
                    <i class="fas fa-trash" onclick="removeNewDependent(${dependentNumber})" style="color: #dc3545; cursor: pointer; font-size: 1.1rem;"></i>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="color: #2c3e50; font-weight: 600; display: block; margin-bottom: 8px;">Age</label>
                    <input type="number" class="dependent-age" placeholder="Enter age" value="${dependentData.age}" style="width: 100%; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem;">
                    <small style="color: #6c757d; font-size: 0.85rem; display: block; margin-top: 5px;">As of January 1, 2025</small>
                </div>
                <div style="display: flex; flex-wrap: wrap; gap: 15px; margin-bottom: 20px;">
                    <label style="display: flex; align-items: center; cursor: pointer;">
                        <input type="checkbox" class="dependent-student" ${dependentData.student ? 'checked' : ''} style="margin-right: 8px; width: 18px; height: 18px; accent-color: #20B2AA;">
                        <span style="color: #2c3e50;">Student</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer;">
                        <input type="checkbox" class="dependent-disabled" ${dependentData.disabled ? 'checked' : ''} style="margin-right: 8px; width: 18px; height: 18px; accent-color: #20B2AA;">
                        <span style="color: #2c3e50;">Disabled</span>
                    </label>
                    <label style="display: flex; align-items: center; cursor: pointer;">
                        <input type="checkbox" class="dependent-lives-with" ${dependentData.livesWith ? 'checked' : ''} style="margin-right: 8px; width: 18px; height: 18px; accent-color: #20B2AA;">
                        <span style="color: #2c3e50;">Lives with me</span>
                    </label>
                </div>
                <div style="text-align: right;">
                    <button type="button" onclick="saveDependent(${dependentNumber})" style="background: #20B2AA; color: white; border: none; padding: 12px 30px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 1rem;">
                        Done
                    </button>
                </div>
            `;
            
            newDependentForm.innerHTML = '';
            newDependentForm.appendChild(dependentFormDiv);
            newDependentForm.style.display = 'block';
        }

        // Calculate tax at 19% flat rate
        // Calculate federal tax using progressive tax brackets (2025)
        function calculateTaxAmount(taxableIncome, filingStatus) {
            // Map filing status to bracket key
            let statusKey = 'single';
            if (filingStatus === 'married_jointly' || filingStatus === 'married_separately') {
                statusKey = 'married_jointly';
            } else if (filingStatus === 'head_of_household') {
                statusKey = 'head_of_household';
            }
            
            const brackets = taxBrackets2025[statusKey] || taxBrackets2025.single;
            
            // Progressive bracket calculation
            let totalTax = 0;
            for (let i = 0; i < brackets.length; i++) {
                const [rate, lower, upper] = brackets[i];
                if (taxableIncome > lower) {
                    const amountInBracket = Math.min(taxableIncome, upper) - lower;
                    totalTax += amountInBracket * (rate / 100);
                } else {
                    break;
                }
            }
            
            return Math.max(0, totalTax);
        }
        
        // Get top (marginal) tax bracket for display
        function getTopTaxBracket(taxableIncome, filingStatus) {
            let statusKey = 'single';
            if (filingStatus === 'married_jointly' || filingStatus === 'married_separately') {
                statusKey = 'married_jointly';
            } else if (filingStatus === 'head_of_household') {
                statusKey = 'head_of_household';
            }
            
            const brackets = taxBrackets2025[statusKey] || taxBrackets2025.single;
            
            for (let i = 0; i < brackets.length; i++) {
                const [rate, lower, upper] = brackets[i];
                if (taxableIncome >= lower && taxableIncome < upper) {
                    return rate;
                }
            }
            return 0;
        }

        // Calculate tax and show results
        function calculateTax() {
            console.log('calculateTax called');
            console.log('calculatorData:', calculatorData);
            let income = calculatorData.wageIncome || 0;
            let withheld = calculatorData.taxWithheld || 0;
            
            // For married filing jointly, include spouse income and withholdings
            if (calculatorData.filingStatus === 'married_jointly') {
                income += (calculatorData.spouseWageIncome || 0);
                withheld += (calculatorData.spouseTaxWithheld || 0);
            }
            
            // Add all other income types
            if (calculatorData.incomeAmounts) {
                Object.values(calculatorData.incomeAmounts).forEach(amount => {
                    income += (parseFloat(amount) || 0);
                });
            }
            
            // Get standard deduction based on filing status
            let deduction = calculatorData.standardDeduction;
            if (!deduction || deduction === 15750) {
                // If not set or still default, get from standardDeductions2025
                const filingStatus = calculatorData.filingStatus || 'single';
                deduction = standardDeductions2025[filingStatus] || 15750;
                calculatorData.standardDeduction = deduction;
            }
            // Calculate taxable income: Gross Income - Standard Deduction
            const taxableIncome = Math.max(0, income - deduction);
            
            // Calculate federal tax using progressive brackets
            const totalFederalTax = calculateTaxAmount(taxableIncome, calculatorData.filingStatus || 'single');
            
            // Calculate credits
            const credits = calculatorData.credits.length * 500; // Simple credit estimate
            
            // Final tax after credits
            const finalTax = Math.max(0, totalFederalTax - credits);
            
            // Refund formula: Withholdings + Credits - Total Federal Tax
            const netAmount = (withheld + credits) - totalFederalTax; // Allow negative values to show amount owed
            
            // Get top (marginal) tax bracket for display
            const topBracketRate = getTopTaxBracket(taxableIncome, calculatorData.filingStatus || 'single');
            const taxBracket = topBracketRate > 0 ? topBracketRate + '%' : '0%';
            
            // Effective Tax Rate: (Total Federal Tax  Taxable Income)  100
            // Round to nearest whole percent (HR Block style)
            let effectiveRate = 0;
            if (taxableIncome > 0) {
                const exactRate = (totalFederalTax / taxableIncome) * 100;
                effectiveRate = Math.round(exactRate); // Round to nearest whole percent
            }
            
            // Display results
            const headerLabel = netAmount >= 0 ? 'Your estimated refund:' : 'Your estimated balance due:';
            document.getElementById('finalRefundLabel').textContent = headerLabel;
            
            const finalRefundAmountEl = document.getElementById('finalRefundAmount');
            finalRefundAmountEl.textContent = formatCurrency(netAmount);
            // Apply color based on positive/negative
            if (netAmount < 0) {
                finalRefundAmountEl.style.color = '#dc3545';
            } else {
                finalRefundAmountEl.style.color = '#48CAE4';
            }
            
            // Populate breakdown data - check if elements exist first
            console.log('Populating breakdown data...');
            console.log('Income:', income, 'Deduction:', deduction, 'Taxable Income:', taxableIncome);
            
            const resultIncomeEl = document.getElementById('resultIncome');
            const resultDeductionsEl = document.getElementById('resultDeductions');
            const resultTaxableIncomeEl = document.getElementById('resultTaxableIncome');
            const resultTaxBracketEl = document.getElementById('resultTaxBracket');
            const resultEffectiveRateEl = document.getElementById('resultEffectiveRate');
            const resultTaxesRefundedEl = document.getElementById('resultTaxesRefunded');
            const resultWithheldEl = document.getElementById('resultWithheld');
            const resultCreditsEl = document.getElementById('resultCredits');
            const resultTotalLabelEl = document.getElementById('resultTotalLabel');
            const resultTotalRefundEl = document.getElementById('resultTotalRefund');
            
            if (resultIncomeEl) {
                resultIncomeEl.textContent = formatCurrency(income);
                console.log(' Income set to:', formatCurrency(income));
            } else {
                console.error(' resultIncome element not found!');
            }
            
            if (resultDeductionsEl) {
                resultDeductionsEl.textContent = formatCurrency(deduction);
                console.log(' Deductions set to:', formatCurrency(deduction));
            } else {
                console.error(' resultDeductions element not found!');
            }
            
            if (resultTaxableIncomeEl) {
                resultTaxableIncomeEl.textContent = formatCurrency(taxableIncome);
                console.log(' Taxable Income set to:', formatCurrency(taxableIncome));
            } else {
                console.error(' resultTaxableIncome element not found!');
            }
            
            if (resultTaxBracketEl) {
                resultTaxBracketEl.textContent = taxBracket;
                console.log(' Tax Bracket set to:', taxBracket);
            } else {
                console.error(' resultTaxBracket element not found!');
            }
            
            // Display effective rate (already rounded to whole percent)
            if (resultEffectiveRateEl) {
                resultEffectiveRateEl.textContent = effectiveRate + '%';
                console.log(' Effective Rate set to:', effectiveRate + '%');
            } else {
                console.error(' resultEffectiveRate element not found!');
            }
            
            if (resultTaxesRefundedEl) {
                // "Taxes refunded" shows the total federal tax (before credits)
                resultTaxesRefundedEl.textContent = formatCurrency(totalFederalTax);
                console.log(' Taxes Refunded set to:', formatCurrency(totalFederalTax));
                
                // Update the explanation text with actual effective rate
                const taxesRefundedExplanation = document.getElementById('taxesRefundedExplanation');
                if (taxesRefundedExplanation) {
                    taxesRefundedExplanation.textContent = `(Taxable income times effective tax rate of ${effectiveRate}%)`;
                }
            } else {
                console.error(' resultTaxesRefunded element not found!');
            }
            
            if (resultWithheldEl) {
                resultWithheldEl.textContent = formatCurrency(withheld);
                console.log(' Withheld set to:', formatCurrency(withheld));
            } else {
                console.error(' resultWithheld element not found!');
            }
            
            if (resultCreditsEl) {
                resultCreditsEl.textContent = formatCurrency(credits);
                console.log(' Credits set to:', formatCurrency(credits));
            } else {
                console.error(' resultCredits element not found!');
            }
            
            const totalLabel = netAmount >= 0 ? 'Total tax refund' : 'Total balance due';
            if (resultTotalLabelEl) {
                resultTotalLabelEl.textContent = totalLabel;
            } else {
                console.error(' resultTotalLabel element not found!');
            }
            
            if (resultTotalRefundEl) {
                resultTotalRefundEl.textContent = formatCurrency(netAmount);
                console.log(' Total Refund set to:', formatCurrency(netAmount));
            } else {
                console.error(' resultTotalRefund element not found!');
            }
            
            // Style total refund in dark green to match design
            if (resultTotalRefundEl) {
                resultTotalRefundEl.style.color = '#0f5132';
                resultTotalRefundEl.style.fontWeight = '700';
            }
            
            // Populate personal details (Step 1: My Details)
            const maritalStatusLabels = {
                'single': 'Single',
                'married': 'Married',
                'head_of_household': 'Head of Household'
            };
            const filingStatusLabels = {
                'single': 'Single',
                'married_jointly': 'Jointly',
                'married_separately': 'Separately',
                'head_of_household': 'Head of Household'
            };
            
            const resultMaritalStatusEl = document.getElementById('resultMaritalStatus');
            const resultFilingStatusEl = document.getElementById('resultFilingStatus');
            const resultAgeEl = document.getElementById('resultAge');
            
            if (resultMaritalStatusEl) {
                resultMaritalStatusEl.textContent = maritalStatusLabels[calculatorData.maritalStatus] || '-';
            }
            if (resultFilingStatusEl) {
                resultFilingStatusEl.textContent = filingStatusLabels[calculatorData.filingStatus] || '-';
            }
            if (resultAgeEl) {
                resultAgeEl.textContent = calculatorData.age || '-';
            }
            
            const spouseAgeRow = document.getElementById('resultSpouseAgeRow');
            const resultSpouseAge = document.getElementById('resultSpouseAge');
            if (calculatorData.spouseAge && calculatorData.spouseAge > 0) {
                spouseAgeRow.style.display = 'flex';
                resultSpouseAge.textContent = calculatorData.spouseAge;
            } else {
                spouseAgeRow.style.display = 'none';
            }
            
            // Populate income and withholdings in details section (Step 1: My Details)
            const myIncome = calculatorData.wageIncome || 0;
            const myWithholdings = calculatorData.taxWithheld || 0;
            const resultMyIncomeEl = document.getElementById('resultMyIncome');
            const resultMyWithholdingsEl = document.getElementById('resultMyWithholdings');
            
            if (resultMyIncomeEl) {
                resultMyIncomeEl.textContent = formatCurrency(myIncome);
            }
            if (resultMyWithholdingsEl) {
                resultMyWithholdingsEl.textContent = formatCurrency(myWithholdings);
            }
            
            // Populate spouse income and withholdings if applicable
            const spouseIncomeRow = document.getElementById('resultSpouseIncomeRow');
            const resultSpouseIncome = document.getElementById('resultSpouseIncome');
            const spouseWithholdingsRow = document.getElementById('resultSpouseWithholdingsRow');
            const resultSpouseWithholdings = document.getElementById('resultSpouseWithholdings');
            
            if (calculatorData.filingStatus === 'married_jointly' && (calculatorData.spouseWageIncome || calculatorData.spouseTaxWithheld)) {
                if (spouseIncomeRow) {
                    spouseIncomeRow.style.display = 'flex';
                    resultSpouseIncome.textContent = formatCurrency(calculatorData.spouseWageIncome || 0);
                }
                if (spouseWithholdingsRow) {
                    spouseWithholdingsRow.style.display = 'flex';
                    resultSpouseWithholdings.textContent = formatCurrency(calculatorData.spouseTaxWithheld || 0);
                }
            } else {
                if (spouseIncomeRow) spouseIncomeRow.style.display = 'none';
                if (spouseWithholdingsRow) spouseWithholdingsRow.style.display = 'none';
            }
            // Apply color based on positive/negative
            if (netAmount < 0) {
                resultTotalRefundEl.style.color = '#dc3545';
            } else {
                resultTotalRefundEl.style.color = '#20B2AA';
            }
            
            // Update header refund display
            const estimatedRefundDisplayEl = document.getElementById('estimatedRefundDisplay');
            estimatedRefundDisplayEl.textContent = formatCurrency(netAmount);
            // Apply styling based on positive/negative
            if (netAmount < 0) {
                estimatedRefundDisplayEl.style.background = 'linear-gradient(135deg, #dc3545 0%, #c82333 100%)';
                estimatedRefundDisplayEl.style.webkitBackgroundClip = 'text';
                estimatedRefundDisplayEl.style.webkitTextFillColor = 'transparent';
                estimatedRefundDisplayEl.style.backgroundClip = 'text';
                estimatedRefundDisplayEl.style.textShadow = '0 2px 10px rgba(220, 53, 69, 0.2)';
            } else {
                estimatedRefundDisplayEl.style.background = 'linear-gradient(135deg, #20B2AA 0%, #17a2b8 100%)';
                estimatedRefundDisplayEl.style.webkitBackgroundClip = 'text';
                estimatedRefundDisplayEl.style.webkitTextFillColor = 'transparent';
                estimatedRefundDisplayEl.style.backgroundClip = 'text';
                estimatedRefundDisplayEl.style.textShadow = '0 2px 10px rgba(32, 178, 170, 0.2)';
            }
            
            // Update header label
            const estimatedRefundLabelEl = document.getElementById('estimatedRefundLabel');
            if (estimatedRefundLabelEl) {
                estimatedRefundLabelEl.textContent = headerLabel;
            }
            
            console.log('calculateTax completed. Breakdown data should be populated.');
        }
        
        // Make function globally accessible immediately
        window.calculateTax = calculateTax;
        
        // W-2 Form Functions
        let w2FormCount = 0;
        let w2FormsData = [];
        
        function showW2FormInline() {
            const container = document.getElementById('w2FormContainer');
            if (container) {
                container.style.display = 'block';
                // Initialize with one W-2 form if empty
                const formsContainer = document.getElementById('w2FormsContainer');
                if (formsContainer && formsContainer.children.length === 0) {
                    addW2Form();
                }
            }
        }
        
        function closeW2FormInline() {
            const container = document.getElementById('w2FormContainer');
            if (container) {
                container.style.display = 'none';
            }
        }
        
        // Keep old function names for backward compatibility
        function showW2Form() {
            showW2FormInline();
        }
        
        function closeW2Form() {
            closeW2FormInline();
        }
        
        function addW2Form() {
            w2FormCount++;
            const formId = `w2Form_${w2FormCount}`;
            const container = document.getElementById('w2FormsContainer');
            
            if (container) {
                const w2FormDiv = document.createElement('div');
                w2FormDiv.id = formId;
                w2FormDiv.className = 'w2-form-item';
                w2FormDiv.style.cssText = 'margin-bottom: 25px; padding: 25px; border: 2px solid #e0e0e0; border-radius: 12px; background: #f9f9f9;';
                w2FormDiv.innerHTML = `
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: #2c3e50; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Total wages (optional)</label>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: #2c3e50; font-weight: 600; font-size: 1.1rem;">$</span>
                            <input type="text" class="w2-wages" data-form-id="${formId}" placeholder="0.00" value="0" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; color: #2c3e50;">
                        </div>
                        <small style="color: #6c757d; font-size: 0.85rem; margin-top: 5px; display: block;">Box 1 on W-2</small>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: #2c3e50; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Total federal withholdings (optional)</label>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: #2c3e50; font-weight: 600; font-size: 1.1rem;">$</span>
                            <input type="text" class="w2-withholdings" data-form-id="${formId}" placeholder="0.00" value="0" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; color: #2c3e50;">
                        </div>
                        <small style="color: #6c757d; font-size: 0.85rem; margin-top: 5px; display: block;">Box 2 on W-2</small>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: #2c3e50; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Tips (optional)</label>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: #2c3e50; font-weight: 600; font-size: 1.1rem;">$</span>
                            <input type="text" class="w2-tips" data-form-id="${formId}" placeholder="0.00" value="0" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; color: #2c3e50;">
                            <i class="fas fa-question-circle" style="color: #20B2AA; cursor: pointer; font-size: 1.1rem;" title="Tips received"></i>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: #2c3e50; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Overtime pay (optional)</label>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: #2c3e50; font-weight: 600; font-size: 1.1rem;">$</span>
                            <input type="text" class="w2-overtime" data-form-id="${formId}" placeholder="0.00" value="0" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; color: #2c3e50;">
                            <i class="fas fa-question-circle" style="color: #20B2AA; cursor: pointer; font-size: 1.1rem;" title="Overtime pay received"></i>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: #2c3e50; font-weight: 600; margin-bottom: 12px; font-size: 0.9rem;">Whose W-2 is this?</label>
                        <div style="display: flex; gap: 20px;">
                            <label style="display: flex; align-items: center; cursor: pointer;">
                                <input type="radio" name="w2Owner_${formId}" class="w2-owner" data-form-id="${formId}" value="mine" checked style="margin-right: 8px; width: 18px; height: 18px; accent-color: #20B2AA;">
                                <span style="color: #2c3e50; font-weight: 600;">Mine</span>
                            </label>
                            <label style="display: flex; align-items: center; cursor: pointer;">
                                <input type="radio" name="w2Owner_${formId}" class="w2-owner" data-form-id="${formId}" value="spouse" style="margin-right: 8px; width: 18px; height: 18px; accent-color: #20B2AA;">
                                <span style="color: #2c3e50; font-weight: 600;">My spouse</span>
                            </label>
                        </div>
                    </div>
                    
                    ${w2FormCount > 1 ? `<button type="button" onclick="removeW2Form('${formId}')" style="background: transparent; color: #dc3545; border: 1px solid #dc3545; padding: 8px 16px; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 0.9rem;">Remove this W-2</button>` : ''}
                `;
                container.appendChild(w2FormDiv);
            }
        }
        
        function addAnotherW2() {
            addW2Form();
        }
        
        function removeW2Form(formId) {
            const form = document.getElementById(formId);
            if (form) {
                form.remove();
            }
        }
        
        function saveW2Form() {
            const container = document.getElementById('w2FormsContainer');
            if (!container) return;
            
            const forms = container.querySelectorAll('.w2-form-item');
            w2FormsData = [];
            let totalWages = 0;
            let totalWithholdings = 0;
            
            forms.forEach((form, index) => {
                const formId = form.id;
                const wages = parseFloat(form.querySelector('.w2-wages')?.value.replace(/,/g, '') || 0);
                const withholdings = parseFloat(form.querySelector('.w2-withholdings')?.value.replace(/,/g, '') || 0);
                const tips = parseFloat(form.querySelector('.w2-tips')?.value.replace(/,/g, '') || 0);
                const overtime = parseFloat(form.querySelector('.w2-overtime')?.value.replace(/,/g, '') || 0);
                const owner = form.querySelector('.w2-owner:checked')?.value || 'mine';
                
                w2FormsData.push({
                    wages: wages,
                    withholdings: withholdings,
                    tips: tips,
                    overtime: overtime,
                    owner: owner
                });
                
                // Add to appropriate totals based on owner
                if (owner === 'mine') {
                    totalWages += wages + tips + overtime;
                    totalWithholdings += withholdings;
                } else {
                    // For spouse, add to spouse totals
                    if (!calculatorData.spouseWageIncome) calculatorData.spouseWageIncome = 0;
                    if (!calculatorData.spouseTaxWithheld) calculatorData.spouseTaxWithheld = 0;
                    calculatorData.spouseWageIncome += wages + tips + overtime;
                    calculatorData.spouseTaxWithheld += withholdings;
                }
            });
            
            // Update calculator data
            calculatorData.w2Forms = w2FormsData;
            calculatorData.wageIncome = totalWages;
            calculatorData.taxWithheld = totalWithholdings;
            
            // Update income amount display
            const incomeAmountsContainer = document.getElementById('incomeAmountsContainer');
            const existingInput = document.getElementById('incomeAmount_employment');
            
            if (existingInput) {
                const input = existingInput.querySelector('.income-amount-field');
                if (input) {
                    input.value = formatWithCommas(totalWages, true);
                }
            } else {
                // Create income amount display
                const incomeInputDiv = document.createElement('div');
                incomeInputDiv.id = 'incomeAmount_employment';
                incomeInputDiv.className = 'income-amount-input';
                incomeInputDiv.style.cssText = 'margin-bottom: 20px; padding: 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: #f9f9f9;';
                incomeInputDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <label style="color: #2c3e50; font-weight: 600; font-size: 1rem;">Employment (W-2)</label>
                        <i class="fas fa-times" onclick="removeIncomeAmount('employment')" style="color: #dc3545; cursor: pointer; font-size: 1.1rem;"></i>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="color: #2c3e50; font-weight: 600; font-size: 1.2rem;">$</span>
                        <input type="text" class="income-amount-field" data-income-type="employment" value="${formatWithCommas(totalWages, true)}" placeholder="0.00" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1.1rem; color: #2c3e50;" readonly>
                    </div>
                `;
                if (incomeAmountsContainer) {
                    incomeAmountsContainer.appendChild(incomeInputDiv);
                }
            }
            
            // Close inline form
            closeW2FormInline();
        }
        
        // Interest Form Functions
        function showInterestFormInline() {
            const container = document.getElementById('interestFormContainer');
            if (container) {
                container.style.display = 'block';
            }
        }
        
        function closeInterestFormInline() {
            const container = document.getElementById('interestFormContainer');
            if (container) {
                container.style.display = 'none';
            }
        }
        
        function saveInterestForm() {
            const input = document.getElementById('interestIncome');
            if (input) {
                const amount = parseFloat(input.value.replace(/,/g, '') || 0);
                if (!calculatorData.incomeAmounts) calculatorData.incomeAmounts = {};
                calculatorData.incomeAmounts.interest = amount;
                
                // Update income amount display
                const incomeAmountsContainer = document.getElementById('incomeAmountsContainer');
                const existingInput = document.getElementById('incomeAmount_interest');
                
                if (existingInput) {
                    const displayInput = existingInput.querySelector('.income-amount-field');
                    if (displayInput) {
                        displayInput.value = formatWithCommas(amount, true);
                    }
                } else {
                    const incomeInputDiv = document.createElement('div');
                    incomeInputDiv.id = 'incomeAmount_interest';
                    incomeInputDiv.className = 'income-amount-input';
                    incomeInputDiv.style.cssText = 'margin-bottom: 20px; padding: 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: #f9f9f9;';
                    incomeInputDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <label style="color: #2c3e50; font-weight: 600; font-size: 1rem;">Interest</label>
                            <i class="fas fa-times" onclick="removeIncomeAmount('interest')" style="color: #dc3545; cursor: pointer; font-size: 1.1rem;"></i>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: #2c3e50; font-weight: 600; font-size: 1.2rem;">$</span>
                            <input type="text" class="income-amount-field" data-income-type="interest" value="${formatWithCommas(amount, true)}" placeholder="0.00" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1.1rem; color: #2c3e50;" readonly>
                        </div>
                    `;
                    if (incomeAmountsContainer) {
                        incomeAmountsContainer.appendChild(incomeInputDiv);
                    }
                }
            }
            closeInterestFormInline();
        }
        
        // Business Form Functions
        let businessFormCount = 0;
        let businessFormsData = [];
        
        function showBusinessFormInline() {
            const container = document.getElementById('businessFormContainer');
            if (container) {
                container.style.display = 'block';
                const formsContainer = document.getElementById('businessFormsContainer');
                if (formsContainer && formsContainer.children.length === 0) {
                    addBusinessForm();
                }
            }
        }
        
        function closeBusinessFormInline() {
            const container = document.getElementById('businessFormContainer');
            if (container) {
                container.style.display = 'none';
            }
        }
        
        function addBusinessForm() {
            businessFormCount++;
            const formId = `businessForm_${businessFormCount}`;
            const container = document.getElementById('businessFormsContainer');
            
            if (container) {
                const businessFormDiv = document.createElement('div');
                businessFormDiv.id = formId;
                businessFormDiv.className = 'business-form-item';
                businessFormDiv.style.cssText = 'margin-bottom: 25px; padding: 25px; border: 2px solid #e0e0e0; border-radius: 12px; background: white;';
                businessFormDiv.innerHTML = `
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: #0f5132; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Net business income (optional)</label>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: #2c3e50; font-weight: 600; font-size: 1.1rem;">$</span>
                            <input type="text" class="business-income" data-form-id="${formId}" placeholder="0.00" value="0" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; color: #2c3e50;">
                        </div>
                        <small style="color: #6c757d; font-size: 0.85rem; margin-top: 5px; display: block;">1000-MISC, Box 3 or 1000-NEC, Box 1</small>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: #0f5132; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Tips (optional)</label>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: #2c3e50; font-weight: 600; font-size: 1.1rem;">$</span>
                            <input type="text" class="business-tips" data-form-id="${formId}" placeholder="0.00" value="0" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; color: #2c3e50;">
                            <i class="fas fa-question-circle" style="color: #20B2AA; cursor: pointer; font-size: 1.1rem;" title="Tips received"></i>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: #0f5132; font-weight: 600; margin-bottom: 12px; font-size: 0.9rem;">Who owns the business?</label>
                        <div style="display: flex; gap: 20px;">
                            <label style="display: flex; align-items: center; cursor: pointer;">
                                <input type="radio" name="businessOwner_${formId}" class="business-owner" data-form-id="${formId}" value="myself" checked style="margin-right: 8px; width: 18px; height: 18px; accent-color: #20B2AA;">
                                <span style="color: #2c3e50; font-weight: 600;">Myself</span>
                            </label>
                            <label style="display: flex; align-items: center; cursor: pointer;">
                                <input type="radio" name="businessOwner_${formId}" class="business-owner" data-form-id="${formId}" value="spouse" style="margin-right: 8px; width: 18px; height: 18px; accent-color: #20B2AA;">
                                <span style="color: #2c3e50; font-weight: 600;">My Spouse</span>
                            </label>
                        </div>
                    </div>
                    
                    ${businessFormCount > 1 ? `<button type="button" onclick="removeBusinessForm('${formId}')" style="background: transparent; color: #dc3545; border: 1px solid #dc3545; padding: 8px 16px; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 0.9rem;">Remove this business</button>` : ''}
                `;
                container.appendChild(businessFormDiv);
            }
        }
        
        function addAnotherBusiness() {
            addBusinessForm();
        }
        
        function removeBusinessForm(formId) {
            const form = document.getElementById(formId);
            if (form) {
                form.remove();
            }
        }
        
        function saveBusinessForm() {
            const container = document.getElementById('businessFormsContainer');
            if (!container) return;
            
            const forms = container.querySelectorAll('.business-form-item');
            businessFormsData = [];
            let totalBusinessIncome = 0;
            
            forms.forEach((form) => {
                const formId = form.id;
                const income = parseFloat(form.querySelector('.business-income')?.value.replace(/,/g, '') || 0);
                const tips = parseFloat(form.querySelector('.business-tips')?.value.replace(/,/g, '') || 0);
                const owner = form.querySelector('.business-owner:checked')?.value || 'myself';
                
                businessFormsData.push({
                    income: income,
                    tips: tips,
                    owner: owner
                });
                
                totalBusinessIncome += income + tips;
            });
            
            calculatorData.businessForms = businessFormsData;
            if (!calculatorData.incomeAmounts) calculatorData.incomeAmounts = {};
            calculatorData.incomeAmounts.business = totalBusinessIncome;
            
            // Update income amount display
            const incomeAmountsContainer = document.getElementById('incomeAmountsContainer');
            const existingInput = document.getElementById('incomeAmount_business');
            
            if (existingInput) {
                const input = existingInput.querySelector('.income-amount-field');
                if (input) {
                    input.value = formatWithCommas(totalBusinessIncome, true);
                }
            } else {
                const incomeInputDiv = document.createElement('div');
                incomeInputDiv.id = 'incomeAmount_business';
                incomeInputDiv.className = 'income-amount-input';
                incomeInputDiv.style.cssText = 'margin-bottom: 20px; padding: 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: #f9f9f9;';
                incomeInputDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <label style="color: #2c3e50; font-weight: 600; font-size: 1rem;">Business</label>
                        <i class="fas fa-times" onclick="removeIncomeAmount('business')" style="color: #dc3545; cursor: pointer; font-size: 1.1rem;"></i>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="color: #2c3e50; font-weight: 600; font-size: 1.2rem;">$</span>
                        <input type="text" class="income-amount-field" data-income-type="business" value="${formatWithCommas(totalBusinessIncome, true)}" placeholder="0.00" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1.1rem; color: #2c3e50;" readonly>
                    </div>
                `;
                if (incomeAmountsContainer) {
                    incomeAmountsContainer.appendChild(incomeInputDiv);
                }
            }
            
            closeBusinessFormInline();
        }
        
        // Social Security Form Functions
        function showSocialSecurityFormInline() {
            const container = document.getElementById('socialSecurityFormContainer');
            if (container) {
                container.style.display = 'block';
            }
        }
        
        function closeSocialSecurityFormInline() {
            const container = document.getElementById('socialSecurityFormContainer');
            if (container) {
                container.style.display = 'none';
            }
        }
        
        function saveSocialSecurityForm() {
            const benefitsInput = document.getElementById('socialSecurityBenefits');
            const withheldInput = document.getElementById('socialSecurityWithheld');
            
            if (benefitsInput) {
                const amount = parseFloat(benefitsInput.value.replace(/,/g, '') || 0);
                if (!calculatorData.incomeAmounts) calculatorData.incomeAmounts = {};
                calculatorData.incomeAmounts.social_security = amount;
                
                // Update income amount display
                const incomeAmountsContainer = document.getElementById('incomeAmountsContainer');
                const existingInput = document.getElementById('incomeAmount_social_security');
                
                if (existingInput) {
                    const displayInput = existingInput.querySelector('.income-amount-field');
                    if (displayInput) {
                        displayInput.value = formatWithCommas(amount, true);
                    }
                } else {
                    const incomeInputDiv = document.createElement('div');
                    incomeInputDiv.id = 'incomeAmount_social_security';
                    incomeInputDiv.className = 'income-amount-input';
                    incomeInputDiv.style.cssText = 'margin-bottom: 20px; padding: 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: #f9f9f9;';
                    incomeInputDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <label style="color: #2c3e50; font-weight: 600; font-size: 1rem;">Social Security</label>
                            <i class="fas fa-times" onclick="removeIncomeAmount('social_security')" style="color: #dc3545; cursor: pointer; font-size: 1.1rem;"></i>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: #2c3e50; font-weight: 600; font-size: 1.2rem;">$</span>
                            <input type="text" class="income-amount-field" data-income-type="social_security" value="${formatWithCommas(amount, true)}" placeholder="0.00" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1.1rem; color: #2c3e50;" readonly>
                        </div>
                    `;
                    if (incomeAmountsContainer) {
                        incomeAmountsContainer.appendChild(incomeInputDiv);
                    }
                }
            }
            
            closeSocialSecurityFormInline();
        }
        
        // Make all functions globally accessible
        window.showW2Form = showW2Form;
        window.closeW2Form = closeW2Form;
        window.addAnotherW2 = addAnotherW2;
        window.removeW2Form = removeW2Form;
        window.saveW2Form = saveW2Form;
        window.showInterestFormInline = showInterestFormInline;
        window.closeInterestFormInline = closeInterestFormInline;
        window.saveInterestForm = saveInterestForm;
        window.showBusinessFormInline = showBusinessFormInline;
        window.closeBusinessFormInline = closeBusinessFormInline;
        window.addAnotherBusiness = addAnotherBusiness;
        window.removeBusinessForm = removeBusinessForm;
        window.saveBusinessForm = saveBusinessForm;
        window.showSocialSecurityFormInline = showSocialSecurityFormInline;
        window.closeSocialSecurityFormInline = closeSocialSecurityFormInline;
        window.saveSocialSecurityForm = saveSocialSecurityForm;
        
        // Dividends Form Functions
        function showDividendsFormInline() {
            const container = document.getElementById('dividendsFormContainer');
            if (container) {
                container.style.display = 'block';
            }
        }
        
        function closeDividendsFormInline() {
            const container = document.getElementById('dividendsFormContainer');
            if (container) {
                container.style.display = 'none';
            }
        }
        
        function saveDividendsForm() {
            const ordinaryInput = document.getElementById('ordinaryDividends');
            const qualifiedInput = document.getElementById('qualifiedDividends');
            
            if (ordinaryInput && qualifiedInput) {
                const ordinaryAmount = parseFloat(ordinaryInput.value.replace(/,/g, '') || 0);
                const qualifiedAmount = parseFloat(qualifiedInput.value.replace(/,/g, '') || 0);
                const totalAmount = ordinaryAmount + qualifiedAmount;
                
                if (!calculatorData.incomeAmounts) calculatorData.incomeAmounts = {};
                calculatorData.incomeAmounts.dividends = totalAmount;
                
                // Update income amount display
                const incomeAmountsContainer = document.getElementById('incomeAmountsContainer');
                const existingInput = document.getElementById('incomeAmount_dividends');
                
                if (existingInput) {
                    const displayInput = existingInput.querySelector('.income-amount-field');
                    if (displayInput) {
                        displayInput.value = formatWithCommas(totalAmount, true);
                    }
                } else {
                    const incomeInputDiv = document.createElement('div');
                    incomeInputDiv.id = 'incomeAmount_dividends';
                    incomeInputDiv.className = 'income-amount-input';
                    incomeInputDiv.style.cssText = 'margin-bottom: 20px; padding: 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: #f9f9f9;';
                    incomeInputDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <label style="color: #2c3e50; font-weight: 600; font-size: 1rem;">Dividends</label>
                            <i class="fas fa-times" onclick="removeIncomeAmount('dividends')" style="color: #dc3545; cursor: pointer; font-size: 1.1rem;"></i>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: #2c3e50; font-weight: 600; font-size: 1.2rem;">$</span>
                            <input type="text" class="income-amount-field" data-income-type="dividends" value="${formatWithCommas(totalAmount, true)}" placeholder="0.00" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1.1rem; color: #2c3e50;" readonly>
                        </div>
                    `;
                    if (incomeAmountsContainer) {
                        incomeAmountsContainer.appendChild(incomeInputDiv);
                    }
                }
            }
            closeDividendsFormInline();
        }
        
        // Combat Pay Form Functions
        function showCombatPayFormInline() {
            const container = document.getElementById('combatPayFormContainer');
            if (container) {
                container.style.display = 'block';
            }
        }
        
        function closeCombatPayFormInline() {
            const container = document.getElementById('combatPayFormContainer');
            if (container) {
                container.style.display = 'none';
            }
        }
        
        function saveCombatPayForm() {
            const amountInput = document.getElementById('combatPayAmount');
            const eicCheckbox = document.getElementById('includeCombatPayEIC');
            
            if (amountInput) {
                const amount = parseFloat(amountInput.value.replace(/,/g, '') || 0);
                const includeInEIC = eicCheckbox ? eicCheckbox.checked : false;
                
                if (!calculatorData.incomeAmounts) calculatorData.incomeAmounts = {};
                calculatorData.incomeAmounts.combat_pay = amount;
                calculatorData.combatPayIncludeEIC = includeInEIC;
                
                // Update income amount display
                const incomeAmountsContainer = document.getElementById('incomeAmountsContainer');
                const existingInput = document.getElementById('incomeAmount_combat_pay');
                
                if (existingInput) {
                    const displayInput = existingInput.querySelector('.income-amount-field');
                    if (displayInput) {
                        displayInput.value = formatWithCommas(amount, true);
                    }
                } else {
                    const incomeInputDiv = document.createElement('div');
                    incomeInputDiv.id = 'incomeAmount_combat_pay';
                    incomeInputDiv.className = 'income-amount-input';
                    incomeInputDiv.style.cssText = 'margin-bottom: 20px; padding: 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: #f9f9f9;';
                    incomeInputDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <label style="color: #2c3e50; font-weight: 600; font-size: 1rem;">Combat pay</label>
                            <i class="fas fa-times" onclick="removeIncomeAmount('combat_pay')" style="color: #dc3545; cursor: pointer; font-size: 1.1rem;"></i>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: #2c3e50; font-weight: 600; font-size: 1.2rem;">$</span>
                            <input type="text" class="income-amount-field" data-income-type="combat_pay" value="${formatWithCommas(amount, true)}" placeholder="0.00" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1.1rem; color: #2c3e50;" readonly>
                        </div>
                    `;
                    if (incomeAmountsContainer) {
                        incomeAmountsContainer.appendChild(incomeInputDiv);
                    }
                }
            }
            closeCombatPayFormInline();
        }
        
        // Unemployment Form Functions
        let unemploymentFormCount = 0;
        let unemploymentFormsData = [];
        
        function showUnemploymentFormInline() {
            const container = document.getElementById('unemploymentFormContainer');
            if (container) {
                container.style.display = 'block';
                const formsContainer = document.getElementById('unemploymentFormsContainer');
                if (formsContainer && formsContainer.children.length === 0) {
                    addUnemploymentForm();
                }
            }
        }
        
        function closeUnemploymentFormInline() {
            const container = document.getElementById('unemploymentFormContainer');
            if (container) {
                container.style.display = 'none';
            }
        }
        
        function addUnemploymentForm() {
            unemploymentFormCount++;
            const formId = `unemploymentForm_${unemploymentFormCount}`;
            const container = document.getElementById('unemploymentFormsContainer');
            
            if (container) {
                const unemploymentFormDiv = document.createElement('div');
                unemploymentFormDiv.id = formId;
                unemploymentFormDiv.className = 'unemployment-form-item';
                unemploymentFormDiv.style.cssText = 'margin-bottom: 25px; padding: 25px; border: 2px solid #e0e0e0; border-radius: 12px; background: white;';
                unemploymentFormDiv.innerHTML = `
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: #0f5132; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Total unemployment (2025) (optional)</label>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: #2c3e50; font-weight: 600; font-size: 1.1rem;">$</span>
                            <input type="text" class="unemployment-amount" data-form-id="${formId}" placeholder="0.00" value="0" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; color: #2c3e50;">
                        </div>
                        <small style="color: #6c757d; font-size: 0.85rem; margin-top: 5px; display: block;">1099-G, Box 1</small>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: #0f5132; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Federal income tax withheld (optional)</label>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: #2c3e50; font-weight: 600; font-size: 1.1rem;">$</span>
                            <input type="text" class="unemployment-withheld" data-form-id="${formId}" placeholder="0.00" value="0" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; color: #2c3e50;">
                        </div>
                    </div>
                    
                    ${unemploymentFormCount > 1 ? `<button type="button" onclick="removeUnemploymentForm('${formId}')" style="background: transparent; color: #dc3545; border: 1px solid #dc3545; padding: 8px 16px; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 0.9rem;">Remove this 1099-G</button>` : ''}
                `;
                container.appendChild(unemploymentFormDiv);
            }
        }
        
        function addAnotherUnemployment() {
            addUnemploymentForm();
        }
        
        function removeUnemploymentForm(formId) {
            const form = document.getElementById(formId);
            if (form) {
                form.remove();
            }
        }
        
        function saveUnemploymentForm() {
            const container = document.getElementById('unemploymentFormsContainer');
            if (!container) return;
            
            const forms = container.querySelectorAll('.unemployment-form-item');
            unemploymentFormsData = [];
            let totalUnemployment = 0;
            
            forms.forEach((form) => {
                const formId = form.id;
                const amount = parseFloat(form.querySelector('.unemployment-amount')?.value.replace(/,/g, '') || 0);
                const withheld = parseFloat(form.querySelector('.unemployment-withheld')?.value.replace(/,/g, '') || 0);
                
                unemploymentFormsData.push({
                    amount: amount,
                    withheld: withheld
                });
                
                totalUnemployment += amount;
            });
            
            calculatorData.unemploymentForms = unemploymentFormsData;
            if (!calculatorData.incomeAmounts) calculatorData.incomeAmounts = {};
            calculatorData.incomeAmounts.unemployment = totalUnemployment;
            
            // Update income amount display
            const incomeAmountsContainer = document.getElementById('incomeAmountsContainer');
            const existingInput = document.getElementById('incomeAmount_unemployment');
            
            if (existingInput) {
                const input = existingInput.querySelector('.income-amount-field');
                if (input) {
                    input.value = formatWithCommas(totalUnemployment, true);
                }
            } else {
                const incomeInputDiv = document.createElement('div');
                incomeInputDiv.id = 'incomeAmount_unemployment';
                incomeInputDiv.className = 'income-amount-input';
                incomeInputDiv.style.cssText = 'margin-bottom: 20px; padding: 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: #f9f9f9;';
                incomeInputDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <label style="color: #2c3e50; font-weight: 600; font-size: 1rem;">Unemployment</label>
                        <i class="fas fa-times" onclick="removeIncomeAmount('unemployment')" style="color: #dc3545; cursor: pointer; font-size: 1.1rem;"></i>
                    </div>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="color: #2c3e50; font-weight: 600; font-size: 1.2rem;">$</span>
                        <input type="text" class="income-amount-field" data-income-type="unemployment" value="${formatWithCommas(totalUnemployment, true)}" placeholder="0.00" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1.1rem; color: #2c3e50;" readonly>
                    </div>
                `;
                if (incomeAmountsContainer) {
                    incomeAmountsContainer.appendChild(incomeInputDiv);
                }
            }
            
            closeUnemploymentFormInline();
        }
        
        // Tax Refund Form Functions
        function showTaxRefundFormInline() {
            const container = document.getElementById('taxRefundFormContainer');
            if (container) {
                container.style.display = 'block';
            }
        }
        
        function closeTaxRefundFormInline() {
            const container = document.getElementById('taxRefundFormContainer');
            if (container) {
                container.style.display = 'none';
            }
        }
        
        function saveTaxRefundForm() {
            const input = document.getElementById('taxRefundAmount');
            if (input) {
                const amount = parseFloat(input.value.replace(/,/g, '') || 0);
                if (!calculatorData.incomeAmounts) calculatorData.incomeAmounts = {};
                calculatorData.incomeAmounts.tax_refund = amount;
                
                // Update income amount display
                const incomeAmountsContainer = document.getElementById('incomeAmountsContainer');
                const existingInput = document.getElementById('incomeAmount_tax_refund');
                
                if (existingInput) {
                    const displayInput = existingInput.querySelector('.income-amount-field');
                    if (displayInput) {
                        displayInput.value = formatWithCommas(amount, true);
                    }
                } else {
                    const incomeInputDiv = document.createElement('div');
                    incomeInputDiv.id = 'incomeAmount_tax_refund';
                    incomeInputDiv.className = 'income-amount-input';
                    incomeInputDiv.style.cssText = 'margin-bottom: 20px; padding: 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: #f9f9f9;';
                    incomeInputDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <label style="color: #2c3e50; font-weight: 600; font-size: 1rem;">State/local tax refund</label>
                            <i class="fas fa-times" onclick="removeIncomeAmount('tax_refund')" style="color: #dc3545; cursor: pointer; font-size: 1.1rem;"></i>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: #2c3e50; font-weight: 600; font-size: 1.2rem;">$</span>
                            <input type="text" class="income-amount-field" data-income-type="tax_refund" value="${formatWithCommas(amount, true)}" placeholder="0.00" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1.1rem; color: #2c3e50;" readonly>
                        </div>
                    `;
                    if (incomeAmountsContainer) {
                        incomeAmountsContainer.appendChild(incomeInputDiv);
                    }
                }
            }
            closeTaxRefundFormInline();
        }
        
        // Capital Gains Form Functions
        function showCapitalGainsFormInline() {
            const container = document.getElementById('capitalGainsFormContainer');
            if (container) {
                container.style.display = 'block';
            }
        }
        
        function closeCapitalGainsFormInline() {
            const container = document.getElementById('capitalGainsFormContainer');
            if (container) {
                container.style.display = 'none';
            }
        }
        
        function saveCapitalGainsForm() {
            const shortTermInput = document.getElementById('shortTermCapitalGains');
            const longTermInput = document.getElementById('longTermCapitalGains');
            
            if (shortTermInput && longTermInput) {
                const shortTermAmount = parseFloat(shortTermInput.value.replace(/,/g, '') || 0);
                const longTermAmount = parseFloat(longTermInput.value.replace(/,/g, '') || 0);
                const totalAmount = shortTermAmount + longTermAmount;
                
                if (!calculatorData.incomeAmounts) calculatorData.incomeAmounts = {};
                calculatorData.incomeAmounts.capital_gains = totalAmount;
                
                // Update income amount display
                const incomeAmountsContainer = document.getElementById('incomeAmountsContainer');
                const existingInput = document.getElementById('incomeAmount_capital_gains');
                
                if (existingInput) {
                    const displayInput = existingInput.querySelector('.income-amount-field');
                    if (displayInput) {
                        displayInput.value = formatWithCommas(totalAmount, true);
                    }
                } else {
                    const incomeInputDiv = document.createElement('div');
                    incomeInputDiv.id = 'incomeAmount_capital_gains';
                    incomeInputDiv.className = 'income-amount-input';
                    incomeInputDiv.style.cssText = 'margin-bottom: 20px; padding: 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: #f9f9f9;';
                    incomeInputDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <label style="color: #2c3e50; font-weight: 600; font-size: 1rem;">Capital gains/losses</label>
                            <i class="fas fa-times" onclick="removeIncomeAmount('capital_gains')" style="color: #dc3545; cursor: pointer; font-size: 1.1rem;"></i>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: #2c3e50; font-weight: 600; font-size: 1.2rem;">$</span>
                            <input type="text" class="income-amount-field" data-income-type="capital_gains" value="${formatWithCommas(totalAmount, true)}" placeholder="0.00" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1.1rem; color: #2c3e50;" readonly>
                        </div>
                    `;
                    if (incomeAmountsContainer) {
                        incomeAmountsContainer.appendChild(incomeInputDiv);
                    }
                }
            }
            closeCapitalGainsFormInline();
        }
        
        // Other Income Form Functions
        function showOtherIncomeFormInline() {
            const container = document.getElementById('otherIncomeFormContainer');
            if (container) {
                container.style.display = 'block';
            }
        }
        
        function closeOtherIncomeFormInline() {
            const container = document.getElementById('otherIncomeFormContainer');
            if (container) {
                container.style.display = 'none';
            }
        }
        
        function saveOtherIncomeForm() {
            const input = document.getElementById('otherIncomeAmount');
            if (input) {
                const amount = parseFloat(input.value.replace(/,/g, '') || 0);
                if (!calculatorData.incomeAmounts) calculatorData.incomeAmounts = {};
                calculatorData.incomeAmounts.other = amount;
                
                // Update income amount display
                const incomeAmountsContainer = document.getElementById('incomeAmountsContainer');
                const existingInput = document.getElementById('incomeAmount_other');
                
                if (existingInput) {
                    const displayInput = existingInput.querySelector('.income-amount-field');
                    if (displayInput) {
                        displayInput.value = formatWithCommas(amount, true);
                    }
                } else {
                    const incomeInputDiv = document.createElement('div');
                    incomeInputDiv.id = 'incomeAmount_other';
                    incomeInputDiv.className = 'income-amount-input';
                    incomeInputDiv.style.cssText = 'margin-bottom: 20px; padding: 20px; border: 2px solid #e0e0e0; border-radius: 10px; background: #f9f9f9;';
                    incomeInputDiv.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <label style="color: #2c3e50; font-weight: 600; font-size: 1rem;">Other income</label>
                            <i class="fas fa-times" onclick="removeIncomeAmount('other')" style="color: #dc3545; cursor: pointer; font-size: 1.1rem;"></i>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: #2c3e50; font-weight: 600; font-size: 1.2rem;">$</span>
                            <input type="text" class="income-amount-field" data-income-type="other" value="${formatWithCommas(amount, true)}" placeholder="0.00" style="flex: 1; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1.1rem; color: #2c3e50;" readonly>
                        </div>
                    `;
                    if (incomeAmountsContainer) {
                        incomeAmountsContainer.appendChild(incomeInputDiv);
                    }
                }
            }
            closeOtherIncomeFormInline();
        }
        
        // Make all new functions globally accessible
        window.showDividendsFormInline = showDividendsFormInline;
        window.closeDividendsFormInline = closeDividendsFormInline;
        window.saveDividendsForm = saveDividendsForm;
        window.showCombatPayFormInline = showCombatPayFormInline;
        window.closeCombatPayFormInline = closeCombatPayFormInline;
        window.saveCombatPayForm = saveCombatPayForm;
        window.showUnemploymentFormInline = showUnemploymentFormInline;
        window.closeUnemploymentFormInline = closeUnemploymentFormInline;
        window.addAnotherUnemployment = addAnotherUnemployment;
        window.removeUnemploymentForm = removeUnemploymentForm;
        window.saveUnemploymentForm = saveUnemploymentForm;
        window.showTaxRefundFormInline = showTaxRefundFormInline;
        window.closeTaxRefundFormInline = closeTaxRefundFormInline;
        window.saveTaxRefundForm = saveTaxRefundForm;
        window.showCapitalGainsFormInline = showCapitalGainsFormInline;
        window.closeCapitalGainsFormInline = closeCapitalGainsFormInline;
        window.saveCapitalGainsForm = saveCapitalGainsForm;
        window.showOtherIncomeFormInline = showOtherIncomeFormInline;
        window.closeOtherIncomeFormInline = closeOtherIncomeFormInline;
        window.saveOtherIncomeForm = saveOtherIncomeForm;

        // Reset calculator
        function resetCalculator() {
            // Reset data
            calculatorData = {
                maritalStatus: '',
                filingStatus: '',
                age: 0,
                spouseAge: 0,
                incomeType: '',
                wageIncome: 0,
                taxWithheld: 0,
                spouseWageIncome: 0,
                spouseTaxWithheld: 0,
                filingMethod: '',
                dependents: [],
                incomeTypes: [],
                incomeAmounts: {},
                deductionType: 'standard',
                credits: [],
                standardDeduction: 15750
            };
            
            // Clear income amounts container
            const incomeAmountsContainer = document.getElementById('incomeAmountsContainer');
            if (incomeAmountsContainer) {
                incomeAmountsContainer.innerHTML = '';
            }
            
            // Reset income type buttons
            document.querySelectorAll('.income-type-btn').forEach(btn => {
                btn.classList.remove('selected');
                const icon = btn.querySelector('i');
                if (icon) {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-plus');
                }
                btn.style.background = 'white';
                btn.style.borderColor = '#e0e0e0';
                const span = btn.querySelector('span');
                if (span) {
                    span.style.color = '#2c3e50';
                }
            });
            
            // Clear dependents section
            const dependentsList = document.getElementById('dependentsList');
            if (dependentsList) {
                dependentsList.innerHTML = '';
            }
            const newDependentForm = document.getElementById('newDependentForm');
            if (newDependentForm) {
                newDependentForm.style.display = 'none';
                newDependentForm.innerHTML = '';
            }
            const dependentsSection = document.getElementById('dependentsSection');
            if (dependentsSection) {
                dependentsSection.style.display = 'none';
            }
            
            // Reset form
            document.getElementById('taxCalculatorForm')?.reset();
            
            // Reset to step 1
            goToStep(1);
            
            // Reset progress indicators
            document.querySelectorAll('.progress-step').forEach((step, index) => {
                const circle = step.querySelector('.step-circle');
                if (circle && index === 0) {
                    circle.style.borderColor = '#20B2AA';
                    circle.style.background = '#20B2AA';
                    circle.style.color = 'white';
                    circle.innerHTML = '1';
                } else if (circle) {
                    circle.style.borderColor = '#e0e0e0';
                    circle.style.background = 'white';
                    circle.style.color = '#6c757d';
                    circle.innerHTML = (index + 1).toString();
                }
            });
            
            // Reset progress lines
            document.querySelectorAll('.progress-line').forEach(line => {
                line.classList.remove('completed');
            });
            
            // Reset refund display
            const estimatedRefundDisplayEl = document.getElementById('estimatedRefundDisplay');
            estimatedRefundDisplayEl.textContent = '$0';
            estimatedRefundDisplayEl.style.background = 'linear-gradient(135deg, #20B2AA 0%, #17a2b8 100%)';
            estimatedRefundDisplayEl.style.webkitBackgroundClip = 'text';
            estimatedRefundDisplayEl.style.webkitTextFillColor = 'transparent';
            estimatedRefundDisplayEl.style.backgroundClip = 'text';
            estimatedRefundDisplayEl.style.textShadow = '0 2px 10px rgba(32, 178, 170, 0.2)';
            
            // Reset label
            const estimatedRefundLabelEl = document.getElementById('estimatedRefundLabel');
            if (estimatedRefundLabelEl) {
                estimatedRefundLabelEl.textContent = 'Your estimated refund:';
            }
            
            // Hide conditional fields
            document.getElementById('filingStatusRow').style.display = 'none';
            document.getElementById('spouseAgeRow').style.display = 'none';
            document.getElementById('incomeTypeRow').style.display = 'none';
            document.getElementById('wageIncomeRow').style.display = 'none';
            document.getElementById('taxWithheldRow').style.display = 'none';
            document.getElementById('spouseWageIncomeRow').style.display = 'none';
            document.getElementById('spouseTaxWithheldRow').style.display = 'none';
            document.getElementById('dependentsSection').style.display = 'none';
        }

        // Scroll to top button
        const scrollToTopBtn = document.getElementById('scrollToTopBtn');
        window.addEventListener('scroll', () => {
            if (window.pageYOffset > 300) scrollToTopBtn.classList.add('show');
            else scrollToTopBtn.classList.remove('show');
        });
        scrollToTopBtn.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));
        
        // Show calculator when estimate button is clicked
        function showCalculator() {
            const calculatorSection = document.getElementById('calculatorSection');
            if (calculatorSection) {
                calculatorSection.style.display = 'block';
                calculatorSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }
        
        // Add event listeners to estimate buttons
        const startCalculatorBtn = document.getElementById('startCalculatorBtn');
        if (startCalculatorBtn) {
            startCalculatorBtn.addEventListener('click', function(event) {
                event.preventDefault();
                showCalculator();
            });
        }
        
        const ctaStartCalculatorBtn = document.getElementById('ctaStartCalculatorBtn');
        if (ctaStartCalculatorBtn) {
            ctaStartCalculatorBtn.addEventListener('click', function(event) {
                event.preventDefault();
                showCalculator();
            });
        }
        
        // Use event delegation for breakdown toggles - works even if elements are added dynamically
        document.addEventListener('click', function(e) {
            const header = e.target.closest('.breakdown-header');
            if (header && (header.id === 'myDetailsHeader' || header.id === 'estimateBreakdownHeader')) {
                e.preventDefault();
                e.stopPropagation();
                const sectionId = header.id === 'myDetailsHeader' ? 'myDetails' : 'estimateBreakdown';
                if (window.toggleBreakdownSection) {
                    window.toggleBreakdownSection(sectionId);
                }
            }
        });
        
        // Also setup direct event listeners as backup
        function setupBreakdownToggles() {
            const myDetailsHeader = document.getElementById('myDetailsHeader');
            const estimateBreakdownHeader = document.getElementById('estimateBreakdownHeader');
            
            if (myDetailsHeader) {
                myDetailsHeader.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    if (window.toggleBreakdownSection) {
                        window.toggleBreakdownSection('myDetails');
                    }
                });
            }
            
            if (estimateBreakdownHeader) {
                estimateBreakdownHeader.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    if (window.toggleBreakdownSection) {
                        window.toggleBreakdownSection('estimateBreakdown');
                    }
                });
            }
        }
        
        // Setup toggles when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', setupBreakdownToggles);
        } else {
            setupBreakdownToggles();
        }
        
        // Setup tab buttons when DOM is ready
        function setupTabs() {
            const tabMyDetails = document.getElementById('tabMyDetails');
            const tabBreakdown = document.getElementById('tabBreakdown');
            
            if (tabMyDetails) {
                tabMyDetails.addEventListener('click', function(e) {
                    e.preventDefault();
                    switchTab(1);
                });
            }
            
            if (tabBreakdown) {
                tabBreakdown.addEventListener('click', function(e) {
                    e.preventDefault();
                    switchTab(2);
                });
            }
        }
        
        // Setup tabs when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', setupTabs);
        } else {
            setupTabs();
        }
        
        // Also setup when step 6 is shown
        const originalGoToStep = goToStep;
        if (typeof originalGoToStep === 'function') {
            // This will be handled in the goToStep function
        }
        
    </script>
</body>
</html>

